function $A(e){if(!e)return[];if("toArray"in Object(e))return e.toArray();var t=e.length||0,n=new Array(t);while(t--)n[t]=e[t];return n}function $w(e){return Object.isString(e)?(e=e.strip(),e?e.split(/\s+/):[]):[]}function $H(e){return new Hash(e)}function $R(e,t,n){return new ObjectRange(e,t,n)}function $(e){if(arguments.length>1){for(var t=0,n=[],r=arguments.length;t<r;t++)n.push($(arguments[t]));return n}return Object.isString(e)&&(e=document.getElementById(e)),Element.extend(e)}function $$(){return Selector.findChildElements(document,$A(arguments))}var Prototype={Version:"1.6.1",Browser:function(){var e=navigator.userAgent,t=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!t,Opera:t,WebKit:e.indexOf("AppleWebKit/")>-1,Gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile.*Safari/.test(e)}}(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:function(){var e=window.Element||window.HTMLElement;return!!e&&!!e.prototype}(),SpecificElementExtensions:function(){if(typeof window.HTMLDivElement!="undefined")return!0;var e=document.createElement("div"),t=document.createElement("form"),n=!1;return e.__proto__&&e.__proto__!==t.__proto__&&(n=!0),e=t=null,n}()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)</script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(e){return e}};Prototype.Browser.MobileSafari&&(Prototype.BrowserFeatures.SpecificElementExtensions=!1);var Abstract={},Try={these:function(){var e;for(var t=0,n=arguments.length;t<n;t++){var r=arguments[t];try{e=r();break}catch(i){}}return e}},Class=function(){function e(){}function t(){function r(){this.initialize.apply(this,arguments)}var t=null,n=$A(arguments);Object.isFunction(n[0])&&(t=n.shift()),Object.extend(r,Class.Methods),r.superclass=t,r.subclasses=[],t&&(e.prototype=t.prototype,r.prototype=new e,t.subclasses.push(r));for(var i=0;i<n.length;i++)r.addMethods(n[i]);return r.prototype.initialize||(r.prototype.initialize=Prototype.emptyFunction),r.prototype.constructor=r,r}function n(e){var t=this.superclass&&this.superclass.prototype,n=Object.keys(e);Object.keys({toString:!0}).length||(e.toString!=Object.prototype.toString&&n.push("toString"),e.valueOf!=Object.prototype.valueOf&&n.push("valueOf"));for(var r=0,i=n.length;r<i;r++){var s=n[r],o=e[s];if(t&&Object.isFunction(o)&&o.argumentNames().first()=="$super"){var u=o;o=function(e){return function(){return t[e].apply(this,arguments)}}(s).wrap(u),o.valueOf=u.valueOf.bind(u),o.toString=u.toString.bind(u)}this.prototype[s]=o}return this}return{create:t,Methods:{addMethods:n}}}();(function(){function t(e,t){for(var n in t)e[n]=t[n];return e}function n(e){try{return v(e)?"undefined":e===null?"null":e.inspect?e.inspect():String(e)}catch(t){if(t instanceof RangeError)return"...";throw t}}function r(e){var t=typeof e;switch(t){case"undefined":case"function":case"unknown":return;case"boolean":return e.toString()}if(e===null)return"null";if(e.toJSON)return e.toJSON();if(f(e))return;var n=[];for(var i in e){var s=r(e[i]);v(s)||n.push(i.toJSON()+": "+s)}return"{"+n.join(", ")+"}"}function i(e){return $H(e).toQueryString()}function s(e){return e&&e.toHTML?e.toHTML():String.interpret(e)}function o(e){var t=[];for(var n in e)t.push(n);return t}function u(e){var t=[];for(var n in e)t.push(e[n]);return t}function a(e){return t({},e)}function f(e){return!!e&&e.nodeType==1}function l(t){return e.call(t)=="[object Array]"}function c(e){return e instanceof Hash}function h(e){return typeof e=="function"}function p(t){return e.call(t)=="[object String]"}function d(t){return e.call(t)=="[object Number]"}function v(e){return typeof e=="undefined"}var e=Object.prototype.toString;t(Object,{extend:t,inspect:n,toJSON:r,toQueryString:i,toHTML:s,keys:o,values:u,clone:a,isElement:f,isArray:l,isHash:c,isFunction:h,isString:p,isNumber:d,isUndefined:v})})(),Object.extend(Function.prototype,function(){function t(e,t){var n=e.length,r=t.length;while(r--)e[n+r]=t[r];return e}function n(n,r){return n=e.call(n,0),t(n,r)}function r(){var e=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return e.length==1&&!e[0]?[]:e}function i(t){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var r=this,i=e.call(arguments,1);return function(){var e=n(i,arguments);return r.apply(t,e)}}function s(n){var r=this,i=e.call(arguments,1);return function(e){var s=t([e||window.event],i);return r.apply(n,s)}}function o(){if(!arguments.length)return this;var t=this,r=e.call(arguments,0);return function(){var e=n(r,arguments);return t.apply(this,e)}}function u(t){var n=this,r=e.call(arguments,1);return t*=1e3,window.setTimeout(function(){return n.apply(n,r)},t)}function a(){var e=t([.01],arguments);return this.delay.apply(this,e)}function f(e){var n=this;return function(){var r=t([n.bind(this)],arguments);return e.apply(this,r)}}function l(){if(this._methodized)return this._methodized;var e=this;return this._methodized=function(){var n=t([this],arguments);return e.apply(null,n)}}var e=Array.prototype.slice;return{argumentNames:r,bind:i,bindAsEventListener:s,curry:o,delay:u,defer:a,wrap:f,methodize:l}}()),Date.prototype.toJSON=function(){return'"'+this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+'Z"'},RegExp.prototype.match=RegExp.prototype.test,RegExp.escape=function(e){return String(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};var PeriodicalExecuter=Class.create({initialize:function(e,t){this.callback=e,this.frequency=t,this.currentlyExecuting=!1,this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1e3)},execute:function(){this.callback(this)},stop:function(){if(!this.timer)return;clearInterval(this.timer),this.timer=null},onTimerEvent:function(){if(!this.currentlyExecuting)try{this.currentlyExecuting=!0,this.execute(),this.currentlyExecuting=!1}catch(e){throw this.currentlyExecuting=!1,e}}});Object.extend(String,{interpret:function(e){return e==null?"":String(e)},specialChar:{"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}}),Object.extend(String.prototype,function(){function prepareReplacement(e){if(Object.isFunction(e))return e;var t=new Template(e);return function(e){return t.evaluate(e)}}function gsub(e,t){var n="",r=this,i;t=prepareReplacement(t),Object.isString(e)&&(e=RegExp.escape(e));if(!e.length&&!e.source)return t=t(""),t+r.split("").join(t)+t;while(r.length>0)(i=r.match(e))?(n+=r.slice(0,i.index),n+=String.interpret(t(i)),r=r.slice(i.index+i[0].length)):(n+=r,r="");return n}function sub(e,t,n){return t=prepareReplacement(t),n=Object.isUndefined(n)?1:n,this.gsub(e,function(e){return--n<0?e[0]:t(e)})}function scan(e,t){return this.gsub(e,t),String(this)}function truncate(e,t){return e=e||30,t=Object.isUndefined(t)?"...":t,this.length>e?this.slice(0,e-t.length)+t:String(this)}function strip(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function stripTags(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")}function stripScripts(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")}function extractScripts(){var e=new RegExp(Prototype.ScriptFragment,"img"),t=new RegExp(Prototype.ScriptFragment,"im");return(this.match(e)||[]).map(function(e){return(e.match(t)||["",""])[1]})}function evalScripts(){return this.extractScripts().map(function(script){return eval(script)})}function escapeHTML(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function unescapeHTML(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function toQueryParams(e){var t=this.strip().match(/([^?#]*)(#.*)?$/);return t?t[1].split(e||"&").inject({},function(e,t){if((t=t.split("="))[0]){var n=decodeURIComponent(t.shift()),r=t.length>1?t.join("="):t[0];r!=undefined&&(r=decodeURIComponent(r)),n in e?(Object.isArray(e[n])||(e[n]=[e[n]]),e[n].push(r)):e[n]=r}return e}):{}}function toArray(){return this.split("")}function succ(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function times(e){return e<1?"":(new Array(e+1)).join(this)}function camelize(){var e=this.split("-"),t=e.length;if(t==1)return e[0];var n=this.charAt(0)=="-"?e[0].charAt(0).toUpperCase()+e[0].substring(1):e[0];for(var r=1;r<t;r++)n+=e[r].charAt(0).toUpperCase()+e[r].substring(1);return n}function capitalize(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()}function underscore(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function dasherize(){return this.replace(/_/g,"-")}function inspect(e){var t=this.replace(/[\x00-\x1f\\]/g,function(e){return e in String.specialChar?String.specialChar[e]:"\\u00"+e.charCodeAt().toPaddedString(2,16)});return e?'"'+t.replace(/"/g,'\\"')+'"':"'"+t.replace(/'/g,"\\'")+"'"}function toJSON(){return this.inspect(!0)}function unfilterJSON(e){return this.replace(e||Prototype.JSONFilter,"$1")}function isJSON(){var e=this;return e.blank()?!1:(e=this.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,""),/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/.test(e))}function evalJSON(sanitize){var json=this.unfilterJSON();try{if(!sanitize||json.isJSON())return eval("("+json+")")}catch(e){}throw new SyntaxError("Badly formed JSON string: "+this.inspect())}function include(e){return this.indexOf(e)>-1}function startsWith(e){return this.indexOf(e)===0}function endsWith(e){var t=this.length-e.length;return t>=0&&this.lastIndexOf(e)===t}function empty(){return this==""}function blank(){return/^\s*$/.test(this)}function interpolate(e,t){return(new Template(this,t)).evaluate(e)}return{gsub:gsub,sub:sub,scan:scan,truncate:truncate,strip:String.prototype.trim?String.prototype.trim:strip,stripTags:stripTags,stripScripts:stripScripts,extractScripts:extractScripts,evalScripts:evalScripts,escapeHTML:escapeHTML,unescapeHTML:unescapeHTML,toQueryParams:toQueryParams,parseQuery:toQueryParams,toArray:toArray,succ:succ,times:times,camelize:camelize,capitalize:capitalize,underscore:underscore,dasherize:dasherize,inspect:inspect,toJSON:toJSON,unfilterJSON:unfilterJSON,isJSON:isJSON,evalJSON:evalJSON,include:include,startsWith:startsWith,endsWith:endsWith,empty:empty,blank:blank,interpolate:interpolate}}());var Template=Class.create({initialize:function(e,t){this.template=e.toString(),this.pattern=t||Template.Pattern},evaluate:function(e){return e&&Object.isFunction(e.toTemplateReplacements)&&(e=e.toTemplateReplacements()),this.template.gsub(this.pattern,function(t){if(e==null)return t[1]+"";var n=t[1]||"";if(n=="\\")return t[2];var r=e,i=t[3],s=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;t=s.exec(i);if(t==null)return n;while(t!=null){var o=t[1].startsWith("[")?t[2].replace(/\\\\]/g,"]"):t[1];r=r[o];if(null==r||""==t[3])break;i=i.substring("["==t[3]?t[1].length:t[0].length),t=s.exec(i)}return n+String.interpret(r)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;var $break={},Enumerable=function(){function e(e,t){var n=0;try{this._each(function(r){e.call(t,r,n++)})}catch(r){if(r!=$break)throw r}return this}function t(e,t,n){var r=-e,i=[],s=this.toArray();if(e<1)return s;while((r+=e)<s.length)i.push(s.slice(r,r+e));return i.collect(t,n)}function n(e,t){e=e||Prototype.K;var n=!0;return this.each(function(r,i){n=n&&!!e.call(t,r,i);if(!n)throw $break}),n}function r(e,t){e=e||Prototype.K;var n=!1;return this.each(function(r,i){if(n=!!e.call(t,r,i))throw $break}),n}function i(e,t){e=e||Prototype.K;var n=[];return this.each(function(r,i){n.push(e.call(t,r,i))}),n}function s(e,t){var n;return this.each(function(r,i){if(e.call(t,r,i))throw n=r,$break}),n}function o(e,t){var n=[];return this.each(function(r,i){e.call(t,r,i)&&n.push(r)}),n}function u(e,t,n){t=t||Prototype.K;var r=[];return Object.isString(e)&&(e=new RegExp(RegExp.escape(e))),this.each(function(i,s){e.match(i)&&r.push(t.call(n,i,s))}),r}function a(e){if(Object.isFunction(this.indexOf)&&this.indexOf(e)!=-1)return!0;var t=!1;return this.each(function(n){if(n==e)throw t=!0,$break}),t}function f(e,t){return t=Object.isUndefined(t)?null:t,this.eachSlice(e,function(n){while(n.length<e)n.push(t);return n})}function l(e,t,n){return this.each(function(r,i){e=t.call(n,e,r,i)}),e}function c(e){var t=$A(arguments).slice(1);return this.map(function(n){return n[e].apply(n,t)})}function h(e,t){e=e||Prototype.K;var n;return this.each(function(r,i){r=e.call(t,r,i);if(n==null||r>=n)n=r}),n}function p(e,t){e=e||Prototype.K;var n;return this.each(function(r,i){r=e.call(t,r,i);if(n==null||r<n)n=r}),n}function d(e,t){e=e||Prototype.K;var n=[],r=[];return this.each(function(i,s){(e.call(t,i,s)?n:r).push(i)}),[n,r]}function v(e){var t=[];return this.each(function(n){t.push(n[e])}),t}function m(e,t){var n=[];return this.each(function(r,i){e.call(t,r,i)||n.push(r)}),n}function g(e,t){return this.map(function(n,r){return{value:n,criteria:e.call(t,n,r)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}).pluck("value")}function y(){return this.map()}function b(){var e=Prototype.K,t=$A(arguments);Object.isFunction(t.last())&&(e=t.pop());var n=[this].concat(t).map($A);return this.map(function(t,r){return e(n.pluck(r))})}function w(){return this.toArray().length}function E(){return"#<Enumerable:"+this.toArray().inspect()+">"}return{each:e,eachSlice:t,all:n,every:n,any:r,some:r,collect:i,map:i,detect:s,findAll:o,select:o,filter:o,grep:u,include:a,member:a,inGroupsOf:f,inject:l,invoke:c,max:h,min:p,partition:d,pluck:v,reject:m,sortBy:g,toArray:y,entries:y,zip:b,size:w,inspect:E,find:s}}();Array.from=$A,function(){function r(e){for(var t=0,n=this.length;t<n;t++)e(this[t])}function i(){return this.length=0,this}function s(){return this[0]}function o(){return this[this.length-1]}function u(){return this.select(function(e){return e!=null})}function a(){return this.inject([],function(e,t){return Object.isArray(t)?e.concat(t.flatten()):(e.push(t),e)})}function f(){var e=t.call(arguments,0);return this.select(function(t){return!e.include(t)})}function l(e){return(e!==!1?this:this.toArray())._reverse()}function c(e){return this.inject([],function(t,n,r){return(0==r||(e?t.last()!=n:!t.include(n)))&&t.push(n),t})}function h(e){return this.uniq().findAll(function(t){return e.detect(function(e){return t===e})})}function p(){return t.call(this,0)}function d(){return this.length}function v(){return"["+this.map(Object.inspect).join(", ")+"]"}function m(){var e=[];return this.each(function(t){var n=Object.toJSON(t);Object.isUndefined(n)||e.push(n)}),"["+e.join(", ")+"]"}function g(e,t){t||(t=0);var n=this.length;t<0&&(t=n+t);for(;t<n;t++)if(this[t]===e)return t;return-1}function y(e,t){t=isNaN(t)?this.length:(t<0?this.length+t:t)+1;var n=this.slice(0,t).reverse().indexOf(e);return n<0?n:t-n-1}function b(){var e=t.call(this,0),n;for(var r=0,i=arguments.length;r<i;r++){n=arguments[r];if(!Object.isArray(n)||"callee"in n)e.push(n);else for(var s=0,o=n.length;s<o;s++)e.push(n[s])}return e}var e=Array.prototype,t=e.slice,n=e.forEach;n||(n=r),Object.extend(e,Enumerable),e._reverse||(e._reverse=e.reverse),Object.extend(e,{_each:n,clear:i,first:s,last:o,compact:u,flatten:a,without:f,reverse:l,uniq:c,intersect:h,clone:p,toArray:p,size:d,inspect:v,toJSON:m});var w=function(){return[].concat(arguments)[0][0]!==1}(1,2);w&&(e.concat=b),e.indexOf||(e.indexOf=g),e.lastIndexOf||(e.lastIndexOf=y)}();var Hash=Class.create(Enumerable,function(){function e(e){this._object=Object.isHash(e)?e.toObject():Object.clone(e)}function t(e){for(var t in this._object){var n=this._object[t],r=[t,n];r.key=t,r.value=n,e(r)}}function n(e,t){return this._object[e]=t}function r(e){if(this._object[e]!==Object.prototype[e])return this._object[e]}function i(e){var t=this._object[e];return delete this._object[e],t}function s(){return Object.clone(this._object)}function o(){return this.pluck("key")}function u(){return this.pluck("value")}function a(e){var t=this.detect(function(t){return t.value===e});return t&&t.key}function f(e){return this.clone().update(e)}function l(e){return(new Hash(e)).inject(this,function(e,t){return e.set(t.key,t.value),e})}function c(e,t){return Object.isUndefined(t)?e:e+"="+encodeURIComponent(String.interpret(t))}function h(){return this.inject([],function(e,t){var n=encodeURIComponent(t.key),r=t.value;if(r&&typeof r=="object"){if(Object.isArray(r))return e.concat(r.map(c.curry(n)))}else e.push(c(n,r));return e}).join("&")}function p(){return"#<Hash:{"+this.map(function(e){return e.map(Object.inspect).join(": ")}).join(", ")+"}>"}function d(){return Object.toJSON(this.toObject())}function v(){return new Hash(this)}return{initialize:e,_each:t,set:n,get:r,unset:i,toObject:s,toTemplateReplacements:s,keys:o,values:u,index:a,merge:f,update:l,toQueryString:h,inspect:p,toJSON:d,clone:v}}());Hash.from=$H,Object.extend(Number.prototype,function(){function e(){return this.toPaddedString(2,16)}function t(){return this+1}function n(e,t){return $R(0,this,!0).each(e,t),this}function r(e,t){var n=this.toString(t||10);return"0".times(e-n.length)+n}function i(){return isFinite(this)?this.toString():"null"}function s(){return Math.abs(this)}function o(){return Math.round(this)}function u(){return Math.ceil(this)}function a(){return Math.floor(this)}return{toColorPart:e,succ:t,times:n,toPaddedString:r,toJSON:i,abs:s,round:o,ceil:u,floor:a}}());var ObjectRange=Class.create(Enumerable,function(){function e(e,t,n){this.start=e,this.end=t,this.exclusive=n}function t(e){var t=this.start;while(this.include(t))e(t),t=t.succ()}function n(e){return e<this.start?!1:this.exclusive?e<this.end:e<=this.end}return{initialize:e,_each:t,include:n}}()),Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||!1},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(e){this.responders._each(e)},register:function(e){this.include(e)||this.responders.push(e)},unregister:function(e){this.responders=this.responders.without(e)},dispatch:function(e,t,n,r){this.each(function(i){if(Object.isFunction(i[e]))try{i[e].apply(i,[t,n,r])}catch(s){}})}},Object.extend(Ajax.Responders,Enumerable),Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}}),Ajax.Base=Class.create({initialize:function(e){this.options={method:"post",asynchronous:!0,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:!0,evalJS:!0},Object.extend(this.options,e||{}),this.options.method=this.options.method.toLowerCase(),Object.isString(this.options.parameters)?this.options.parameters=this.options.parameters.toQueryParams():Object.isHash(this.options.parameters)&&(this.options.parameters=this.options.parameters.toObject())}}),Ajax.Request=Class.create(Ajax.Base,{_complete:!1,initialize:function(e,t,n){e(n),this.transport=Ajax.getTransport(),this.request(t)},request:function(e){this.url=e,this.method=this.options.method;var t=Object.clone(this.options.parameters);["get","post"].include(this.method)||(t._method=this.method,this.method="post"),this.parameters=t;if(t=Object.toQueryString(t))this.method=="get"?this.url+=(this.url.include("?")?"&":"?")+t:/Konqueror|Safari|KHTML/.test(navigator.userAgent)&&(t+="&_=");try{var n=new Ajax.Response(this);this.options.onCreate&&this.options.onCreate(n),Ajax.Responders.dispatch("onCreate",this,n),this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous),this.options.asynchronous&&this.respondToReadyState.bind(this).defer(1),this.transport.onreadystatechange=this.onStateChange.bind(this),this.setRequestHeaders(),this.body=this.method=="post"?this.options.postBody||t:null,this.transport.send(this.body),!this.options.asynchronous&&this.transport.overrideMimeType&&this.onStateChange()}catch(r){this.dispatchException(r)}},onStateChange:function(){var e=this.transport.readyState;e>1&&(e!=4||!this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var e={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};this.method=="post"&&(e["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:""),this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005&&(e.Connection="close"));if(typeof this.options.requestHeaders=="object"){var t=this.options.requestHeaders;if(Object.isFunction(t.push))for(var n=0,r=t.length;n<r;n+=2)e[t[n]]=t[n+1];else $H(t).each(function(t){e[t.key]=t.value})}for(var i in e)this.transport.setRequestHeader(i,e[i])},success:function(){var e=this.getStatus();return!e||e>=200&&e<300},getStatus:function(){try{return this.transport.status||0}catch(e){return 0}},respondToReadyState:function(e){var t=Ajax.Request.Events[e],n=new Ajax.Response(this);if(t=="Complete"){try{this._complete=!0,(this.options["on"+n.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(n,n.headerJSON)}catch(r){this.dispatchException(r)}var i=n.getHeader("Content-type");(this.options.evalJS=="force"||this.options.evalJS&&this.isSameOrigin()&&i&&i.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))&&this.evalResponse()}try{(this.options["on"+t]||Prototype.emptyFunction)(n,n.headerJSON),Ajax.Responders.dispatch("on"+t,this,n,n.headerJSON)}catch(r){this.dispatchException(r)}t=="Complete"&&(this.transport.onreadystatechange=Prototype.emptyFunction)},isSameOrigin:function(){var e=this.url.match(/^\s*https?:\/\/[^\/]*/);return!e||e[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""})},getHeader:function(e){try{return this.transport.getResponseHeader(e)||null}catch(t){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(e){this.dispatchException(e)}},dispatchException:function(e){(this.options.onException||Prototype.emptyFunction)(this,e),Ajax.Responders.dispatch("onException",this,e)}}),Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"],Ajax.Response=Class.create({initialize:function(e){this.request=e;var t=this.transport=e.transport,n=this.readyState=t.readyState;if(n>2&&!Prototype.Browser.IE||n==4)this.status=this.getStatus(),this.statusText=this.getStatusText(),this.responseText=String.interpret(t.responseText),this.headerJSON=this._getHeaderJSON();if(n==4){var r=t.responseXML;this.responseXML=Object.isUndefined(r)?null:r,this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(e){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(e){return null}},getResponseHeader:function(e){return this.transport.getResponseHeader(e)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var e=this.getHeader("X-JSON");if(!e)return null;e=decodeURIComponent(escape(e));try{return e.evalJSON(this.request.options.sanitizeJSON||!this.request.isSameOrigin())}catch(t){this.request.dispatchException(t)}},_getResponseJSON:function(){var e=this.request.options;if(!e.evalJSON||e.evalJSON!="force"&&!(this.getHeader("Content-type")||"").include("application/json")||this.responseText.blank())return null;try{return this.responseText.evalJSON(e.sanitizeJSON||!this.request.isSameOrigin())}catch(t){this.request.dispatchException(t)}}}),Ajax.Updater=Class.create(Ajax.Request,{initialize:function(e,t,n,r){this.container={success:t.success||t,failure:t.failure||(t.success?null:t)},r=Object.clone(r);var i=r.onComplete;r.onComplete=function(e,t){this.updateContent(e.responseText),Object.isFunction(i)&&i(e,t)}.bind(this),e(n,r)},updateContent:function(e){var t=this.container[this.success()?"success":"failure"],n=this.options;n.evalScripts||(e=e.stripScripts());if(t=$(t))if(n.insertion)if(Object.isString(n.insertion)){var r={};r[n.insertion]=e,t.insert(r)}else n.insertion(t,e);else t.update(e)}}),Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function(e,t,n,r){e(r),this.onComplete=this.options.onComplete,this.frequency=this.options.frequency||2,this.decay=this.options.decay||1,this.updater={},this.container=t,this.url=n,this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this),this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined,clearTimeout(this.timer),(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},updateComplete:function(e){this.options.decay&&(this.decay=e.responseText==this.lastText?this.decay*this.options.decay:1,this.lastText=e.responseText),this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}}),Prototype.BrowserFeatures.XPath&&(document._getElementsByXPath=function(e,t){var n=[],r=document.evaluate(e,$(t)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var i=0,s=r.snapshotLength;i<s;i++)n.push(Element.extend(r.snapshotItem(i)));return n});if(!window.Node)var Node={};Node.ELEMENT_NODE||Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),function(e){var t=function(){var e=document.createElement("form"),t=document.createElement("input"),n=document.documentElement;t.setAttribute("name","test"),e.appendChild(t),n.appendChild(e);var r=e.elements?typeof e.elements.test=="undefined":null;return n.removeChild(e),e=t=null,r}(),n=e.Element;e.Element=function(e,n){n=n||{},e=e.toLowerCase();var r=Element.cache;return t&&n.name?(e="<"+e+' name="'+n.name+'">',delete n.name,Element.writeAttribute(document.createElement(e),n)):(r[e]||(r[e]=Element.extend(document.createElement(e))),Element.writeAttribute(r[e].cloneNode(!1),n))},Object.extend(e.Element,n||{}),n&&(e.Element.prototype=n.prototype)}(this),Element.cache={},Element.idCounter=1,Element.Methods={visible:function(e){return $(e).style.display!="none"},toggle:function(e){return e=$(e),Element[Element.visible(e)?"hide":"show"](e),e},hide:function(e){return e=$(e),e.style.display="none",e},show:function(e){return e=$(e),e.style.display="",e},remove:function(e){return e=$(e),e.parentNode.removeChild(e),e},update:function(){function r(r,i){r=$(r),i&&i.toElement&&(i=i.toElement());if(Object.isElement(i))return r.update().insert(i);i=Object.toHTML(i);var s=r.tagName.toUpperCase();if(s==="SCRIPT"&&n)return r.text=i,r;if(e||t)if(s in Element._insertionTranslations.tags){while(r.firstChild)r.removeChild(r.firstChild);Element._getContentFromAnonymousElement(s,i.stripScripts()).each(function(e){r.appendChild(e)})}else r.innerHTML=i.stripScripts();else r.innerHTML=i.stripScripts();return i.evalScripts.bind(i).defer(),r}var e=function(){var e=document.createElement("select"),t=!0;return e.innerHTML='<option value="test">test</option>',e.options&&e.options[0]&&(t=e.options[0].nodeName.toUpperCase()!=="OPTION"),e=null,t}(),t=function(){try{var e=document.createElement("table");if(e&&e.tBodies){e.innerHTML="<tbody><tr><td>test</td></tr></tbody>";var t=typeof e.tBodies[0]=="undefined";return e=null,t}}catch(n){return!0}}(),n=function(){var e=document.createElement("script"),t=!1;try{e.appendChild(document.createTextNode("")),t=!e.firstChild||e.firstChild&&e.firstChild.nodeType!==3}catch(n){t=!0}return e=null,t}();return r}(),replace:function(e,t){e=$(e);if(t&&t.toElement)t=t.toElement();else if(!Object.isElement(t)){t=Object.toHTML(t);var n=e.ownerDocument.createRange();n.selectNode(e),t.evalScripts.bind(t).defer(),t=n.createContextualFragment(t.stripScripts())}return e.parentNode.replaceChild(t,e),e},insert:function(e,t){e=$(e);if(Object.isString(t)||Object.isNumber(t)||Object.isElement(t)||t&&(t.toElement||t.toHTML))t={bottom:t};var n,r,i,s;for(var o in t){n=t[o],o=o.toLowerCase(),r=Element._insertionTranslations[o],n&&n.toElement&&(n=n.toElement());if(Object.isElement(n)){r(e,n);continue}n=Object.toHTML(n),i=(o=="before"||o=="after"?e.parentNode:e).tagName.toUpperCase(),s=Element._getContentFromAnonymousElement(i,n.stripScripts()),(o=="top"||o=="after")&&s.reverse(),s.each(r.curry(e)),n.evalScripts.bind(n).defer()}return e},wrap:function(e,t,n){return e=$(e),Object.isElement(t)?$(t).writeAttribute(n||{}):Object.isString(t)?t=new Element(t,n):t=new Element("div",t),e.parentNode&&e.parentNode.replaceChild(t,e),t.appendChild(e),t},inspect:function(e){e=$(e);var t="<"+e.tagName.toLowerCase();return $H({id:"id",className:"class"}).each(function(n){var r=n.first(),i=n.last(),s=(e[r]||"").toString();s&&(t+=" "+i+"="+s.inspect(!0))}),t+">"},recursivelyCollect:function(e,t){e=$(e);var n=[];while(e=e[t])e.nodeType==1&&n.push(Element.extend(e));return n},ancestors:function(e){return Element.recursivelyCollect(e,"parentNode")},descendants:function(e){return Element.select(e,"*")},firstDescendant:function(e){e=$(e).firstChild;while(e&&e.nodeType!=1)e=e.nextSibling;return $(e)},immediateDescendants:function(e){if(!(e=$(e).firstChild))return[];while(e&&e.nodeType!=1)e=e.nextSibling;return e?[e].concat($(e).nextSiblings()):[]},previousSiblings:function(e){return Element.recursivelyCollect(e,"previousSibling")},nextSiblings:function(e){return Element.recursivelyCollect(e,"nextSibling")},siblings:function(e){return e=$(e),Element.previousSiblings(e).reverse().concat(Element.nextSiblings(e))},match:function(e,t){return Object.isString(t)&&(t=new Selector(t)),t.match($(e))},up:function(e,t,n){e=$(e);if(arguments.length==1)return $(e.parentNode);var r=Element.ancestors(e);return Object.isNumber(t)?r[t]:Selector.findElement(r,t,n)},down:function(e,t,n){return e=$(e),arguments.length==1?Element.firstDescendant(e):Object.isNumber(t)?Element.descendants(e)[t]:Element.select(e,t)[n||0]},previous:function(e,t,n){e=$(e);if(arguments.length==1)return $(Selector.handlers.previousElementSibling(e));var r=Element.previousSiblings(e);return Object.isNumber(t)?r[t]:Selector.findElement(r,t,n)},next:function(e,t,n){e=$(e);if(arguments.length==1)return $(Selector.handlers.nextElementSibling(e));var r=Element.nextSiblings(e);return Object.isNumber(t)?r[t]:Selector.findElement(r,t,n)},select:function(e){var t=Array.prototype.slice.call(arguments,1);return Selector.findChildElements(e,t)},adjacent:function(e){var t=Array.prototype.slice.call(arguments,1);return Selector.findChildElements(e.parentNode,t).without(e)},identify:function(e){e=$(e);var t=Element.readAttribute(e,"id");if(t)return t;do t="anonymous_element_"+Element.idCounter++;while($(t));return Element.writeAttribute(e,"id",t),t},readAttribute:function(e,t){e=$(e);if(Prototype.Browser.IE){var n=Element._attributeTranslations.read;if(n.values[t])return n.values[t](e,t);n.names[t]&&(t=n.names[t]);if(t.include(":"))return!e.attributes||!e.attributes[t]?null:e.attributes[t].value}return e.getAttribute(t)},writeAttribute:function(e,t,n){e=$(e);var r={},i=Element._attributeTranslations.write;typeof t=="object"?r=t:r[t]=Object.isUndefined(n)?!0:n;for(var s in r)t=i.names[s]||s,n=r[s],i.values[s]&&(t=i.values[s](e,n)),n===!1||n===null?e.removeAttribute(t):n===!0?e.setAttribute(t,t):e.setAttribute(t,n);return e},getHeight:function(e){return Element.getDimensions(e).height},getWidth:function(e){return Element.getDimensions(e).width},classNames:function(e){return new Element.ClassNames(e)},hasClassName:function(e,t){if(!(e=$(e)))return;var n=e.className;return n.length>0&&(n==t||(new RegExp("(^|\\s)"+t+"(\\s|$)")).test(n))},addClassName:function(e,t){if(!(e=$(e)))return;return Element.hasClassName(e,t)||(e.className+=(e.className?" ":"")+t),e},removeClassName:function(e,t){if(!(e=$(e)))return;return e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," ").strip(),e},toggleClassName:function(e,t){if(!(e=$(e)))return;return Element[Element.hasClassName(e,t)?"removeClassName":"addClassName"](e,t)},cleanWhitespace:function(e){e=$(e);var t=e.firstChild;while(t){var n=t.nextSibling;t.nodeType==3&&!/\S/.test(t.nodeValue)&&e.removeChild(t),t=n}return e},empty:function(e){return $(e).innerHTML.blank()},descendantOf:function(e,t){e=$(e),t=$(t);if(e.compareDocumentPosition)return(e.compareDocumentPosition(t)&8)===8;if(t.contains)return t.contains(e)&&t!==e;while(e=e.parentNode)if(e==t)return!0;return!1},scrollTo:function(e){e=$(e);var t=Element.cumulativeOffset(e);return window.scrollTo(t[0],t[1]),e},getStyle:function(e,t){e=$(e),t=t=="float"?"cssFloat":t.camelize();var n=e.style[t];if(!n||n=="auto"){var r=document.defaultView.getComputedStyle(e,null);n=r?r[t]:null}return t=="opacity"?n?parseFloat(n):1:n=="auto"?null:n},getOpacity:function(e){return $(e).getStyle("opacity")},setStyle:function(e,t){e=$(e);var n=e.style,r;if(Object.isString(t))return e.style.cssText+=";"+t,t.include("opacity")?e.setOpacity(t.match(/opacity:\s*(\d?\.?\d*)/)[1]):e;for(var i in t)i=="opacity"?e.setOpacity(t[i]):n[i=="float"||i=="cssFloat"?Object.isUndefined(n.styleFloat)?"cssFloat":"styleFloat":i]=t[i];return e},setOpacity:function(e,t){return e=$(e),e.style.opacity=t==1||t===""?"":t<1e-5?0:t,e},getDimensions:function(e){e=$(e);var t=Element.getStyle(e,"display");if(t!="none"&&t!=null)return{width:e.offsetWidth,height:e.offsetHeight};var n=e.style,r=n.visibility,i=n.position,s=n.display;n.visibility="hidden",i!="fixed"&&(n.position="absolute"),n.display="block";var o=e.clientWidth,u=e.clientHeight;return n.display=s,n.position=i,n.visibility=r,{width:o,height:u}},makePositioned:function(e){e=$(e);var t=Element.getStyle(e,"position");if(t=="static"||!t)e._madePositioned=!0,e.style.position="relative",Prototype.Browser.Opera&&(e.style.top=0,e.style.left=0);return e},undoPositioned:function(e){return e=$(e),e._madePositioned&&(e._madePositioned=undefined,e.style.position=e.style.top=e.style.left=e.style.bottom=e.style.right=""),e},makeClipping:function(e){return e=$(e),e._overflow?e:(e._overflow=Element.getStyle(e,"overflow")||"auto",e._overflow!=="hidden"&&(e.style.overflow="hidden"),e)},undoClipping:function(e){return e=$(e),e._overflow?(e.style.overflow=e._overflow=="auto"?"":e._overflow,e._overflow=null,e):e},cumulativeOffset:function(e){var t=0,n=0;do t+=e.offsetTop||0,n+=e.offsetLeft||0,e=e.offsetParent;while(e);return Element._returnOffset(n,t)},positionedOffset:function(e){var t=0,n=0;do{t+=e.offsetTop||0,n+=e.offsetLeft||0,e=e.offsetParent;if(e){if(e.tagName.toUpperCase()=="BODY")break;var r=Element.getStyle(e,"position");if(r!=="static")break}}while(e);return Element._returnOffset(n,t)},absolutize:function(e){e=$(e);if(Element.getStyle(e,"position")=="absolute")return e;var t=Element.positionedOffset(e),n=t[1],r=t[0],i=e.clientWidth,s=e.clientHeight;return e._originalLeft=r-parseFloat(e.style.left||0),e._originalTop=n-parseFloat(e.style.top||0),e._originalWidth=e.style.width,e._originalHeight=e.style.height,e.style.position="absolute",e.style.top=n+"px",e.style.left=r+"px",e.style.width=i+"px",e.style.height=s+"px",e},relativize:function(e){e=$(e);if(Element.getStyle(e,"position")=="relative")return e;e.style.position="relative";var t=parseFloat(e.style.top||0)-(e._originalTop||0),n=parseFloat(e.style.left||0)-(e._originalLeft||0);return e.style.top=t+"px",e.style.left=n+"px",e.style.height=e._originalHeight,e.style.width=e._originalWidth,e},cumulativeScrollOffset:function(e){var t=0,n=0;do t+=e.scrollTop||0,n+=e.scrollLeft||0,e=e.parentNode;while(e);return Element._returnOffset(n,t)},getOffsetParent:function(e){if(e.offsetParent)return $(e.offsetParent);if(e==document.body)return $(e);while((e=e.parentNode)&&e!=document.body)if(Element.getStyle(e,"position")!="static")return $(e);return $(document.body)},viewportOffset:function(e){var t=0,n=0,r=e;do{t+=r.offsetTop||0,n+=r.offsetLeft||0;if(r.offsetParent==document.body&&Element.getStyle(r,"position")=="absolute")break}while(r=r.offsetParent);r=e;do if(!Prototype.Browser.Opera||r.tagName&&r.tagName.toUpperCase()=="BODY")t-=r.scrollTop||0,n-=r.scrollLeft||0;while(r=r.parentNode);return Element._returnOffset(n,t)},clonePosition:function(e,t){var n=Object.extend({setLeft:!0,setTop:!0,setWidth:!0,setHeight:!0,offsetTop:0,offsetLeft:0},arguments[2]||{});t=$(t);var r=Element.viewportOffset(t);e=$(e);var i=[0,0],s=null;return Element.getStyle(e,"position")=="absolute"&&(s=Element.getOffsetParent(e),i=Element.viewportOffset(s)),s==document.body&&(i[0]-=document.body.offsetLeft,i[1]-=document.body.offsetTop),n.setLeft&&(e.style.left=r[0]-i[0]+n.offsetLeft+"px"),n.setTop&&(e.style.top=r[1]-i[1]+n.offsetTop+"px"),n.setWidth&&(e.style.width=t.offsetWidth+"px"),n.setHeight&&(e.style.height=t.offsetHeight+"px"),e}},Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants}),Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}},Prototype.Browser.Opera?(Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(e,t,n){switch(n){case"left":case"top":case"right":case"bottom":if(e(t,"position")==="static")return null;case"height":case"width":if(!Element.visible(t))return null;var r=parseInt(e(t,n),10);if(r!==t["offset"+n.capitalize()])return r+"px";var i;return n==="height"?i=["border-top-width","padding-top","padding-bottom","border-bottom-width"]:i=["border-left-width","padding-left","padding-right","border-right-width"],i.inject(r,function(n,r){var i=e(t,r);return i===null?n:n-parseInt(i,10)})+"px";default:return e(t,n)}}),Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(e,t,n){return n==="title"?t.title:e(t,n)})):Prototype.Browser.IE?(Element.Methods.getOffsetParent=Element.Methods.getOffsetParent.wrap(function(e,t){t=$(t);try{t.offsetParent}catch(n){return $(document.body)}var r=t.getStyle("position");if(r!=="static")return e(t);t.setStyle({position:"relative"});var i=e(t);return t.setStyle({position:r}),i}),$w("positionedOffset viewportOffset").each(function(e){Element.Methods[e]=Element.Methods[e].wrap(function(e,t){t=$(t);try{t.offsetParent}catch(n){return Element._returnOffset(0,0)}var r=t.getStyle("position");if(r!=="static")return e(t);var i=t.getOffsetParent();i&&i.getStyle("position")==="fixed"&&i.setStyle({zoom:1}),t.setStyle({position:"relative"});var s=e(t);return t.setStyle({position:r}),s})}),Element.Methods.cumulativeOffset=Element.Methods.cumulativeOffset.wrap(function(e,t){try{t.offsetParent}catch(n){return Element._returnOffset(0,0)}return e(t)}),Element.Methods.getStyle=function(e,t){e=$(e),t=t=="float"||t=="cssFloat"?"styleFloat":t.camelize();var n=e.style[t];!n&&e.currentStyle&&(n=e.currentStyle[t]);if(t=="opacity"){if(n=(e.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/))if(n[1])return parseFloat(n[1])/100;return 1}return n=="auto"?t!="width"&&t!="height"||e.getStyle("display")=="none"?null:e["offset"+t.capitalize()]+"px":n},Element.Methods.setOpacity=function(e,t){function n(e){return e.replace(/alpha\([^\)]*\)/gi,"")}e=$(e);var r=e.currentStyle;if(r&&!r.hasLayout||!r&&e.style.zoom=="normal")e.style.zoom=1;var i=e.getStyle("filter"),s=e.style;return t==1||t===""?((i=n(i))?s.filter=i:s.removeAttribute("filter"),e):(t<1e-5&&(t=0),s.filter=n(i)+"alpha(opacity="+t*100+")",e)},Element._attributeTranslations=function(){var e="className",t="for",n=document.createElement("div");return n.setAttribute(e,"x"),n.className!=="x"&&(n.setAttribute("class","x"),n.className==="x"&&(e="class")),n=null,n=document.createElement("label"),n.setAttribute(t,"x"),n.htmlFor!=="x"&&(n.setAttribute("htmlFor","x"),n.htmlFor==="x"&&(t="htmlFor")),n=null,{read:{names:{"class":e,className:e,"for":t,htmlFor:t},values:{_getAttr:function(e,t){return e.getAttribute(t)},_getAttr2:function(e,t){return e.getAttribute(t,2)},_getAttrNode:function(e,t){var n=e.getAttributeNode(t);return n?n.value:""},_getEv:function(){var e=document.createElement("div");e.onclick=Prototype.emptyFunction;var t=e.getAttribute("onclick"),n;return String(t).indexOf("{")>-1?n=function(e,t){return t=e.getAttribute(t),t?(t=t.toString(),t=t.split("{")[1],t=t.split("}")[0],t.strip()):null}:t===""&&(n=function(e,t){return t=e.getAttribute(t),t?t.strip():null}),e=null,n}(),_flag:function(e,t){return $(e).hasAttribute(t)?t:null},style:function(e){return e.style.cssText.toLowerCase()},title:function(e){return e.title}}}}}(),Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(e,t){e.checked=!!t},style:function(e,t){e.style.cssText=t?t:""}}},Element._attributeTranslations.has={},$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder").each(function(e){Element._attributeTranslations.write.names[e.toLowerCase()]=e,Element._attributeTranslations.has[e.toLowerCase()]=e}),function(e){Object.extend(e,{href:e._getAttr2,src:e._getAttr2,type:e._getAttr,action:e._getAttrNode,disabled:e._flag,checked:e._flag,readonly:e._flag,multiple:e._flag,onload:e._getEv,onunload:e._getEv,onclick:e._getEv,ondblclick:e._getEv,onmousedown:e._getEv,onmouseup:e._getEv,onmouseover:e._getEv,onmousemove:e._getEv,onmouseout:e._getEv,onfocus:e._getEv,onblur:e._getEv,onkeypress:e._getEv,onkeydown:e._getEv,onkeyup:e._getEv,onsubmit:e._getEv,onreset:e._getEv,onselect:e._getEv,onchange:e._getEv})}(Element._attributeTranslations.read.values),Prototype.BrowserFeatures.ElementExtensions&&function(){function e(e){var t=e.getElementsByTagName("*"),n=[];for(var r=0,i;i=t[r];r++)i.tagName!=="!"&&n.push(i);return n}Element.Methods.down=function(t,n,r){return t=$(t),arguments.length==1?t.firstDescendant():Object.isNumber(n)?e(t)[n]:Element.select(t,n)[r||0]}}()):Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent)?Element.Methods.setOpacity=function(e,t){return e=$(e),e.style.opacity=t==1?.999999:t===""?"":t<1e-5?0:t,e}:Prototype.Browser.WebKit&&(Element.Methods.setOpacity=function(e,t){e=$(e),e.style.opacity=t==1||t===""?"":t<1e-5?0:t;if(t==1)if(e.tagName.toUpperCase()=="IMG"&&e.width)e.width++,e.width--;else try{var n=document.createTextNode(" ");e.appendChild(n),e.removeChild(n)}catch(r){}return e},Element.Methods.cumulativeOffset=function(e){var t=0,n=0;do{t+=e.offsetTop||0,n+=e.offsetLeft||0;if(e.offsetParent==document.body&&Element.getStyle(e,"position")=="absolute")break;e=e.offsetParent}while(e);return Element._returnOffset(n,t)}),"outerHTML"in document.documentElement&&(Element.Methods.replace=function(e,t){e=$(e),t&&t.toElement&&(t=t.toElement());if(Object.isElement(t))return e.parentNode.replaceChild(t,e),e;t=Object.toHTML(t);var n=e.parentNode,r=n.tagName.toUpperCase();if(Element._insertionTranslations.tags[r]){var i=e.next(),s=Element._getContentFromAnonymousElement(r,t.stripScripts());n.removeChild(e),i?s.each(function(e){n.insertBefore(e,i)}):s.each(function(e){n.appendChild(e)})}else e.outerHTML=t.stripScripts();return t.evalScripts.bind(t).defer(),e}),Element._returnOffset=function(e,t){var n=[e,t];return n.left=e,n.top=t,n},Element._getContentFromAnonymousElement=function(e,t){var n=new Element("div"),r=Element._insertionTranslations.tags[e];return r?(n.innerHTML=r[0]+t+r[1],r[2].times(function(){n=n.firstChild})):n.innerHTML=t,$A(n.childNodes)},Element._insertionTranslations={before:function(e,t){e.parentNode.insertBefore(t,e)},top:function(e,t){e.insertBefore(t,e.firstChild)},bottom:function(e,t){e.appendChild(t)},after:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}},function(){var e=Element._insertionTranslations.tags;Object.extend(e,{THEAD:e.TBODY,TFOOT:e.TBODY,TH:e.TD})}(),Element.Methods.Simulated={hasAttribute:function(e,t){t=Element._attributeTranslations.has[t]||t;var n=$(e).getAttributeNode(t);return!!n&&!!n.specified}},Element.Methods.ByTag={},Object.extend(Element,Element.Methods),function(e){!Prototype.BrowserFeatures.ElementExtensions&&e.__proto__&&(window.HTMLElement={},window.HTMLElement.prototype=e.__proto__,Prototype.BrowserFeatures.ElementExtensions=!0),e=null}(document.createElement("div")),Element.extend=function(){function e(e){if(typeof window.Element!="undefined"){var t=window.Element.prototype;if(t){var n="_"+(Math.random()+"").slice(2),r=document.createElement(e);t[n]="x";var i=r[n]!=="x";return delete t[n],r=null,i}}return!1}function t(e,t){for(var n in t){var r=t[n];Object.isFunction(r)&&!(n in e)&&(e[n]=r.methodize())}}var n=e("object");if(Prototype.BrowserFeatures.SpecificElementExtensions)return n?function(e){if(e&&typeof e._extendedByPrototype=="undefined"){var n=e.tagName;n&&/^(?:object|applet|embed)$/i.test(n)&&(t(e,Element.Methods),t(e,Element.Methods.Simulated),t(e,Element.Methods.ByTag[n.toUpperCase()]))}return e}:Prototype.K;var r={},i=Element.Methods.ByTag,s=Object.extend(function(e){if(!e||typeof e._extendedByPrototype!="undefined"||e.nodeType!=1||e==window)return e;var n=Object.clone(r),s=e.tagName.toUpperCase();return i[s]&&Object.extend(n,i[s]),t(e,n),e._extendedByPrototype=Prototype.emptyFunction,e},{refresh:function(){Prototype.BrowserFeatures.ElementExtensions||(Object.extend(r,Element.Methods),Object.extend(r,Element.Methods.Simulated))}});return s.refresh(),s}(),Element.hasAttribute=function(e,t){return e.hasAttribute?e.hasAttribute(t):Element.Methods.Simulated.hasAttribute(e,t)},Element.addMethods=function(e){function i(t){t=t.toUpperCase(),Element.Methods.ByTag[t]||(Element.Methods.ByTag[t]={}),Object.extend(Element.Methods.ByTag[t],e)}function s(e,t,n){n=n||!1;for(var r in e){var i=e[r];if(!Object.isFunction(i))continue;if(!n||!(r in t))t[r]=i.methodize()}}function o(e){var t,n={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};n[e]&&(t="HTML"+n[e]+"Element");if(window[t])return window[t];t="HTML"+e+"Element";if(window[t])return window[t];t="HTML"+e.capitalize()+"Element";if(window[t])return window[t];var r=document.createElement(e),i=r.__proto__||r.constructor.prototype;return r=null,i}var t=Prototype.BrowserFeatures,n=Element.Methods.ByTag;e||(Object.extend(Form,Form.Methods),Object.extend(Form.Element,Form.Element.Methods),Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods)}));if(arguments.length==2){var r=e;e=arguments[1]}r?Object.isArray(r)?r.each(i):i(r):Object.extend(Element.Methods,e||{});var u=window.HTMLElement?HTMLElement.prototype:Element.prototype;t.ElementExtensions&&(s(Element.Methods,u),s(Element.Methods.Simulated,u,!0));if(t.SpecificElementExtensions)for(var a in Element.Methods.ByTag){var f=o(a);if(Object.isUndefined(f))continue;s(n[a],f.prototype)}Object.extend(Element,Element.Methods),delete Element.ByTag,Element.extend.refresh&&Element.extend.refresh(),Element.cache={}},document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}},function(e){function s(){return t.WebKit&&!n.evaluate?document:t.Opera&&window.parseFloat(window.opera.version())<9.5?document.body:document.documentElement}function o(t){return r||(r=s()),i[t]="client"+t,e["get"+t]=function(){return r[i[t]]},e["get"+t]()}var t=Prototype.Browser,n=document,r,i={};e.getWidth=o.curry("Width"),e.getHeight=o.curry("Height")}(document.viewport),Element.Storage={UID:1},Element.addMethods({getStorage:function(e){if(!(e=$(e)))return;var t;return e===window?t=0:(typeof e._prototypeUID=="undefined"&&(e._prototypeUID=[Element.Storage.UID++]),t=e._prototypeUID[0]),Element.Storage[t]||(Element.Storage[t]=$H()),Element.Storage[t]},store:function(e,t,n){if(!(e=$(e)))return;return arguments.length===2?Element.getStorage(e).update(t):Element.getStorage(e).set(t,n),e},retrieve:function(e,t,n){if(!(e=$(e)))return;var r=Element.getStorage(e),i=r.get(t);return Object.isUndefined(i)&&(r.set(t,n),i=n),i},clone:function(e,t){if(!(e=$(e)))return;var n=e.cloneNode(t);n._prototypeUID=void 0;if(t){var r=Element.select(n,"*"),i=r.length;while(i--)r[i]._prototypeUID=void 0}return Element.extend(n)}});var Selector=Class.create({initialize:function(e){this.expression=e.strip(),this.shouldUseSelectorsAPI()?this.mode="selectorsAPI":this.shouldUseXPath()?(this.mode="xpath",this.compileXPathMatcher()):(this.mode="normal",this.compileMatcher())},shouldUseXPath:function(){var e=function(){var e=!1;if(document.evaluate&&window.XPathResult){var t=document.createElement("div");t.innerHTML="<ul><li></li></ul><div><ul><li></li></ul></div>";var n=".//*[local-name()='ul' or local-name()='UL']//*[local-name()='li' or local-name()='LI']",r=document.evaluate(n,t,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);e=r.snapshotLength!==2,t=null}return e}();return function(){if(!Prototype.BrowserFeatures.XPath)return!1;var t=this.expression;return Prototype.Browser.WebKit&&(t.include("-of-type")||t.include(":empty"))?!1:/(\[[\w-]*?:|:checked)/.test(t)?!1:e?!1:!0}}(),shouldUseSelectorsAPI:function(){if(!Prototype.BrowserFeatures.SelectorsAPI)return!1;if(Selector.CASE_INSENSITIVE_CLASS_NAMES)return!1;Selector._div||(Selector._div=new Element("div"));try{Selector._div.querySelector(this.expression)}catch(e){return!1}return!0},compileMatcher:function(){var e=this.expression,ps=Selector.patterns,h=Selector.handlers,c=Selector.criteria,le,p,m,len=ps.length,name;if(Selector._cache[e]){this.matcher=Selector._cache[e];return}this.matcher=["this.matcher = function(root) {","var r = root, h = Selector.handlers, c = false, n;"];while(e&&le!=e&&/\S/.test(e)){le=e;for(var i=0;i<len;i++){p=ps[i].re,name=ps[i].name;if(m=e.match(p)){this.matcher.push(Object.isFunction(c[name])?c[name](m):(new Template(c[name])).evaluate(m)),e=e.replace(m[0],"");break}}}this.matcher.push("return h.unique(n);\n}"),eval(this.matcher.join("\n")),Selector._cache[this.expression]=this.matcher},compileXPathMatcher:function(){var e=this.expression,t=Selector.patterns,n=Selector.xpath,r,i,s=t.length,o;if(Selector._cache[e]){this.xpath=Selector._cache[e];return}this.matcher=[".//*"];while(e&&r!=e&&/\S/.test(e)){r=e;for(var u=0;u<s;u++){o=t[u].name;if(i=e.match(t[u].re)){this.matcher.push(Object.isFunction(n[o])?n[o](i):(new Template(n[o])).evaluate(i)),e=e.replace(i[0],"");break}}}this.xpath=this.matcher.join(""),Selector._cache[this.expression]=this.xpath},findElements:function(e){e=e||document;var t=this.expression,n;switch(this.mode){case"selectorsAPI":if(e!==document){var r=e.id,i=$(e).identify();i=i.replace(/([\.:])/g,"\\$1"),t="#"+i+" "+t}return n=$A(e.querySelectorAll(t)).map(Element.extend),e.id=r,n;case"xpath":return document._getElementsByXPath(this.xpath,e);default:return this.matcher(e)}},match:function(e){this.tokens=[];var t=this.expression,n=Selector.patterns,r=Selector.assertions,i,s,o,u=n.length,a;while(t&&i!==t&&/\S/.test(t)){i=t;for(var f=0;f<u;f++){s=n[f].re,a=n[f].name;if(o=t.match(s)){if(!r[a])return this.findElements(document).include(e);this.tokens.push([a,Object.clone(o)]),t=t.replace(o[0],"")}}}var l=!0,a,c;for(var f=0,h;h=this.tokens[f];f++){a=h[0],c=h[1];if(!Selector.assertions[a](e,c)){l=!1;break}}return l},toString:function(){return this.expression},inspect:function(){return"#<Selector:"+this.expression.inspect()+">"}});Prototype.BrowserFeatures.SelectorsAPI&&document.compatMode==="BackCompat"&&(Selector.CASE_INSENSITIVE_CLASS_NAMES=function(){var e=document.createElement("div"),t=document.createElement("span");e.id="prototype_test_id",t.className="Test",e.appendChild(t);var n=e.querySelector("#prototype_test_id .test")!==null;return e=t=null,n}()),Object.extend(Selector,{_cache:{},xpath:{descendant:"//*",child:"/*",adjacent:"/following-sibling::*[1]",laterSibling:"/following-sibling::*",tagName:function(e){return e[1]=="*"?"":"[local-name()='"+e[1].toLowerCase()+"' or local-name()='"+e[1].toUpperCase()+"']"},className:"[contains(concat(' ', @class, ' '), ' #{1} ')]",id:"[@id='#{1}']",attrPresence:function(e){return e[1]=e[1].toLowerCase(),(new Template("[@#{1}]")).evaluate(e)},attr:function(e){return e[1]=e[1].toLowerCase(),e[3]=e[5]||e[6],(new Template(Selector.xpath.operators[e[2]])).evaluate(e)},pseudo:function(e){var t=Selector.xpath.pseudos[e[1]];return t?Object.isFunction(t)?t(e):(new Template(Selector.xpath.pseudos[e[1]])).evaluate(e):""},operators:{"=":"[@#{1}='#{3}']","!=":"[@#{1}!='#{3}']","^=":"[starts-with(@#{1}, '#{3}')]","$=":"[substring(@#{1}, (string-length(@#{1}) - string-length('#{3}') + 1))='#{3}']","*=":"[contains(@#{1}, '#{3}')]","~=":"[contains(concat(' ', @#{1}, ' '), ' #{3} ')]","|=":"[contains(concat('-', @#{1}, '-'), '-#{3}-')]"},pseudos:{"first-child":"[not(preceding-sibling::*)]","last-child":"[not(following-sibling::*)]","only-child":"[not(preceding-sibling::* or following-sibling::*)]",empty:"[count(*) = 0 and (count(text()) = 0)]",checked:"[@checked]",disabled:"[(@disabled) and (@type!='hidden')]",enabled:"[not(@disabled) and (@type!='hidden')]",not:function(e){var t=e[6],n=Selector.patterns,r=Selector.xpath,i,s,o=n.length,u,a=[];while(t&&i!=t&&/\S/.test(t)){i=t;for(var f=0;f<o;f++){u=n[f].name;if(e=t.match(n[f].re)){s=Object.isFunction(r[u])?r[u](e):(new Template(r[u])).evaluate(e),a.push("("+s.substring(1,s.length-1)+")"),t=t.replace(e[0],"");break}}}return"[not("+a.join(" and ")+")]"},"nth-child":function(e){return Selector.xpath.pseudos.nth("(count(./preceding-sibling::*) + 1) ",e)},"nth-last-child":function(e){return Selector.xpath.pseudos.nth("(count(./following-sibling::*) + 1) ",e)},"nth-of-type":function(e){return Selector.xpath.pseudos.nth("position() ",e)},"nth-last-of-type":function(e){return Selector.xpath.pseudos.nth("(last() + 1 - position()) ",e)},"first-of-type":function(e){return e[6]="1",Selector.xpath.pseudos["nth-of-type"](e)},"last-of-type":function(e){return e[6]="1",Selector.xpath.pseudos["nth-last-of-type"](e)},"only-of-type":function(e){var t=Selector.xpath.pseudos;return t["first-of-type"](e)+t["last-of-type"](e)},nth:function(e,t){var n,r=t[6],i;r=="even"&&(r="2n+0"),r=="odd"&&(r="2n+1");if(n=r.match(/^(\d+)$/))return"["+e+"= "+n[1]+"]";if(n=r.match(/^(-?\d*)?n(([+-])(\d+))?/)){n[1]=="-"&&(n[1]=-1);var s=n[1]?Number(n[1]):1,o=n[2]?Number(n[2]):0;return i="[((#{fragment} - #{b}) mod #{a} = 0) and ((#{fragment} - #{b}) div #{a} >= 0)]",(new Template(i)).evaluate({fragment:e,a:s,b:o})}}}},criteria:{tagName:'n = h.tagName(n, r, "#{1}", c);      c = false;',className:'n = h.className(n, r, "#{1}", c);    c = false;',id:'n = h.id(n, r, "#{1}", c);           c = false;',attrPresence:'n = h.attrPresence(n, r, "#{1}", c); c = false;',attr:function(e){return e[3]=e[5]||e[6],(new Template('n = h.attr(n, r, "#{1}", "#{3}", "#{2}", c); c = false;')).evaluate(e)},pseudo:function(e){return e[6]&&(e[6]=e[6].replace(/"/g,'\\"')),(new Template('n = h.pseudo(n, "#{1}", "#{6}", r, c); c = false;')).evaluate(e)},descendant:'c = "descendant";',child:'c = "child";',adjacent:'c = "adjacent";',laterSibling:'c = "laterSibling";'},patterns:[{name:"laterSibling",re:/^\s*~\s*/},{name:"child",re:/^\s*>\s*/},{name:"adjacent",re:/^\s*\+\s*/},{name:"descendant",re:/^\s/},{name:"tagName",re:/^\s*(\*|[\w\-]+)(\b|$)?/},{name:"id",re:/^#([\w\-\*]+)(\b|$)/},{name:"className",re:/^\.([\w\-\*]+)(\b|$)/},{name:"pseudo",re:/^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis)abled|not)(\((.*?)\))?(\b|$|(?=\s|[:+~>]))/},{name:"attrPresence",re:/^\[((?:[\w-]+:)?[\w-]+)\]/},{name:"attr",re:/\[((?:[\w-]*:)?[\w-]+)\s*(?:([!^$*~|]?=)\s*((['"])([^\4]*?)\4|([^'"][^\]]*?)))?\]/}],assertions:{tagName:function(e,t){return t[1].toUpperCase()==e.tagName.toUpperCase()},className:function(e,t){return Element.hasClassName(e,t[1])},id:function(e,t){return e.id===t[1]},attrPresence:function(e,t){return Element.hasAttribute(e,t[1])},attr:function(e,t){var n=Element.readAttribute(e,t[1]);return n&&Selector.operators[t[2]](n,t[5]||t[6])}},handlers:{concat:function(e,t){for(var n=0,r;r=t[n];n++)e.push(r);return e},mark:function(e){var t=Prototype.emptyFunction;for(var n=0,r;r=e[n];n++)r._countedByPrototype=t;return e},unmark:function(){var e=function(){var e=document.createElement("div"),t=!1,n="_countedByPrototype",r="x";return e[n]=r,t=e.getAttribute(n)===r,e=null,t}();return e?function(e){for(var t=0,n;n=e[t];t++)n.removeAttribute("_countedByPrototype");return e}:function(e){for(var t=0,n;n=e[t];t++)n._countedByPrototype=void 0;return e}}(),index:function(e,t,n){e._countedByPrototype=Prototype.emptyFunction;if(t)for(var r=e.childNodes,i=r.length-1,s=1;i>=0;i--){var o=r[i];o.nodeType==1&&(!n||o._countedByPrototype)&&(o.nodeIndex=s++)}else for(var i=0,s=1,r=e.childNodes;o=r[i];i++)o.nodeType==1&&(!n||o._countedByPrototype)&&(o.nodeIndex=s++)},unique:function(e){if(e.length==0)return e;var t=[],n;for(var r=0,i=e.length;r<i;r++)typeof (n=e[r])._countedByPrototype=="undefined"&&(n._countedByPrototype=Prototype.emptyFunction,t.push(Element.extend(n)));return Selector.handlers.unmark(t)},descendant:function(e){var t=Selector.handlers;for(var n=0,r=[],i;i=e[n];n++)t.concat(r,i.getElementsByTagName("*"));return r},child:function(e){var t=Selector.handlers;for(var n=0,r=[],i;i=e[n];n++)for(var s=0,o;o=i.childNodes[s];s++)o.nodeType==1&&o.tagName!="!"&&r.push(o);return r},adjacent:function(e){for(var t=0,n=[],r;r=e[t];t++){var i=this.nextElementSibling(r);i&&n.push(i)}return n},laterSibling:function(e){var t=Selector.handlers;for(var n=0,r=[],i;i=e[n];n++)t.concat(r,Element.nextSiblings(i));return r},nextElementSibling:function(e){while(e=e.nextSibling)if(e.nodeType==1)return e;return null},previousElementSibling:function(e){while(e=e.previousSibling)if(e.nodeType==1)return e;return null},tagName:function(e,t,n,r){var i=n.toUpperCase(),s=[],o=Selector.handlers;if(e){if(r){if(r=="descendant"){for(var u=0,a;a=e[u];u++)o.concat(s,a.getElementsByTagName(n));return s}e=this[r](e);if(n=="*")return e}for(var u=0,a;a=e[u];u++)a.tagName.toUpperCase()===i&&s.push(a);return s}return t.getElementsByTagName(n)},id:function(e,t,n,r){var i=$(n),s=Selector.handlers;if(t==document){if(!i)return[];if(!e)return[i]}else if(!t.sourceIndex||t.sourceIndex<1){var e=t.getElementsByTagName("*");for(var o=0,u;u=e[o];o++)if(u.id===n)return[u]}if(e){if(r)if(r=="child"){for(var a=0,u;u=e[a];a++)if(i.parentNode==u)return[i]}else if(r=="descendant"){for(var a=0,u;u=e[a];a++)if(Element.descendantOf(i,u))return[i]}else if(r=="adjacent"){for(var a=0,u;u=e[a];a++)if(Selector.handlers.previousElementSibling(i)==u)return[i]}else e=s[r](e);for(var a=0,u;u=e[a];a++)if(u==i)return[i];return[]}return i&&Element.descendantOf(i,t)?[i]:[]},className:function(e,t,n,r){return e&&r&&(e=this[r](e)),Selector.handlers.byClassName(e,t,n)},byClassName:function(e,t,n){e||(e=Selector.handlers.descendant([t]));var r=" "+n+" ";for(var i=0,s=[],o,u;o=e[i];i++){u=o.className;if(u.length==0)continue;(u==n||(" "+u+" ").include(r))&&s.push(o)}return s},attrPresence:function(e,t,n,r){e||(e=t.getElementsByTagName("*")),e&&r&&(e=this[r](e));var i=[];for(var s=0,o;o=e[s];s++)Element.hasAttribute(o,n)&&i.push(o);return i},attr:function(e,t,n,r,i,s){e||(e=t.getElementsByTagName("*")),e&&s&&(e=this[s](e));var o=Selector.operators[i],u=[];for(var a=0,f;f=e[a];a++){var l=Element.readAttribute(f,n);if(l===null)continue;o(l,r)&&u.push(f)}return u},pseudo:function(e,t,n,r,i){return e&&i&&(e=this[i](e)),e||(e=r.getElementsByTagName("*")),Selector.pseudos[t](e,n,r)}},pseudos:{"first-child":function(e,t,n){for(var r=0,i=[],s;s=e[r];r++){if(Selector.handlers.previousElementSibling(s))continue;i.push(s)}return i},"last-child":function(e,t,n){for(var r=0,i=[],s;s=e[r];r++){if(Selector.handlers.nextElementSibling(s))continue;i.push(s)}return i},"only-child":function(e,t,n){var r=Selector.handlers;for(var i=0,s=[],o;o=e[i];i++)!r.previousElementSibling(o)&&!r.nextElementSibling(o)&&s.push(o);return s},"nth-child":function(e,t,n){return Selector.pseudos.nth(e,t,n)},"nth-last-child":function(e,t,n){return Selector.pseudos.nth(e,t,n,!0)},"nth-of-type":function(e,t,n){return Selector.pseudos.nth(e,t,n,!1,!0)},"nth-last-of-type":function(e,t,n){return Selector.pseudos.nth(e,t,n,!0,!0)},"first-of-type":function(e,t,n){return Selector.pseudos.nth(e,"1",n,!1,!0)},"last-of-type":function(e,t,n){return Selector.pseudos.nth(e,"1",n,!0,!0)},"only-of-type":function(e,t,n){var r=Selector.pseudos;return r["last-of-type"](r["first-of-type"](e,t,n),t,n)},getIndices:function(e,t,n){return e==0?t>0?[t]:[]:$R(1,n).inject([],function(n,r){return 0==(r-t)%e&&(r-t)/e>=0&&n.push(r),n})},nth:function(e,t,n,r,i){if(e.length==0)return[];t=="even"&&(t="2n+0"),t=="odd"&&(t="2n+1");var s=Selector.handlers,o=[],u=[],a;s.mark(e);for(var f=0,l;l=e[f];f++)l.parentNode._countedByPrototype||(s.index(l.parentNode,r,i),u.push(l.parentNode));if(t.match(/^\d+$/)){t=Number(t);for(var f=0,l;l=e[f];f++)l.nodeIndex==t&&o.push(l)}else if(a=t.match(/^(-?\d*)?n(([+-])(\d+))?/)){a[1]=="-"&&(a[1]=-1);var c=a[1]?Number(a[1]):1,h=a[2]?Number(a[2]):0,p=Selector.pseudos.getIndices(c,h,e.length);for(var f=0,l,d=p.length;l=e[f];f++)for(var v=0;v<d;v++)l.nodeIndex==p[v]&&o.push(l)}return s.unmark(e),s.unmark(u),o},empty:function(e,t,n){for(var r=0,i=[],s;s=e[r];r++){if(s.tagName=="!"||s.firstChild)continue;i.push(s)}return i},not:function(e,t,n){var r=Selector.handlers,i,s,o=(new Selector(t)).findElements(n);r.mark(o);for(var u=0,a=[],f;f=e[u];u++)f._countedByPrototype||a.push(f);return r.unmark(o),a},enabled:function(e,t,n){for(var r=0,i=[],s;s=e[r];r++)!s.disabled&&(!s.type||s.type!=="hidden")&&i.push(s);return i},disabled:function(e,t,n){for(var r=0,i=[],s;s=e[r];r++)s.disabled&&i.push(s);return i},checked:function(e,t,n){for(var r=0,i=[],s;s=e[r];r++)s.checked&&i.push(s);return i}},operators:{"=":function(e,t){return e==t},"!=":function(e,t){return e!=t},"^=":function(e,t){return e==t||e&&e.startsWith(t)},"$=":function(e,t){return e==t||e&&e.endsWith(t)},"*=":function(e,t){return e==t||e&&e.include(t)},"~=":function(e,t){return(" "+e+" ").include(" "+t+" ")},"|=":function(e,t){return("-"+(e||"").toUpperCase()+"-").include("-"+(t||"").toUpperCase()+"-")}},split:function(e){var t=[];return e.scan(/(([\w#:.~>+()\s-]+|\*|\[.*?\])+)\s*(,|$)/,function(e){t.push(e[1].strip())}),t},matchElements:function(e,t){var n=$$(t),r=Selector.handlers;r.mark(n);for(var i=0,s=[],o;o=e[i];i++)o._countedByPrototype&&s.push(o);return r.unmark(n),s},findElement:function(e,t,n){return Object.isNumber(t)&&(n=t,t=!1),Selector.matchElements(e,t||"*")[n||0]},findChildElements:function(e,t){t=Selector.split(t.join(","));var n=[],r=Selector.handlers;for(var i=0,s=t.length,o;i<s;i++)o=new Selector(t[i].strip()),r.concat(n,o.findElements(e));return s>1?r.unique(n):n}}),Prototype.Browser.IE&&Object.extend(Selector.handlers,{concat:function(e,t){for(var n=0,r;r=t[n];n++)r.tagName!=="!"&&e.push(r);return e}});var Form={reset:function(e){return e=$(e),e.reset(),e},serializeElements:function(e,t){typeof t!="object"?t={hash:!!t}:Object.isUndefined(t.hash)&&(t.hash=!0);var n,r,i=!1,s=t.submit,o=e.inject({},function(e,t){return!t.disabled&&t.name&&(n=t.name,r=$(t).getValue(),r!=null&&t.type!="file"&&(t.type!="submit"||!i&&s!==!1&&(!s||n==s)&&(i=!0))&&(n in e?(Object.isArray(e[n])||(e[n]=[e[n]]),e[n].push(r)):e[n]=r)),e});return t.hash?o:Object.toQueryString(o)}};Form.Methods={serialize:function(e,t){return Form.serializeElements(Form.getElements(e),t)},getElements:function(e){var t=$(e).getElementsByTagName("*"),n,r=[],i=Form.Element.Serializers;for(var s=0;n=t[s];s++)r.push(n);return r.inject([],function(e,t){return i[t.tagName.toLowerCase()]&&e.push(Element.extend(t)),e})},getInputs:function(e,t,n){e=$(e);var r=e.getElementsByTagName("input");if(!t&&!n)return $A(r).map(Element.extend);for(var i=0,s=[],o=r.length;i<o;i++){var u=r[i];if(t&&u.type!=t||n&&u.name!=n)continue;s.push(Element.extend(u))}return s},disable:function(e){return e=$(e),Form.getElements(e).invoke("disable"),e},enable:function(e){return e=$(e),Form.getElements(e).invoke("enable"),e},findFirstElement:function(e){var t=$(e).getElements().findAll(function(e){return"hidden"!=e.type&&!e.disabled}),n=t.findAll(function(e){return e.hasAttribute("tabIndex")&&e.tabIndex>=0}).sortBy(function(e){return e.tabIndex}).first();return n?n:t.find(function(e){return/^(?:input|select|textarea)$/i.test(e.tagName)})},focusFirstElement:function(e){return e=$(e),e.findFirstElement().activate(),e},request:function(e,t){e=$(e),t=Object.clone(t||{});var n=t.parameters,r=e.readAttribute("action")||"";return r.blank()&&(r=window.location.href),t.parameters=e.serialize(!0),n&&(Object.isString(n)&&(n=n.toQueryParams()),Object.extend(t.parameters,n)),e.hasAttribute("method")&&!t.method&&(t.method=e.method),new Ajax.Request(r,t)}},Form.Element={focus:function(e){return $(e).focus(),e},select:function(e){return $(e).select(),e}},Form.Element.Methods={serialize:function(e){e=$(e);if(!e.disabled&&e.name){var t=e.getValue();if(t!=undefined){var n={};return n[e.name]=t,Object.toQueryString(n)}}return""},getValue:function(e){e=$(e);var t=e.tagName.toLowerCase();return Form.Element.Serializers[t](e)},setValue:function(e,t){e=$(e);var n=e.tagName.toLowerCase();return Form.Element.Serializers[n](e,t),e},clear:function(e){return $(e).value="",e},present:function(e){return $(e).value!=""},activate:function(e){e=$(e);try{e.focus(),e.select&&(e.tagName.toLowerCase()!="input"||!/^(?:button|reset|submit)$/i.test(e.type))&&e.select()}catch(t){}return e},disable:function(e){return e=$(e),e.disabled=!0,e},enable:function(e){return e=$(e),e.disabled=!1,e}};var Field=Form.Element,$F=Form.Element.Methods.getValue;Form.Element.Serializers={input:function(e,t){switch(e.type.toLowerCase()){case"checkbox":case"radio":return Form.Element.Serializers.inputSelector(e,t);default:return Form.Element.Serializers.textarea(e,t)}},inputSelector:function(e,t){if(Object.isUndefined(t))return e.checked?e.value:null;e.checked=!!t},textarea:function(e,t){if(Object.isUndefined(t))return e.value;e.value=t},select:function(e,t){if(Object.isUndefined(t))return this[e.type=="select-one"?"selectOne":"selectMany"](e);var n,r,i=!Object.isArray(t);for(var s=0,o=e.length;s<o;s++){n=e.options[s],r=this.optionValue(n);if(i){if(r==t){n.selected=!0;return}}else n.selected=t.include(r)}},selectOne:function(e){var t=e.selectedIndex;return t>=0?this.optionValue(e.options[t]):null},selectMany:function(e){var t,n=e.length;if(!n)return null;for(var r=0,t=[];r<n;r++){var i=e.options[r];i.selected&&t.push(this.optionValue(i))}return t},optionValue:function(e){return Element.extend(e).hasAttribute("value")?e.value:e.text}},Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function(e,t,n,r){e(r,n),this.element=$(t),this.lastValue=this.getValue()},execute:function(){var e=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(e)?this.lastValue!=e:String(this.lastValue)!=String(e))this.callback(this.element,e),this.lastValue=e}}),Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}}),Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}}),Abstract.EventObserver=Class.create({initialize:function(e,t){this.element=$(e),this.callback=t,this.lastValue=this.getValue(),this.element.tagName.toLowerCase()=="form"?this.registerFormCallbacks():this.registerCallback(this.element)},onElementEvent:function(){var e=this.getValue();this.lastValue!=e&&(this.callback(this.element,e),this.lastValue=e)},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(e){if(e.type)switch(e.type.toLowerCase()){case"checkbox":case"radio":Event.observe(e,"click",this.onElementEvent.bind(this));break;default:Event.observe(e,"change",this.onElementEvent.bind(this))}}}),Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}}),Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}}),function(){function s(e){return r(e,0)}function o(e){return r(e,1)}function u(e){return r(e,2)}function a(t){t=e.extend(t);var n=t.target,r=t.type,i=t.currentTarget;return i&&i.tagName&&(r==="load"||r==="error"||r==="click"&&i.tagName.toLowerCase()==="input"&&i.type==="radio")&&(n=i),n.nodeType==Node.TEXT_NODE&&(n=n.parentNode),Element.extend(n)}function f(t,n){var r=e.element(t);if(!n)return r;var i=[r].concat(r.ancestors());return Selector.findElement(i,n,0)}function l(e){return{x:c(e),y:h(e)}}function c(e){var t=document.documentElement,n=document.body||{scrollLeft:0};return e.pageX||e.clientX+(t.scrollLeft||n.scrollLeft)-(t.clientLeft||0)}function h(e){var t=document.documentElement,n=document.body||{scrollTop:0};return e.pageY||e.clientY+(t.scrollTop||n.scrollTop)-(t.clientTop||0)}function p(t){e.extend(t),t.preventDefault(),t.stopPropagation(),t.stopped=!0}function m(t,r,i){var s=Element.retrieve(t,"prototype_event_registry");Object.isUndefined(s)&&(y.push(t),s=Element.retrieve(t,"prototype_event_registry",$H()));var o=s.get(r);Object.isUndefined(o)&&(o=[],s.set(r,o));if(o.pluck("handler").include(i))return!1;var u;if(r.include(":"))u=function(n){if(Object.isUndefined(n.eventName))return!1;if(n.eventName!==r)return!1;e.extend(n,t),i.call(t,n)};else if(!!n||r!=="mouseenter"&&r!=="mouseleave")u=function(n){e.extend(n,t),i.call(t,n)};else if(r==="mouseenter"||r==="mouseleave")u=function(n){e.extend(n,t);var r=n.relatedTarget;while(r&&r!==t)try{r=r.parentNode}catch(s){r=t}if(r===t)return;i.call(t,n)};return u.handler=i,o.push(u),u}function g(){for(var t=0,n=y.length;t<n;t++)e.stopObserving(y[t]),y[t]=null}function w(e,t,n){e=$(e);var r=m(e,t,n);if(!r)return e;if(t.include(":"))e.addEventListener?e.addEventListener("dataavailable",r,!1):(e.attachEvent("ondataavailable",r),e.attachEvent("onfilterchange",r));else{var i=b(t);e.addEventListener?e.addEventListener(i,r,!1):e.attachEvent("on"+i,r)}return e}function E(e,t,n){e=$(e);var r=Element.retrieve(e,"prototype_event_registry");if(Object.isUndefined(r))return e;if(t&&!n){var i=r.get(t);return Object.isUndefined(i)?e:(i.each(function(n){Element.stopObserving(e,t,n.handler)}),e)}if(!t)return r.each(function(t){var n=t.key,r=t.value;r.each(function(t){Element.stopObserving(e,n,t.handler)})}),e;var i=r.get(t);if(!i)return;var s=i.find(function(e){return e.handler===n});if(!s)return e;var o=b(t);return t.include(":")?e.removeEventListener?e.removeEventListener("dataavailable",s,!1):(e.detachEvent("ondataavailable",s),e.detachEvent("onfilterchange",s)):e.removeEventListener?e.removeEventListener(o,s,!1):e.detachEvent("on"+o,s),r.set(t,i.without(s)),e}function S(t,n,r,i){t=$(t),Object.isUndefined(i)&&(i=!0),t==document&&document.createEvent&&!t.dispatchEvent&&(t=document.documentElement);var s;return document.createEvent?(s=document.createEvent("HTMLEvents"),s.initEvent("dataavailable",!0,!0)):(s=document.createEventObject(),s.eventType=i?"ondataavailable":"onfilterchange"),s.eventName=n,s.memo=r||{},document.createEvent?t.dispatchEvent(s):t.fireEvent(s.eventType,s),e.extend(s)}var e={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}},t=document.documentElement,n="onmouseenter"in t&&"onmouseleave"in t,r;if(Prototype.Browser.IE){var i={0:1,1:4,2:2};r=function(e,t){return e.button===i[t]}}else Prototype.Browser.WebKit?r=function(e,t){switch(t){case 0:return e.which==1&&!e.metaKey;case 1:return e.which==1&&e.metaKey;default:return!1}}:r=function(e,t){return e.which?e.which===t+1:e.button===t};e.Methods={isLeftClick:s,isMiddleClick:o,isRightClick:u,element:a,findElement:f,pointer:l,pointerX:c,pointerY:h,stop:p};var d=Object.keys(e.Methods).inject({},function(t,n){return t[n]=e.Methods[n].methodize(),t});if(Prototype.Browser.IE){function v(e){var t;switch(e.type){case"mouseover":t=e.fromElement;break;case"mouseout":t=e.toElement;break;default:return null}return Element.extend(t)}Object.extend(d,{stopPropagation:function(){this.cancelBubble=!0},preventDefault:function(){this.returnValue=!1},inspect:function(){return"[object Event]"}}),e.extend=function(t,n){if(!t)return!1;if(t._extendedByPrototype)return t;t._extendedByPrototype=Prototype.emptyFunction;var r=e.pointer(t);return Object.extend(t,{target:t.srcElement||n,relatedTarget:v(t),pageX:r.x,pageY:r.y}),Object.extend(t,d)}}else e.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__,Object.extend(e.prototype,d),e.extend=Prototype.K;var y=[];Prototype.Browser.IE&&window.attachEvent("onunload",g),Prototype.Browser.WebKit&&window.addEventListener("unload",Prototype.emptyFunction,!1);var b=Prototype.K;n||(b=function(e){var t={mouseenter:"mouseover",mouseleave:"mouseout"};return e in t?t[e]:e}),Object.extend(e,e.Methods),Object.extend(e,{fire:S,observe:w,stopObserving:E}),Element.addMethods({fire:S,observe:w,stopObserving:E}),Object.extend(document,{fire:S.methodize(),observe:w.methodize(),stopObserving:E.methodize(),loaded:!1}),window.Event?Object.extend(window.Event,e):window.Event=e}(),function(){function t(){if(document.loaded)return;e&&window.clearTimeout(e),document.loaded=!0,document.fire("dom:loaded")}function n(){document.readyState==="complete"&&(document.stopObserving("readystatechange",n),t())}function r(){try{document.documentElement.doScroll("left")}catch(n){e=r.defer();return}t()}var e;document.addEventListener?document.addEventListener("DOMContentLoaded",t,!1):(document.observe("readystatechange",n),window==top&&(e=r.defer())),Event.observe(window,"load",t)}(),Element.addMethods(),Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;var Insertion={Before:function(e,t){return Element.insert(e,{before:t})},Top:function(e,t){return Element.insert(e,{top:t})},Bottom:function(e,t){return Element.insert(e,{bottom:t})},After:function(e,t){return Element.insert(e,{after:t})}},$continue=new Error('"throw $continue" is deprecated, use "return" instead'),Position={includeScrollOffsets:!1,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},within:function(e,t,n){return this.includeScrollOffsets?this.withinIncludingScrolloffsets(e,t,n):(this.xcomp=t,this.ycomp=n,this.offset=Element.cumulativeOffset(e),n>=this.offset[1]&&n<this.offset[1]+e.offsetHeight&&t>=this.offset[0]&&t<this.offset[0]+e.offsetWidth)},withinIncludingScrolloffsets:function(e,t,n){var r=Element.cumulativeScrollOffset(e);return this.xcomp=t+r[0]-this.deltaX,this.ycomp=n+r[1]-this.deltaY,this.offset=Element.cumulativeOffset(e),this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+e.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+e.offsetWidth},overlap:function(e,t){if(!e)return 0;if(e=="vertical")return(this.offset[1]+t.offsetHeight-this.ycomp)/t.offsetHeight;if(e=="horizontal")return(this.offset[0]+t.offsetWidth-this.xcomp)/t.offsetWidth},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(e){return Position.prepare(),Element.absolutize(e)},relativize:function(e){return Position.prepare(),Element.relativize(e)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(e,t,n){return n=n||{},Element.clonePosition(t,e,n)}};document.getElementsByClassName||(document.getElementsByClassName=function(e){function t(e){return e.blank()?null:"[contains(concat(' ', @class, ' '), ' "+e+" ')]"}return e.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(e,n){n=n.toString().strip();var r=/\s/.test(n)?$w(n).map(t).join(""):t(n);return r?document._getElementsByXPath(".//*"+r,e):[]}:function(e,t){t=t.toString().strip();var n=[],r=/\s/.test(t)?$w(t):null;if(!r&&!t)return n;var i=$(e).getElementsByTagName("*");t=" "+t+" ";for(var s=0,o,u;o=i[s];s++)o.className&&(u=" "+o.className+" ")&&(u.include(t)||r&&r.all(function(e){return!e.toString().blank()&&u.include(" "+e+" ")}))&&n.push(Element.extend(o));return n},function(e,t){return $(t||document.body).getElementsByClassName(e)}}(Element.Methods)),Element.ClassNames=Class.create(),Element.ClassNames.prototype={initialize:function(e){this.element=$(e)},_each:function(e){this.element.className.split(/\s+/).select(function(e){return e.length>0})._each(e)},set:function(e){this.element.className=e},add:function(e){if(this.include(e))return;this.set($A(this).concat(e).join(" "))},remove:function(e){if(!this.include(e))return;this.set($A(this).without(e).join(" "))},toString:function(){return $A(this).join(" ")}},Object.extend(Element.ClassNames.prototype,Enumerable),GlkOte=function(){function S(r){!r&&window.Game&&(r=window.Game);if(!r){R("No game interface object has been provided.");return}if(!r.accept){R("The game interface object must have an accept() function.");return}e=r;if(!window.Prototype){R("The Prototype library has not been loaded.");return}var i=Prototype.Version.split(".");if(i.length<2||i[0]==1&&i[1]<6){R("This version of the Prototype library is too old. (Version "+Prototype.Version+" found; 1.6.0 required.)");return}for(var s in w)E[w[s]]=s;Prototype.Browser.MobileSafari&&(v=!1),Prototype.Browser.IE&&(d=window.XMLHttpRequest!=null),o=new Hash,r.windowport&&(t=r.windowport),r.gameport&&(n=r.gameport);var a=$(t);if(!a){R("Cannot find windowport element #"+t+" in this document.");return}a.update(),Prototype.Browser.MobileSafari||Event.observe(document,"keypress",it),Event.observe(window,"resize",nt);var f=x();if(Object.isString(f)){R(f);return}u=f,m=r.detect_external_links,m&&(g=r.regex_external_links,g||(m=="search"?g=RegExp("\\b((?:https?://)(?:[^\\s()<>]+|\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\))+(?:\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\)|[^\\s`!()\\[\\]{};:'\".,<>?«»“”‘’]))","i"):g=RegExp("^https?:","i"))),tt("init",null,u)}function x(){var t={},r,i,s,o,u,a;r=$(n);if(!r)return"Cannot find gameport element #"+n+" in this document.";var f=r.getDimensions();return t.width=f.width,t.height=f.height,r=$("layouttest_grid"),r?(s=r.getDimensions(),a=$("layouttest_gridspan").getDimensions(),o=$("layouttest_gridline").getDimensions(),u=$("layouttest_gridline2").getDimensions(),t.gridcharheight=$("layouttest_gridline2").positionedOffset().top-$("layouttest_gridline").positionedOffset().top,t.gridcharwidth=a.width/8,t.gridmarginx=s.width-a.width,t.gridmarginy=s.height-(o.height+u.height),r=$("layouttest_buffer"),r?(s=r.getDimensions(),a=$("layouttest_bufferspan").getDimensions(),o=$("layouttest_bufferline").getDimensions(),u=$("layouttest_bufferline2").getDimensions(),t.buffercharheight=$("layouttest_bufferline2").positionedOffset().top-$("layouttest_bufferline").positionedOffset().top,t.buffercharwidth=a.width/8,t.buffermarginx=s.width-a.width,t.buffermarginy=s.height-(o.height+u.height),t.outspacingx=0,t.outspacingy=0,t.inspacingx=0,t.inspacingy=0,e.spacing!=undefined&&(t.outspacingx=e.spacing,t.outspacingy=e.spacing,t.inspacingx=e.spacing,t.inspacingy=e.spacing),e.outspacing!=undefined&&(t.outspacingx=e.outspacing,t.outspacingy=e.outspacing),e.inspacing!=undefined&&(t.inspacingx=e.inspacing,t.inspacingy=e.inspacing),e.inspacingx!=undefined&&(t.inspacingx=e.inspacingx),e.inspacingy!=undefined&&(t.inspacingy=e.inspacingy),e.outspacingx!=undefined&&(t.outspacingx=e.outspacingx),e.outspacingy!=undefined&&(t.outspacingy=e.outspacingy),t):"Cannot find layouttest_grid element for window measurement."):"Cannot find layouttest_grid element for window measurement."}function T(e){X();if(e.type=="error"){R(e.message);return}if(e.type=="pass")return;if(e.type=="retry"){p?q("Event has timed out, but a retry is already queued!"):(q("Event has timed out; will retry..."),V(),p=z.delay(2));return}if(e.type!="update"){q("Ignoring unknown message type "+e.type+".");return}if(e.gen==r){q("Ignoring repeated generation number: "+r);return}if(e.gen<r){q("Ignoring out-of-order generation number: got "+e.gen+", currently at "+r);return}r=e.gen,i&&(o.values().each(function(e){e.inputel&&(e.inputel.disabled=!1)}),i=!1),e.input!=null&&P(e.input),e.windows!=null&&N(e.windows),e.content!=null&&_(e.content),e.input!=null&&H(e.input),e.specialinput!=null&&B(e.specialinput),o.values().each(function(e){if(e.type=="buffer"&&e.needscroll){e.needscroll=!1;if(!e.needspaging){var n=e.frameel;if(!v)n.scrollTop=n.scrollHeight,e.needspaging=!1;else{n.scrollTop=e.topunseen-u.buffercharheight;var r=n.getHeight(),i=j(n),s=n.scrollTop+r;s>i&&(s=i),e.topunseen<s&&(e.topunseen=s),n.scrollTop+r>=n.scrollHeight?e.needspaging=!1:e.needspaging=!1}var o=$("win"+e.id+"_moreprompt");if(!e.needspaging)o&&o.remove();else if(!o){o=new Element("div",{id:"win"+e.id+"_moreprompt","class":"MorePrompt"}),J(o,"More");var a=e.coords.right+20,f=e.coords.bottom;o.setStyle({bottom:f+"px",right:a+"px"}),$(t).insert(o)}}}}),F(!1),i=!1;if(e.disable||e.specialinput)i=!0,o.values().each(function(e){e.inputel&&(e.inputel.disabled=!0)});var n=0;!i&&!c&&o.values().each(function(e){e.input&&(!n||e.id==f)&&(n=e.id)});if(n){var s=function(){var e=o.get(n);e.inputel&&e.inputel.focus()};s.defer()}}function N(e){o.values().each(function(e){e.inplace=!1}),e.map(C);var t=o.values().reject(function(e){return e.inplace});t.map(k)}function C(e){var n,r;if(!e)return;r=o.get(e.id);if(r==null){r={id:e.id,type:e.type,rock:e.rock},o.set(e.id,r);var i;r.type=="grid"&&(i="GridWindow"),r.type=="buffer"&&(i="BufferWindow");var s="WindowRock_"+e.rock;n=new Element("div",{id:"window"+e.id,"class":"WindowFrame "+i+" "+s}),n.winid=e.id,Event.observe(n,"mousedown",function(e){st(e,n)}),v&&r.type=="buffer"&&(n.onscroll=function(){ht(n)}),r.frameel=n,r.gridheight=0,r.gridwidth=0,r.input=null,r.inputel=null,r.terminators={},r.reqhyperlink=!1,r.needscroll=!1,r.needspaging=!1,r.topunseen=0,r.coords={left:null,top:null,right:null,bottom:null},r.history=new Array,r.historypos=0,$(t).insert(n)}else n=r.frameel,r.type!=e.type&&R("Window "+e.id+" was created with type "+r.type+", but now is described as type "+e.type);r.inplace=!0;if(r.type=="grid"){var a;if(e.gridheight>r.gridheight)for(a=r.gridheight;a<e.gridheight;a++){var f=new Element("div",{id:"win"+r.id+"_ln"+a,"class":"GridLine"});f.insert(y),r.frameel.insert(f)}if(e.gridheight<r.gridheight)for(a=e.gridheight;a<r.gridheight;a++){var f=$("win"+r.id+"_ln"+a);f&&f.remove()}r.gridheight=e.gridheight,r.gridwidth=e.gridwidth}r.type=="buffer";var l;if(Prototype.Browser.IE){var c=e.width,h=e.height;e.type=="grid"&&(c-=u.gridmarginx,h-=u.gridmarginy),e.type=="buffer"&&(c-=u.buffermarginx,h-=u.buffermarginy),c<0&&(c=0),h<0&&(h=0),l={left:e.left+"px",top:e.top+"px",width:c+"px",height:h+"px"},r.coords.left=e.left,r.coords.top=e.top,r.coords.right=u.width-(e.left+e.width),r.coords.bottom=u.height-(e.top+e.height)}else{var p=u.width-(e.left+e.width),d=u.height-(e.top+e.height);l={left:e.left+"px",top:e.top+"px",right:p+"px",bottom:d+"px"},r.coords.left=e.left,r.coords.top=e.top,r.coords.right=p,r.coords.bottom=d}n.setStyle(l)}function k(e){e.frameel.remove(),o.unset(e.id),e.frameel=null;var t=$("win"+e.id+"_moreprompt");t&&t.remove()}function M(e){var t=e.length;return y.times(t-1)+" "}function _(e){e.map(D)}function D(e){var t=o.get(e.id);if(t==null){R("Got content update for window "+e.id+", which does not exist.");return}if(t.input&&t.input.type=="line"){R("Got content update for window "+e.id+", which is awaiting line input.");return}t.needscroll=!0;if(t.type=="grid"){var n=e.lines,r,i;for(r=0;r<n.length;r++){var s=n[r],a=s.line,f=s.content,l=$("win"+t.id+"_ln"+a);if(!l){R("Got content for nonexistent line "+a+" of window "+e.id+".");continue}if(!f||!f.length)l.update(y);else{l.update();for(i=0;i<f.length;i++){var c=f[i],h,p,d;c.length===undefined?(h=c.style,p=c.text,d=c.hyperlink):(h=c,i++,p=f[i],d=undefined);var v=new Element("span",{"class":"Style_"+h});if(d==undefined)G(v,p);else{var m=new Element("a",{href:"#"});J(m,p),m.onclick=pt(t.id,d),v.insert(m)}l.insert(v)}}}}if(t.type=="buffer"){var g=e.text,r,i;t.inputel&&t.inputel.remove();var w=$("win"+t.id+"_cursor");w&&w.remove(),w=null,e.clear&&(t.frameel.update(),t.topunseen=0);for(r=0;r<g.length;r++){var E=g[r],f=E.content,S=null;if(E.append){if(!f||!f.length)continue;S=Q(t.frameel)}S==null&&(S=new Element("div",{"class":"BufferLine"}),S.blankpara=!0,S.endswhite=!0,t.frameel.insert(S));if(!f||!f.length){S.blankpara&&S.update(y);continue}S.blankpara&&(S.blankpara=!1,S.update());for(i=0;i<f.length;i++){var c=f[i],h,p,d;c.length===undefined?(h=c.style,p=c.text,d=c.hyperlink):(h=c,i++,p=f[i],d=undefined);var v=new Element("span",{"class":"Style_"+h});p=p.replace(O,M),S.endswhite&&(p=p.replace(L,y));if(d==undefined)G(v,p);else{var m=new Element("a",{href:"#"});J(m,p),m.onclick=pt(t.id,d),v.insert(m)}S.insert(v),S.endswhite=A.test(p)}}var x=t.frameel.childNodes;if(x){var T=x.length-b;if(T>0){var r,N;t.topunseen-=x[T].offsetTop,t.topunseen<0&&(t.topunseen=0);for(r=0;r<T;r++)N=x.item(0),N&&t.frameel.removeChild(N)}}var S=Q(t.frameel);if(S){w=new Element("span",{id:"win"+t.id+"_cursor","class":"InvisibleCursor"}),J(w,y),S.insert(w);if(t.inputel){var C=t.inputel,k=w.positionedOffset(),_=t.frameel.getWidth()-(u.buffermarginx+k.left+2);_<1&&(_=1),Prototype.Browser.Opera?(C.setStyle({position:"relative",left:"0px",top:"0px",width:_+"px"}),w.insert({top:C})):(C.setStyle({position:"absolute",left:"0px",top:"0px",width:_+"px"}),w.insert(C))}}}}function P(e){var t=new Hash;e.map(function(e){e.type&&t.set(e.id,e)}),o.values().each(function(e){if(e.input){var n=t.get(e.id);if(n==null||n.gen>e.input.gen)e.input=null,e.inputel&&(e.inputel.remove(),e.inputel=null)}})}function H(e){var t=new Hash,n=new Hash;e.map(function(e){e.type&&t.set(e.id,e),e.hyperlink&&n.set(e.id,!0)}),o.values().each(function(e){e.reqhyperlink=n.get(e.id);var r=t.get(e.id);if(r==null)return;e.input=r;var i=1;r.type=="line"&&(i=r.maxlen);var s=e.inputel;if(s==null){var o="Input";r.type=="line"?o+=" LineInput":r.type=="char"?o+=" CharInput":R("Window "+e.id+" has requested unrecognized input type "+r.type+"."),s=new Element("input",{id:"win"+e.id+"_input","class":o,type:"text",maxlength:i}),Prototype.Browser.MobileSafari&&s.writeAttribute("autocapitalize","off");if(r.type=="line"){s.onkeypress=ft,s.onkeydown=at,r.initial&&(s.value=r.initial),e.terminators={};if(r.terminators)for(var a=0;a<r.terminators.length;a++)e.terminators[r.terminators[a]]=!0}else r.type=="char"&&(s.onkeypress=ut,s.onkeydown=ot);var f=e.id;s.onfocus=function(){lt(f)},s.onblur=function(){ct(f)},s.winid=e.id,e.inputel=s,e.historypos=e.history.length,e.needscroll=!0}if(e.type=="grid"){var l=$("win"+e.id+"_ln"+r.ypos);if(!l){R("Window "+e.id+" has requested input at unknown line "+r.ypos+".");return}var c=l.positionedOffset(),h=c.left+Math.round(r.xpos*u.gridcharwidth),p=Math.round(i*u.gridcharwidth),d=e.frameel.getWidth()-(u.buffermarginx+h+2);p>d&&(p=d),s.setStyle({position:"absolute",left:h+"px",top:c.top+"px",width:p+"px"}),e.frameel.insert(s)}if(e.type=="buffer"){var v=$("win"+e.id+"_cursor");v||(v=new Element("span",{id:"win"+e.id+"_cursor","class":"InvisibleCursor"}),J(v,y),e.frameel.insert(v));var c=v.positionedOffset(),p=e.frameel.getWidth()-(u.buffermarginx+c.left+2);p<1&&(p=1),Prototype.Browser.Opera?(s.setStyle({position:"relative",left:"0px",top:"0px",width:p+"px"}),v.insert({top:s})):(s.setStyle({position:"absolute",left:"0px",top:"0px",width:p+"px"}),v.insert(s))}})}function B(e){if(e.type=="fileref_prompt"){var t=function(e){tt("specialresponse",null,"fileref_prompt",e)};try{var n=e.filemode!="read";Dialog.open(n,e.filetype,e.gameid,t)}catch(r){GlkOte.log("Unable to open file dialog: "+r),t.defer(null)}}else R("Request for unknown special input type: "+e.type)}function j(e){var t=e.childElements();return t.length==0?0:t[t.length-1].offsetTop}function F(e){c=0;var t=0;v&&o.values().each(function(e){if(e.needspaging){c+=1;if(!t||e.id==l)t=e.id}}),c&&(l=t);if(!c&&e){var n=0;!i&&!c&&o.values().each(function(e){e.input&&(!n||e.id==f)&&(n=e.id)});if(n){var r=o.get(n);r.inputel&&r.inputel.focus()}}}function I(){return e}function q(e){window.console&&console.log?console.log(e):window.opera&&opera.postError&&opera.postError(e)}function R(e){var t=document.getElementById("errorcontent");K(t),J(t,e),t=document.getElementById("errorpane"),t.style.display="",X()}function U(e){tt("external",null,e)}function z(){p=null,q("Retrying update..."),tt("refresh",null,null)}function W(){$("errorpane").hide()}function X(){if(s==0)return;s=!1;var e=document.getElementById("loadingpane");e&&(e.style.display="none")}function V(){if(s==1)return;s=!0;var e=document.getElementById("loadingpane");e&&(e.style.display="")}function J(e,t){var n=document.createTextNode(t);e.appendChild(n)}function K(e){var t,n;n=e.childNodes;while(n.length>0)t=n.item(0),e.removeChild(t)}function Q(e){var t=e.childElements();return!t||!t.length?null:t[t.length-1]}function G(e,t){if(!m){var n=document.createTextNode(t);e.appendChild(n);return}if(m=="match"){if(g.test(t)){var r=new Element("a",{href:t,"class":"External",target:"_blank"}),n=document.createTextNode(t);r.appendChild(n),e.insert(r);return}}else if(m=="search"){for(;;){var i=g.exec(t);if(!i)break;if(i.index>0){var s=t.substring(0,i.index),n=document.createTextNode(s);e.appendChild(n)}var r=new Element("a",{href:i[0],"class":"External",target:"_blank"}),n=document.createTextNode(i[0]);r.appendChild(n),e.insert(r),t=t.substring(i.index+i[0].length)}if(!t.length)return}var n=document.createTextNode(t);e.appendChild(n)}function Y(){var e=Object.keys(this);e.sort();var t=e.map(function(e){var t=this[e];return t==Y&&(t="[...]"),e+":"+t},this);return"{"+t.join(", ")+"}"}function Z(e){var t=Object.keys(e);t.sort();var n=t.map(function(t){var n=e[t];return Object.isString(n)?n="'"+n+"'":Object.isNumber(n)||(n=Z(n)),t+":"+n},e);return"{"+n.join(", ")+"}"}function et(e,t,n){var r=t.value;r&&r!=e.history.last()&&(e.history.push(r),e.history.length>20&&e.history.shift()),tt("line",e,r,n)}function tt(t,n,s,u){if(i&&t!="specialresponse")return;var a=0;n&&(a=n.id);var f={type:t,gen:r};if(t=="line")f.window=n.id,f.value=s,u&&(f.terminator=u);else if(t=="char")f.window=n.id,f.value=s;else if(t=="hyperlink")f.window=n.id,f.value=s;else if(t=="external")f.value=s;else if(t=="specialresponse")f.response=s,f.value=u;else if(t=="init"||t=="arrange")f.metrics=s;t!="init"&&t!="refresh"&&t!="specialresponse"&&o.values().each(function(e){var n=t!="line"&&t!="char"||e.id!=a;if(n&&e.input&&e.input.type=="line"&&e.inputel&&e.inputel.value){var r=f.partial;r||(r={},f.partial=r),r[e.id]=e.inputel.value}}),e.accept(f)}function nt(e){h!=null&&(window.clearTimeout(h),h=null),h=rt.delay(.5)}function rt(){h=null;if(i){h=rt.delay(.5);return}u=x(),tt("arrange",null,u)}function it(e){if(i)return;var t=0;Prototype.Browser.IE?(e=Event.extend(window.event),e&&(t=e.keyCode)):e&&(t=e.which);if(e.target.tagName.toUpperCase()=="INPUT")return;if(e.altKey||e.metaKey||e.ctrlKey)return;if(Prototype.Browser.Opera){if(!t)return;if(t<32&&t!=13)return}var n;if(c){n=o.get(l);if(n){if(t>=32&&t<=126||t==13){e.preventDefault();var r=n.frameel;r.scrollTop=n.topunseen-u.buffercharheight;var s=r.getHeight(),a=j(r),h=r.scrollTop+s;h>a&&(h=a),n.topunseen<h&&(n.topunseen=h);if(n.needspaging&&r.scrollTop+s>=r.scrollHeight){n.needspaging=!1;var p=$("win"+n.id+"_moreprompt");p&&p.remove(),F(!0)}return}return}}n=o.get(f);if(!n)return;if(!n.inputel)return;n.inputel.focus();if(n.input.type!="line"){var v=null;t==13?v="return":t==Event.KEY_BACKSPACE?v="delete":t&&(v=String.fromCharCode(t)),v&&tt("char",n,v),e.preventDefault();return}if(t==13){et(n,n.inputel,null),e.preventDefault();return}if(t){if(t>=32){var d=String.fromCharCode(t);n.inputel.value=n.inputel.value+d}e.preventDefault();return}}function st(e,t){if(!t.winid)return;var n=o.get(t.winid);if(!n)return;n.inputel&&(f=n.id,Prototype.Browser.MobileSafari&&(e.stop(),n.inputel.focus())),n.needspaging?l=n.id:n.inputel&&(l=0)}function ot(e){var t=0;e||(e=Event.extend(window.event)),e&&(t=e.keyCode);if(!t)return!0;var n=null;switch(t){case Event.KEY_LEFT:n="left";break;case Event.KEY_RIGHT:n="right";break;case Event.KEY_UP:n="up";break;case Event.KEY_DOWN:n="down";break;case Event.KEY_BACKSPACE:n="delete";break;case Event.KEY_ESC:n="escape";break;case Event.KEY_TAB:n="tab";break;case Event.KEY_PAGEUP:n="pageup";break;case Event.KEY_PAGEDOWN:n="pagedown";break;case Event.KEY_HOME:n="home";break;case Event.KEY_END:n="end";break;case 112:n="func1";break;case 113:n="func2";break;case 114:n="func3";break;case 115:n="func4";break;case 116:n="func5";break;case 117:n="func6";break;case 118:n="func7";break;case 119:n="func8";break;case 120:n="func9";break;case 121:n="func10";break;case 122:n="func11";break;case 123:n="func12"}if(n){if(!this.winid)return!0;var r=o.get(this.winid);return!r||!r.input?!0:(tt("char",r,n),!1)}return!0}function ut(e){var t=0;e?e&&(t=e.which):(e=Event.extend(window.event),e&&(t=e.keyCode));if(!t)return!1;t==10&&Prototype.Browser.MobileSafari&&(t=13);var n;t==13?n="return":n=String.fromCharCode(t);if(!this.winid)return!0;var r=o.get(this.winid);return!r||!r.input?!0:(tt("char",r,n),!1)}function at(e){var t=0;e||(e=Event.extend(window.event)),e&&(t=e.keyCode);if(!t)return!0;if(t==Event.KEY_UP||t==Event.KEY_DOWN){if(!this.winid)return!0;var n=o.get(this.winid);return!n||!n.input?!0:(t==Event.KEY_UP&&n.historypos>0&&(n.historypos-=1,n.historypos<n.history.length?this.value=n.history[n.historypos]:this.value=""),t==Event.KEY_DOWN&&n.historypos<n.history.length&&(n.historypos+=1,n.historypos<n.history.length?this.value=n.history[n.historypos]:this.value=""),!1)}if(E[t]){if(!this.winid)return!0;var n=o.get(this.winid);if(!n||!n.input)return!0;if(n.terminators[E[t]])return et(n,n.inputel,E[t]),!1}return!0}function ft(e){var t=0;e?e&&(t=e.which):(e=Event.extend(window.event),e&&(t=e.keyCode));if(!t)return!0;t==10&&Prototype.Browser.MobileSafari&&(t=13);if(t==13){if(!this.winid)return!0;var n=o.get(this.winid);return!n||!n.input?!0:(et(n,this,null),!1)}return!0}function lt(e){var t=o.get(e);if(!t)return;a=!0,f=e,l=e}function ct(e){var t=o.get(e);if(!t)return;a=!1}function ht(e){if(!e.winid)return;var t=o.get(e.winid);if(!t)return;if(!t.needspaging)return;var n=e.getHeight(),r=j(e),i=e.scrollTop+n;i>r&&(i=r),t.topunseen<i&&(t.topunseen=i);if(e.scrollTop+n>=e.scrollHeight){t.needspaging=!1;var s=$("win"+t.id+"_moreprompt");s&&s.remove(),F(!0);return}}function pt(e,t){return function(){var n=o.get(e);return n?n.reqhyperlink?(tt("hyperlink",n,t),!1):!1:!1}}var e=null,t="windowport",n="gameport",r=0,i=!1,s=null,o=null,u=null,a=!1,f=0,l=0,c=0,h=null,p=null,d=!1,v=!0,m=!1,g=null,y=" ",b=200,w={escape:Event.KEY_ESC,func1:112,func2:113,func3:114,func4:115,func5:116,func6:117,func7:118,func8:119,func9:120,func10:121,func11:122,func12:123},E={},L=new RegExp("^ "),A=new RegExp(" $"),O=new RegExp("  +","g");return{version:"1.3.1",init:S,update:T,extevent:U,getinterface:I,log:q,error:R}}(),Dialog=function(){function dialog_open(e,t,n,r){if(is_open)throw"Dialog: dialog box is already open.";if(localStorage==null)throw"Dialog: your browser does not support local storage.";dialog_callback=r,will_save=e,confirming=!1,editing=!1,editing_dirent=null,cur_usage=t,cur_gameid=n,cur_usage_name=label_for_usage(cur_usage);var i="windowport",s=window.Game;window.GlkOte&&(s=window.GlkOte.getinterface()),s&&s.windowport&&(i=s.windowport);var o=$(i);if(!o)throw"Dialog: unable to find root element #"+i+".";var u=$(dialog_el_id+"_screen");u||(u=new Element("div",{id:dialog_el_id+"_screen"}),o.insert(u));var a=$(dialog_el_id+"_frame");a||(a=new Element("div",{id:dialog_el_id+"_frame"}),o.insert(a));var f=$(dialog_el_id);f&&f.remove(),f=new Element("div",{id:dialog_el_id});var l,c,h;l=new Element("form"),l.observe("submit",will_save?evhan_accept_save_button:evhan_accept_load_button),f.insert(l),h=new Element("div",{"class":"DiaButtonsFloat"}),c=new Element("button",{id:dialog_el_id+"_edit",type:"button"}),insert_text(c,"Edit"),c.observe("click",evhan_edit_button),h.insert(c),l.insert(h),h=new Element("div",{id:dialog_el_id+"_cap","class":"DiaCaption"}),insert_text(h,"XXX"),l.insert(h),will_save&&(h=new Element("div",{id:dialog_el_id+"_input","class":"DiaInput"}),l.insert(h),c=new Element("input",{id:dialog_el_id+"_infield",type:"text",name:"filename"}),h.insert(c)),h=new Element("div",{id:dialog_el_id+"_body","class":"DiaBody"}),l.insert(h),h=new Element("div",{id:dialog_el_id+"_cap2","class":"DiaCaption"}),h.hide(),l.insert(h),h=new Element("div",{id:dialog_el_id+"_buttonrow","class":"DiaButtons"}),c=new Element("button",{id:dialog_el_id+"_cancel",type:"button"}),insert_text(c,"Cancel"),c.observe("click",evhan_cancel_button),h.insert(c),c=new Element("button",{id:dialog_el_id+"_delete",type:"button"}),insert_text(c,"Delete"),c.observe("click",evhan_delete_button),c.hide(),h.insert(c),c=new Element("button",{id:dialog_el_id+"_display",type:"button"}),insert_text(c,"Display"),c.observe("click",evhan_display_button),c.hide(),h.insert(c),c=new Element("button",{id:dialog_el_id+"_accept",type:"submit"}),insert_text(c,will_save?"Save":"Load"),c.observe("click",will_save?evhan_accept_save_button:evhan_accept_load_button),h.insert(c),l.insert(h),a.insert(f),is_open=!0,evhan_storage_changed();var p;will_save?p=function(){var e=$(dialog_el_id+"_infield");e&&e.focus()}:p=function(){var e=$(dialog_el_id+"_select");e&&e.focus()},p.defer()}function dialog_close(){var e=$(dialog_el_id);e&&e.remove();var t=$(dialog_el_id+"_frame");t&&t.remove();var n=$(dialog_el_id+"_screen");n&&n.remove(),is_open=!1,dialog_callback=null,cur_filelist=null,editing=!1,editing_dirent=null}function set_caption(e,t){var n=t?dialog_el_id+"_cap":dialog_el_id+"_cap2",r=$(n);if(!r)return;e?(remove_children(r),insert_text(r,e),r.show()):r.hide()}function label_for_usage(e){switch(e){case"data":return"data file";case"save":return"save file";case"transcript":return"transcript";case"command":return"command script";default:return"file"}}function usage_is_textual(e){return e=="transcript"||e=="command"}function insert_text(e,t){var n=document.createTextNode(t);e.appendChild(n)}function remove_children(e){var t,n;n=e.childNodes;while(n.length>0)t=n.item(0),e.removeChild(t)}function replace_text(e,t){remove_children(e),insert_text(e,t)}function evhan_select_change(){if(!is_open)return!1;if(confirming)return!1;var e=$(dialog_el_id+"_select");if(!e)return!1;var t=e.selectedIndex;if(!cur_filelist||t<0||t>=cur_filelist.length)return!1;var n=cur_filelist[t],r=$(dialog_el_id+"_infield");return r?(r.value=n.dirent.filename,!1):!1}function evhan_select_change_editing(){if(!is_open)return!1;if(!editing||editing_dirent)return!1;var e=$(dialog_el_id+"_select");if(!e)return!1;var t=e.selectedIndex;if(!cur_filelist||t<0||t>=cur_filelist.length)return!1;var n=cur_filelist[t];if(!n.dirent||!file_ref_exists(n.dirent))return!1;butel=$(dialog_el_id+"_delete"),butel.disabled=!1,butel=$(dialog_el_id+"_display"),butel.disabled=!usage_is_textual(n.dirent.usage)}function evhan_accept_load_button(e){e.stop();if(!is_open)return!1;if(editing)return!1;var t=$(dialog_el_id+"_select");if(!t)return!1;var n=t.selectedIndex;if(!cur_filelist||n<0||n>=cur_filelist.length)return!1;var r=cur_filelist[n];if(!r.dirent||!file_ref_exists(r.dirent))return!1;var i=dialog_callback;return dialog_close(),i&&i(r.dirent),!1}function evhan_accept_save_button(e){e.stop();if(!is_open)return!1;if(editing)return!1;var t=$(dialog_el_id+"_infield");if(!t)return!1;var n=t.value;n=n.strip();if(!n)return!1;var r=file_construct_ref(n,cur_usage,cur_gameid);if(file_ref_exists(r)&&!confirming){confirming=!0,set_caption("You already have a "+cur_usage_name+' "'+r.filename+'". Do you want to replace it?',!1),t.disabled=!0;var i=$(dialog_el_id+"_accept");return replace_text(i,"Replace"),!1}var s=dialog_callback;return dialog_close(),s&&s(r),!1}function evhan_edit_button(e){e.stop();if(!is_open)return!1;if(!editing){editing=!0,editing_dirent=null;if(confirming){confirming=!1,set_caption(null,!1);var t=$(dialog_el_id+"_infield");t.disabled=!1;var n=$(dialog_el_id+"_accept");n.disabled=!1,replace_text(n,"Save")}var t=$(dialog_el_id+"_input");t&&t.hide();var n=$(dialog_el_id+"_edit");return replace_text(n,"Done"),n=$(dialog_el_id+"_delete"),n.show(),n=$(dialog_el_id+"_display"),n.show(),n=$(dialog_el_id+"_accept"),n.hide(),evhan_storage_changed(),!1}if(!editing_dirent){editing=!1,editing_dirent=null;var t=$(dialog_el_id+"_input");t&&t.show();var n=$(dialog_el_id+"_edit");return replace_text(n,"Edit"),n=$(dialog_el_id+"_delete"),n.hide(),n=$(dialog_el_id+"_display"),n.hide(),n=$(dialog_el_id+"_accept"),n.show(),evhan_storage_changed(),!1}editing=!0,editing_dirent=null,$(dialog_el_id+"_buttonrow").show();var n=$(dialog_el_id+"_edit");return replace_text(n,"Done"),evhan_storage_changed(),!1}function evhan_delete_button(e){e.stop();if(!is_open)return!1;if(!editing||editing_dirent)return!1;var t=$(dialog_el_id+"_select");if(!t)return!1;var n=t.selectedIndex;if(!cur_filelist||n<0||n>=cur_filelist.length)return!1;var r=cur_filelist[n];return r.dirent?(file_remove_ref(r.dirent),evhan_storage_changed(),!1):!1}function evhan_display_button(e){e.stop();if(!is_open)return!1;if(!editing||editing_dirent)return!1;var t=$(dialog_el_id+"_select");if(!t)return!1;var n=t.selectedIndex;if(!cur_filelist||n<0||n>=cur_filelist.length)return!1;var r=cur_filelist[n];if(!r.dirent||!file_ref_exists(r.dirent))return!1;$(dialog_el_id+"_buttonrow").hide();var i=$(dialog_el_id+"_edit");return replace_text(i,"Close"),editing_dirent=r.dirent,evhan_storage_changed(),!1}function evhan_cancel_button(e){e.stop();if(!is_open)return!1;if(confirming){confirming=!1,set_caption(null,!1);var t=$(dialog_el_id+"_infield");t.disabled=!1;var n=$(dialog_el_id+"_accept");return n.disabled=!1,replace_text(n,"Save"),!1}var r=dialog_callback;return dialog_close(),r&&r(null),!1}function evhan_storage_changed(e){if(!is_open)return!1;var t,n,r,i,s=null;e&&(s=e.key),n=$(dialog_el_id+"_body");if(!n)return!1;if(editing&&editing_dirent&&!file_ref_exists(editing_dirent)){editing_dirent=null,$(dialog_el_id+"_buttonrow").show();var o=$(dialog_el_id+"_edit");replace_text(o,"Done")}if(editing&&editing_dirent){remove_children(n);var u=file_read(editing_dirent);u=String.fromCharCode.apply(this,u);var a=new Element("div",{"class":"DiaDisplayText"}),f=document.createTextNode(u);return a.appendChild(f),n.insert(a),set_caption("Displaying file contents...",!0),!1}if(editing){r=files_list(null,cur_gameid),cur_gameid!=""&&(r=r.concat(files_list(null,""))),r.sort(function(e,t){return e.dirent.usage!=t.dirent.usage?e.dirent.usage<t.dirent.usage:t.modified.getTime()-e.modified.getTime()});if(r.length==0)return remove_children(n),o=$(dialog_el_id+"_delete"),o.disabled=!0,o=$(dialog_el_id+"_display"),o.disabled=!0,set_caption("You have no stored files. Press Done to continue.",!0),!1;cur_filelist=[],i="";for(c=0;c<r.length;c++)h=r[c],h.dirent.usage!=i&&(i=h.dirent.usage,cur_filelist.push({label:i})),cur_filelist.push(h);r=cur_filelist,remove_children(n);var l=new Element("select",{id:dialog_el_id+"_select",name:"files",size:"5"}),c,h,p,d=!1;for(c=0;c<r.length;c++){h=r[c];if(!h.dirent){t=new Element("option",{name:"f"+c}),t.disabled=!0,insert_text(t,"-- "+label_for_usage(h.label)+"s --"),l.insert(t);continue}t=new Element("option",{name:"f"+c}),d||(d=!0,t.selected=!0),p=format_date(h.modified),insert_text(t,h.dirent.filename+" -- "+p),l.insert(t)}return n.insert(l),l.onchange=evhan_select_change_editing,evhan_select_change_editing(),set_caption("All stored files are now visible. You may delete them, and display files containing text. Press Done when finished.",!0),!1}r=files_list(cur_usage,cur_gameid),r.sort(function(e,t){return t.modified.getTime()-e.modified.getTime()}),cur_filelist=r;if(r.length==0)remove_children(n);else{remove_children(n);var l=new Element("select",{id:dialog_el_id+"_select",name:"files",size:"5"}),c,h,p;for(c=0;c<r.length;c++)h=r[c],t=new Element("option",{name:"f"+c}),c==0&&(t.selected=!0),p=format_date(h.modified),insert_text(t,h.dirent.filename+" -- "+p),l.insert(t);n.insert(l),will_save&&(l.onchange=evhan_select_change)}will_save?(set_caption("Name this "+cur_usage_name+".",!0),t=$(dialog_el_id+"_accept"),t.disabled=!1):r.length==0?(set_caption("You have no "+cur_usage_name+"s for this game.",!0),t=$(dialog_el_id+"_accept"),t.disabled=!0):(set_caption("Select a "+cur_usage_name+" to load.",!0),t=$(dialog_el_id+"_accept"),t.disabled=!1)}function file_construct_ref(e,t,n){e||(e=""),t||(useage=""),n||(n="");var r=t+":"+n+":"+e,i={dirent:"dirent:"+r,content:"content:"+r,filename:e,usage:t,gameid:n};return i}function file_decode_ref(e){if(!e.startsWith("dirent:"))return null;var t=7,n=e.indexOf(":",t);if(n<0)return null;var r=e.slice(t,n);t=n+1,n=e.indexOf(":",t);if(n<0)return null;var i=e.slice(t,n);t=n+1;var s=e.slice(t),o="cont"+e.slice(3),u={dirent:e,content:o,filename:s,usage:r,gameid:i};return u}function file_load_dirent(e){if(typeof e!="object"){e=file_decode_ref(e);if(!e)return null}var t=localStorage.getItem(e.dirent);if(!t)return null;var n={dirent:e},r,i,s,o,u=t.toString().split(",");for(r=0;r<u.length;r++){o=u[r],i=o.indexOf(":");if(i<0)continue;s=o.slice(0,i),o=o.slice(i+1);switch(s){case"created":n.created=new Date(Number(o));break;case"modified":n.modified=new Date(Number(o))}}return n}function file_ref_exists(e){var t=localStorage.getItem(e.dirent);return t?!0:!1}function file_remove_ref(e){localStorage.removeItem(e.dirent),localStorage.removeItem(e.content)}function file_write(e,t,n){var r,i,s=file_load_dirent(e);return s||(s={dirent:e,created:new Date}),s.modified=new Date,n||(t=encode_array(t)),i=[],s.created&&i.push("created:"+s.created.getTime()),s.modified&&i.push("modified:"+s.modified.getTime()),r=i.join(","),localStorage.setItem(s.dirent.dirent,r),localStorage.setItem(s.dirent.content,t),!0}function file_read(e,t){var n=file_load_dirent(e);if(!n)return null;var r=localStorage.getItem(e.content);return r==null?null:(r=r.toString(),r?t?r:decode_array(r):t?"":[])}function file_ref_matches(e,t,n){return t!=null&&e.usage!=t?!1:n!=null&&e.gameid!=n?!1:!0}function files_list(e,t){var n,r=[];if(!localStorage)return r;for(n=0;n<localStorage.length;n++){var i=localStorage.key(n);if(!i)continue;var s=file_decode_ref(i.toString());if(!s)continue;if(!file_ref_matches(s,e,t))continue;var o=file_load_dirent(s);r.push(o)}return r}function format_date(e){if(!e)return"???";var t=e.getMonth()+1+"/"+e.getDate(),n=e.getHours()+":"+(e.getMinutes()<10?"0":"")+e.getMinutes();return t+" "+n}var dialog_el_id="dialog",is_open=!1,dialog_callback=null,will_save,confirming,editing,editing_dirent,cur_usage,cur_usage_name,cur_gameid,cur_filelist;if(window.JSON){function encode_array(e){var t=JSON.stringify(e),n=t.length;return t[0]=='"'&&t[n-1]=='"'&&(t=t.slice(1,n-1)),t}function decode_array(e){return JSON.parse(e)}}else{function encode_array(e){return"["+e+"]"}function decode_array(val){return eval(val)}}var localStorage=null;try{window.localStorage!=null?localStorage=window.localStorage:window.globalStorage!=null&&(localStorage=window.globalStorage[location.hostname])}catch(ex){}return localStorage==null&&(localStorage={data:{},keys:[],length:0,getItem:function(e){return localStorage.data[e]},setItem:function(e,t){localStorage.keys.indexOf(e)<0&&(localStorage.keys.push(e),localStorage.length=localStorage.keys.length),localStorage.data[e]=t},removeItem:function(e){localStorage.keys.indexOf(e)>=0&&(localStorage.keys=localStorage.keys.without(e),localStorage.length=localStorage.keys.length,delete localStorage.data[e])},key:function(e){return localStorage.keys[e]},clear:function(){localStorage.data={},localStorage.keys=[],localStorage.length=0}}),Event.observe(window,"storage",evhan_storage_changed),{open:dialog_open,file_construct_ref:file_construct_ref,file_ref_exists:file_ref_exists,file_remove_ref:file_remove_ref,file_write:file_write,file_read:file_read}}(),Glk=function(){function a(t){e=t.vm,window.GiDispa&&GiDispa.set_vm(e),t.accept=f,GlkOte.init(t)}function f(t){var r;if(n){_("### ui is disabled, ignoring event");return}if(t.gen!=s){GlkOte.log("Input event had wrong generation number: got "+t.gen+", currently at "+s);return}s+=1,o=t.partial;switch(t.type){case"init":W=t.metrics,e.init();break;case"external":t.value=="timer"&&c();break;case"hyperlink":h(t.window,t.value);break;case"char":p(t.window,t.value);break;case"line":d(t.window,t.value,t.terminator);break;case"arrange":W=t.metrics,r={left:W.outspacingx,top:W.outspacingy,right:W.width-W.outspacingx,bottom:W.height-W.outspacingy},U&&ut(U,r),l();break;case"specialresponse":t.response=="fileref_prompt"&&an(t)}}function l(){if(!K)return;K.set_field(0,g.evtype_Arrange),K.set_field(1,null),K.set_field(2,0),K.set_field(3,0),window.GiDispa&&GiDispa.prepare_resume(K),K=null,e.resume()}function c(){if(!K)return;K.set_field(0,g.evtype_Timer),K.set_field(1,null),K.set_field(2,0),K.set_field(3,0),window.GiDispa&&GiDispa.prepare_resume(K),K=null,e.resume()}function h(t,n){if(!K)return;var r=null;for(r=R;r;r=r.next)if(r.disprock==t)break;if(!r||!r.hyperlink_request)return;K.set_field(0,g.evtype_Hyperlink),K.set_field(1,r),K.set_field(2,n),K.set_field(3,0),r.hyperlink_request=!1,window.GiDispa&&GiDispa.prepare_resume(K),K=null,e.resume()}function p(t,n){var r;if(!K)return;var i=null;for(i=R;i;i=i.next)if(i.disprock==t)break;if(!i||!i.char_request)return;n.length==1?(r=n.charCodeAt(0),i.char_request_uni||(r&=255)):(r=y[n],r||(r=g.keycode_Unknown)),K.set_field(0,g.evtype_CharInput),K.set_field(1,i),K.set_field(2,r),K.set_field(3,0),i.char_request=!1,i.char_request_uni=!1,i.input_generation=null,window.GiDispa&&GiDispa.prepare_resume(K),K=null,e.resume()}function d(t,n,r){var i;if(!K)return;var s=null;for(s=R;s;s=s.next)if(s.disprock==t)break;if(!s||!s.line_request)return;n.length>s.linebuf.length&&(n=n.slice(0,s.linebuf.length)),s.request_echo_line_input&&(i=s.style,xt(s.str,g.style_Input),rt(s,n),s.echostr&&St(s.echostr,n),xt(s.str,i),rt(s,"\n"),s.echostr&&St(s.echostr,"\n"));for(i=0;i<n.length;i++)s.linebuf[i]=n.charCodeAt(i);var o=0;r&&y[r]&&(o=y[r]),K.set_field(0,g.evtype_LineInput),K.set_field(1,s),K.set_field(2,n.length),K.set_field(3,o),window.GiDispa&&GiDispa.unretain_array(s.linebuf),s.line_request=!1,s.line_request_uni=!1,s.request_echo_line_input=null,s.input_generation=null,s.linebuf=null,window.GiDispa&&GiDispa.prepare_resume(K),K=null,e.resume()}function v(){var e={type:"update",gen:s},t=null,i=null,o=null,a,f,l,c,h,p,d,v,m,y,b,E,S;if(z){z=!1,t=[];for(a=R;a;a=a.next){if(a.type==g.wintype_Pair)continue;f={id:a.disprock,rock:a.rock},t.push(f);switch(a.type){case g.wintype_TextBuffer:f.type="buffer";break;case g.wintype_TextGrid:f.type="grid",f.gridwidth=a.gridwidth,f.gridheight=a.gridheight}f.left=a.bbox.left,f.top=a.bbox.top,f.width=a.bbox.right-a.bbox.left,f.height=a.bbox.bottom-a.bbox.top}}for(a=R;a;a=a.next){c=!1,f={id:a.disprock},i==null&&(i=[]);switch(a.type){case g.wintype_TextBuffer:st(a),a.content.length&&(f.text=a.content.slice(0),a.content.length=0,c=!0),a.clearcontent&&(f.clear=!0,a.clearcontent=!1,c=!0,f.text||(f.text=[]));break;case g.wintype_TextGrid:if(a.gridwidth==0||a.gridheight==0)break;f.lines=[];for(v=0;v<a.gridheight;v++){h=a.lines[v];if(!h.dirty)continue;h.dirty=!1,p=[],b=0;for(m=0;m<a.gridwidth;){E=h.styles[m],S=h.hyperlinks[m];for(;m<a.gridwidth&&h.styles[m]==E&&h.hyperlinks[m]==S;m++);b<m&&(S?(l={style:w[E],text:h.chars.slice(b,m).join(""),hyperlink:S},p.push(l)):(p.push(w[E]),p.push(h.chars.slice(b,m).join(""))),b=m)}f.lines.push({line:v,content:p})}c=f.lines.length}c&&i.push(f)}o=[];for(a=R;a;a=a.next)f=null,a.char_request&&(f={id:a.disprock,type:"char",gen:a.input_generation},a.type==g.wintype_TextGrid&&(it(a)?(f.xpos=a.gridwidth,f.ypos=a.gridheight-1):(f.xpos=a.cursorx,f.ypos=a.cursory))),a.line_request&&(y="",u&&(d=u[a.disprock],d&&(y=d)),f={id:a.disprock,type:"line",gen:a.input_generation,maxlen:a.linebuf.length,initial:y},a.line_input_terminators.length&&(f.terminators=a.line_input_terminators),a.type==g.wintype_TextGrid&&(it(a)?(f.xpos=a.gridwidth,f.ypos=a.gridheight-1):(f.xpos=a.cursorx,f.ypos=a.cursory))),a.hyperlink_request&&(f||(f={id:a.disprock}),f.hyperlink=!0),f&&o.push(f);e.windows=t,e.content=i,e.input=o,r&&(e.specialinput=r),n&&(e.disable=!0),u=null,GlkOte.update(e)}function m(e){t=!0,n=!0,GlkOte.error(e);var r={type:"update",gen:s,disable:!0};r.input=[],GlkOte.update(r)}function L(e){return e<65536?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(e&1023)))}function A(e){var t,n,r=e.length;for(t=0;t<r;t++)if(e[t]<0||e[t]>=256)break;if(t==r)return e;n=Array(r);for(t=0;t<r;t++)n[t]=e[t]&255;return n}function O(e){var t,n,r=e.length;if(r==0)return"";for(t=0;t<r;t++)if(e[t]<0||e[t]>=256)break;if(t==r)return String.fromCharCode.apply(this,e);n=Array(r);for(t=0;t<r;t++)n[t]=String.fromCharCode(e[t]&255);return n.join("")}function M(e){var t,n,r,i=e.length;if(i==0)return"";for(t=0;t<i;t++)if(e[t]>=65536)break;if(t==i)return String.fromCharCode.apply(this,e);r=Array(i);for(t=0;t<i;t++)n=e[t],n<65536?r[t]=String.fromCharCode(n):(n-=65536,r[t]=String.fromCharCode(55296+(n>>10),56320+(n&1023)));return r.join("")}function _(e){window.console&&console.log?console.log(e):window.opera&&opera.postError&&opera.postError(e)}function D(){this.value=undefined,this.set_value=function(e){this.value=e},this.get_value=function(){return this.value}}function P(e){this.fields=[],this.push_field=function(e){this.fields.push(e)},this.set_field=function(e,t){this.fields[e]=t},this.get_field=function(e){return this.fields[e]},this.get_fields=function(){return this.fields}}function B(e){return e==1||e==192||e==98?!0:!1}function et(e,t){var n={};return n.type=e,n.rock=t,n.disprock=undefined,n.parent=null,n.str=lt(n),n.echostr=null,n.style=g.style_Normal,n.hyperlink=0,n.input_generation=null,n.linebuf=null,n.char_request=!1,n.line_request=!1,n.char_request_uni=!1,n.line_request_uni=!1,n.hyperlink_request=!1,n.echo_line_input=!0,n.line_input_terminators=[],n.request_echo_line_input=null,n.prev=null,n.next=R,R=n,n.next&&(n.next.prev=n),window.GiDispa?GiDispa.class_register("window",n):n.disprock=Q++,z=!0,n}function tt(e){var t,n;window.GiDispa&&GiDispa.class_unregister("window",e),z=!0,e.echostr=null,e.str&&(ft(e.str),e.str=null),t=e.prev,n=e.next,e.prev=null,e.next=null,t?t.next=n:R=n,n&&(n.prev=t),e.parent=null,e.rock=null,e.disprock=null}function nt(e){var t;for(t=R;t;t=t.next)t.echostr===e&&(t.echostr=null)}function rt(e,t){var n,r;switch(e.type){case g.wintype_TextBuffer:(e.style!=e.accumstyle||e.hyperlink!=e.accumhyperlink)&&st(e),e.accum.push(t);break;case g.wintype_TextGrid:for(n=0;n<t.length;n++){r=t.charAt(n),e.cursorx<0?e.cursorx=0:e.cursorx>=e.gridwidth&&(e.cursorx=0,e.cursory++);if(e.cursory<0)e.cursory=0;else if(e.cursory>=e.gridheight)break;if(r=="\n"){e.cursory++,e.cursorx=0;continue}lineobj=e.lines[e.cursory],lineobj.dirty=!0,lineobj.chars[e.cursorx]=r,lineobj.styles[e.cursorx]=e.style,lineobj.hyperlinks[e.cursorx]=e.hyperlink,e.cursorx++}}}function it(e){e.cursorx<0?e.cursorx=0:e.cursorx>=e.gridwidth&&(e.cursorx=0,e.cursory++);if(e.cursory<0)e.cursory=0;else if(e.cursory>=e.gridheight)return!0;return!1}function st(e){var t=e.content,n=w[e.accumstyle],r,i,s,o,u;if(e.accum.length){r=e.accum.join(""),i=r.split("\n");for(s=0;s<i.length;s++)u=undefined,s==0?i[s]&&(t.length==0?(u=[],t.push({content:u,append:!0})):(o=t[t.length-1],o.content?u=o.content:(u=[],o.content=u))):i[s]?(u=[],t.push({content:u})):t.push({}),u!==undefined&&(e.accumhyperlink?u.push({style:n,text:i[s],hyperlink:e.accumhyperlink}):(u.push(n),u.push(i[s])))}e.accum.length=0,e.accumstyle=e.style,e.accumhyperlink=e.hyperlink}function ot(e,t){var n;for(n=e.parent;n;n=n.parent)n.type==g.wintype_Pair&&n.pair_key===e&&(n.pair_key=null,n.pair_keydamage=!0);window.GiDispa&&e.linebuf&&(GiDispa.unretain_array(e.linebuf),e.linebuf=null);switch(e.type){case g.wintype_Pair:t&&(e.child1&&ot(e.child1,!0),e.child2&&ot(e.child2,!0)),e.child1=null,e.child2=null,e.pair_key=null;break;case g.wintype_TextBuffer:e.accum=null,e.content=null;break;case g.wintype_TextGrid:e.lines=null}tt(e)}function ut(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m;z=!0,e.bbox=t;switch(e.type){case g.wintype_TextGrid:n=t.right-t.left,r=t.bottom-t.top,s=e.gridheight,e.gridwidth=Math.max(0,Math.floor((n-W.gridmarginx)/W.gridcharwidth)),e.gridheight=Math.max(0,Math.floor((r-W.gridmarginy)/W.gridcharheight));if(s>e.gridheight)e.lines.length=e.gridheight;else if(s<e.gridheight)for(l=s;l<e.gridheight;l++)e.lines[l]={chars:[],styles:[],hyperlinks:[],dirty:!0};for(l=0;l<e.gridheight;l++){h=e.lines[l],i=h.chars.length;if(i>e.gridwidth)h.dirty=!0,h.chars.length=e.gridwidth,h.styles.length=e.gridwidth,h.hyperlinks.length=e.gridwidth;else if(i<e.gridwidth){h.dirty=!0;for(c=i;c<e.gridwidth;c++)h.chars[c]=" ",h.styles[c]=g.style_Normal,h.hyperlinks[c]=0}}break;case g.wintype_Pair:e.pair_vertical?(o=e.bbox.left,u=e.bbox.right,f=W.inspacingx):(o=e.bbox.top,u=e.bbox.bottom,f=W.inspacingy),e.pair_hasborder||(f=0),a=u-o,e.pair_division==g.winmethod_Proportional?split=Math.floor(a*e.pair_size/100):e.pair_division==g.winmethod_Fixed?(split=0,e.pair_key&&e.pair_key.type==g.wintype_TextBuffer&&(e.pair_vertical?split=e.pair_size*W.buffercharwidth+W.buffermarginx:split=e.pair_size*W.buffercharheight+W.buffermarginy),e.pair_key&&e.pair_key.type==g.wintype_TextGrid&&(e.pair_vertical?split=e.pair_size*W.gridcharwidth+W.gridmarginx:split=e.pair_size*W.gridcharheight+W.gridmarginy),split=Math.ceil(split)):split=Math.floor(a/2),e.pair_backward?split=o+split:split=u-split-f,o>=u?split=o:split=Math.min(Math.max(split,o),u-f),e.pair_splitpos=split,e.pair_splitwidth=f,e.pair_vertical?(p={left:e.bbox.left,right:e.pair_splitpos,top:e.bbox.top,bottom:e.bbox.bottom},d={left:p.right+e.pair_splitwidth,right:e.bbox.right,top:e.bbox.top,bottom:e.bbox.bottom}):(p={top:e.bbox.top,bottom:e.pair_splitpos,left:e.bbox.left,right:e.bbox.right},d={top:p.bottom+e.pair_splitwidth,bottom:e.bbox.bottom,left:e.bbox.left,right:e.bbox.right}),e.pair_backward?(v=e.child2,m=e.child1):(v=e.child1,m=e.child2),ut(v,p),ut(m,d)}}function at(e,t,n,r){var i={};return i.type=e,i.rock=r,i.disprock=undefined,i.unicode=!1,i.ref=null,i.win=null,i.file=null,i.buf=null,i.bufpos=0,i.buflen=0,i.bufeof=0,i.timer_id=null,i.flush_func=null,i.readcount=0,i.writecount=0,i.readable=t,i.writable=n,i.prev=null,i.next=X,X=i,i.next&&(i.next.prev=i),window.GiDispa&&GiDispa.class_register("stream",i),i}function ft(e){var t,n;e===J&&(J=null),nt(e),e.type==I&&window.GiDispa&&GiDispa.unretain_array(e.buf),window.GiDispa&&GiDispa.class_unregister("stream",e),t=e.prev,n=e.next,e.prev=null,e.next=null,t?t.next=n:X=n,n&&(n.prev=t),e.buf=null,e.readable=!1,e.writable=!1,e.ref=null,e.win=null,e.file=null,e.rock=null,e.disprock=null}function lt(e){var t;return t=at(F,!1,!0,0),t.unicode=!0,t.win=e,t}function ct(e){e.timer_id===null&&(e.flush_func===null&&(e.flush_func=function(){ht(e)}),e.timer_id=setTimeout(e.flush_func,1e4))}function ht(e){e.timer_id=null,Dialog.file_write(e.ref,e.buf)}function pt(t,n,r,i){var s={};s.filename=t,s.rock=r,s.disprock=undefined,s.textmode=(n&g.fileusage_TextMode)!=0,s.filetype=n&g.fileusage_TypeMask,s.filetypename=E[s.filetype],s.filetypename||(s.filetypename="xxx");if(!i){var o="";s.filetype==g.fileusage_SavedGame&&(o=e.get_signature()),i=Dialog.file_construct_ref(s.filename,s.filetypename,o)}return s.ref=i,s.prev=null,s.next=V,V=s,s.next&&(s.next.prev=s),window.GiDispa&&GiDispa.class_register("fileref",s),s}function dt(e){var t,n;window.GiDispa&&GiDispa.class_unregister("fileref",e),t=e.prev,n=e.next,e.prev=null,e.next=null,t?t.next=n:V=n,n&&(n.prev=t),e.filename=null,e.ref=null,e.rock=null,e.disprock=null}function vt(e,t){if(!e||!e.writable)throw"gli_put_char: invalid stream";e.unicode||(t&=255),e.writecount+=1;switch(e.type){case j:ct(e);case I:e.bufpos<e.buflen&&(e.buf[e.bufpos]=t,e.bufpos+=1,e.bufpos>e.bufeof&&(e.bufeof=e.bufpos));break;case F:if(e.win.line_request)throw"gli_put_char: window has pending line request";rt(e.win,L(t)),e.win.echostr&&vt(e.win.echostr,t)}}function mt(e,t,n){var r,i,s;if(!e||!e.writable)throw"gli_put_array: invalid stream";!e.unicode&&!n&&(t=A(t),n=!0),e.writecount+=t.length;switch(e.type){case j:ct(e);case I:i=t.length,i>e.buflen-e.bufpos&&(i=e.buflen-e.bufpos);for(r=0;r<i;r++)e.buf[e.bufpos+r]=t[r];e.bufpos+=i,e.bufpos>e.bufeof&&(e.bufeof=e.bufpos);break;case F:if(e.win.line_request)throw"gli_put_array: window has pending line request";n?s=String.fromCharCode.apply(this,t):s=M(t),rt(e.win,s),e.win.echostr&&mt(e.win.echostr,t,n)}}function gt(e,t){var n;if(!e||!e.readable)return-1;switch(e.type){case q:if(e.unicode){if(e.isbinary){if(e.bufpos>=e.bufeof)return-1;n=e.buf[e.bufpos],e.bufpos++;if(e.bufpos>=e.bufeof)return-1;n=n<<8|e.buf[e.bufpos]&255,e.bufpos++;if(e.bufpos>=e.bufeof)return-1;n=n<<8|e.buf[e.bufpos]&255,e.bufpos++;if(e.bufpos>=e.bufeof)return-1;n=n<<8|e.buf[e.bufpos]&255,e.bufpos++}else{var r,i,s,o;if(e.bufpos>=e.bufeof)return-1;r=e.buf[e.bufpos],e.bufpos++;if(r<128)n=r;else{if(e.bufpos>=e.bufeof)return-1;i=e.buf[e.bufpos],e.bufpos++;if((i&192)!=128)return-1;if((r&224)==192)n=(r&31)<<6,n|=i&63;else{if(e.bufpos>=e.bufeof)return-1;s=e.buf[e.bufpos],e.bufpos++;if((s&192)!=128)return-1;if((r&240)==224)n=(r&15)<<12&61440,n|=(i&63)<<6&4032,n|=s&63&63;else{if((r&240)!=240)return-1;if(e.bufpos>=e.bufeof)return-1;o=e.buf[e.bufpos],e.bufpos++;if((o&192)!=128)return-1;n=(r&7)<<18&1835008,n|=(i&63)<<12&258048,n|=(s&63)<<6&4032,n|=o&63&63}}}}return e.readcount++,n>>>=0,!t&&n>=256?63:n};case j:case I:return e.bufpos<e.bufeof?(n=e.buf[e.bufpos],e.bufpos++,e.readcount++,!t&&n>=256?63:n):-1;default:return-1}}function yt(e,t,n){if(!e||!e.readable)return 0;var r=t.length,i;switch(e.type){case q:if(e.unicode){if(r==0)return 0;r-=1,i=!1;for(lx=0;lx<r&&!i;lx++){ch=gt(e,n);if(ch==-1)break;t[lx]=ch,i=ch==10}return lx};case j:case I:if(r==0)return 0;r-=1,e.bufpos>=e.bufeof?r=0:e.bufpos+r>e.bufeof&&(r=e.bufeof-e.bufpos),i=!1;if(!n)for(lx=0;lx<r&&!i;lx++)ch=e.buf[e.bufpos++],!n&&ch>=256&&(ch=63),t[lx]=ch,i=ch==10;else for(lx=0;lx<r&&!i;lx++)ch=e.buf[e.bufpos++],t[lx]=ch,i=ch==10;return e.readcount+=lx,lx;default:return 0}}function bt(e,t,n){if(!e||!e.readable)return 0;var r=t.length,i,s;switch(e.type){case q:if(e.unicode){for(i=0;i<r;i++){s=gt(e,n);if(s==-1)break;t[i]=s}return i};case j:case I:e.bufpos>=e.bufeof?r=0:e.bufpos+r>e.bufeof&&(r=e.bufeof-e.bufpos);if(!n)for(i=0;i<r;i++)s=e.buf[e.bufpos++],!n&&s>=256&&(s=63),t[i]=s;else for(i=0;i<r;i++)t[i]=e.buf[e.bufpos++];return e.readcount+=r,r;default:return 0}}function wt(e,t){if(!t)return;t.set_field(0,e.readcount),t.set_field(1,e.writecount)}function Et(e,t){St(J,e,t)}function St(e,t,n){var r,i;if(!e||!e.writable)throw"glk_put_jstring: invalid stream";e.writecount+=t.length;switch(e.type){case j:ct(e);case I:i=t.length,i>e.buflen-e.bufpos&&(i=e.buflen-e.bufpos);if(e.unicode||n)for(r=0;r<i;r++)e.buf[e.bufpos+r]=t.charCodeAt(r);else for(r=0;r<i;r++)e.buf[e.bufpos+r]=t.charCodeAt(r)&255;e.bufpos+=i,e.bufpos>e.bufeof&&(e.bufeof=e.bufpos);break;case F:if(e.win.line_request)throw"glk_put_jstring: window has pending line request";rt(e.win,t),e.win.echostr&&St(e.win.echostr,t,n)}}function xt(e,t){if(!e||!e.writable)throw"gli_set_style: invalid stream";t>=g.style_NUMSTYLES&&(t=0),e.type==F&&(e.win.style=t,e.win.echostr&&xt(e.win.echostr,t))}function Tt(e,t){if(!e||!e.writable)throw"gli_set_hyperlink: invalid stream";e.type==F&&(e.win.hyperlink=t,e.win.echostr&&Tt(e.win.echostr,t))}function Nt(){if(n){if(t){GlkOte.log("### dropping timer event..."),Y=null;return}GlkOte.log("### procrastinating timer event..."),Y=setTimeout(Nt,500);return}Y=setTimeout(Nt,G),Z=Date.now(),GlkOte.extevent("timer")}function Ct(){return t=!0,n=!0,K=null,H}function kt(){}function Lt(e,t){return At(e,t,null)}function At(e,t,n){switch(e){case 0:return 1796;case 1:if(t<=g.keycode_Left&&t>=g.keycode_End)return 1;if(t>=4294967296-g.keycode_MAXVAL)return 0;if(t>1114111)return 0;if(t>=0&&t<32||t>=127&&t<160)return 0;return 1;case 2:if(t>1114111)return 0;if(t>=0&&t<32||t>=127&&t<160)return 0;return 1;case 3:if(t>1114111||t>=0&&t<32||t>=127&&t<160)return n&&(n[0]=1),0;return n&&(n[0]=1),2;case 4:return 0;case 5:return 1;case 6:return 0;case 7:return 0;case 8:return 0;case 9:return 0;case 10:return 0;case 11:return 1;case 12:return t==3||t==4?1:0;case 13:return 0;case 14:return 0;case 15:return 1;case 16:return 1;case 17:return 1;case 18:return 1;case 19:if(t==g.keycode_Escape)return 1;if(t>=g.keycode_Func12&&t<=g.keycode_Func1)return 1;return 0;case 20:return 1;case 21:return 0;case 22:return 1}return 0}function Ot(e,t){return e?e=e.next:e=R,e?(t&&t.set_value(e.rock),e):(t&&t.set_value(0),null)}function Mt(e){if(!e)throw"glk_window_get_rock: invalid window";return e.rock}function _t(){return U}function Dt(e,t,n,r,i){var s,o,u,a,f;if(!U){if(e)throw"glk_window_open: splitwin must be null for first window";s=null,o={left:W.outspacingx,top:W.outspacingy,right:W.width-W.outspacingx,bottom:W.height-W.outspacingy}}else{if(!e)throw"glk_window_open: splitwin must not be null";u=t&g.winmethod_DivisionMask;if(u!=g.winmethod_Fixed&&u!=g.winmethod_Proportional)throw"glk_window_open: invalid method (not fixed or proportional)";u=t&g.winmethod_DirMask;if(u!=g.winmethod_Above&&u!=g.winmethod_Below&&u!=g.winmethod_Left&&u!=g.winmethod_Right)throw"glk_window_open: invalid method (bad direction)";o=e.bbox,s=e.parent;if(s&&s.type!=g.wintype_Pair)throw"glk_window_open: parent window is not Pair"}f=et(r,i);switch(f.type){case g.wintype_TextBuffer:f.accum=[],f.accumstyle=null,f.accumhyperlink=0,f.content=[],f.clearcontent=!1;break;case g.wintype_TextGrid:f.gridwidth=0,f.gridheight=0,f.lines=[],f.cursorx=0,f.cursory=0;break;case g.wintype_Blank:break;case g.wintype_Pair:throw"glk_window_open: cannot open pair window directly";default:return tt(f),null}return e?(a=et(g.wintype_Pair,0),a.pair_dir=t&g.winmethod_DirMask,a.pair_division=t&g.winmethod_DivisionMask,a.pair_key=f,a.pair_keydamage=!1,a.pair_size=n,a.pair_hasborder=(t&g.winmethod_BorderMask)==g.winmethod_Border,a.pair_vertical=a.pair_dir==g.winmethod_Left||a.pair_dir==g.winmethod_Right,a.pair_backward=a.pair_dir==g.winmethod_Left||a.pair_dir==g.winmethod_Above,a.child1=e,a.child2=f,e.parent=a,f.parent=a,a.parent=s,s?s.child1==e?s.child1=a:s.child2=a:U=a,ut(a,o)):(U=f,ut(f,o)),f}function Pt(e,t){if(!e)throw"glk_window_close: invalid window";if(e===U||!e.parent)U=null,wt(e.str,t),ot(e,!0);else{var n,r,i,s,o,u;n=e.parent;if(e===n.child1)i=n.child2;else{if(e!==n.child2)throw"glk_window_close: window tree is corrupted";i=n.child1}s=n.bbox,r=n.parent,r?(r.child1===n?r.child1=i:r.child2=i,i.parent=r):(U=i,i.parent=null),wt(e.str,t),ot(e,!0),e===n.child1?n.child1=null:e===n.child2&&(n.child2=null),ot(n,!1),u=!1;for(o=i;o;o=o.parent)o.type==g.wintype_Pair&&o.pair_keydamage&&(u=!0,o.pair_keydamage=!1);u?(s=content_box,ut(U,s)):ut(i,s)}}function Ht(e,t,n){if(!e)throw"glk_window_get_size: invalid window";var r=0,i=0,s,o;switch(e.type){case g.wintype_TextGrid:s=e.bbox.right-e.bbox.left,o=e.bbox.bottom-e.bbox.top,r=Math.max(0,Math.floor((s-W.gridmarginx)/W.gridcharwidth)),i=Math.max(0,Math.floor((o-W.gridmarginy)/W.gridcharheight));break;case g.wintype_TextBuffer:s=e.bbox.right-e.bbox.left,o=e.bbox.bottom-e.bbox.top,r=Math.max(0,Math.floor((s-W.buffermarginx)/W.buffercharwidth)),i=Math.max(0,Math.floor((o-W.buffermarginy)/W.buffercharheight))}t&&t.set_value(r),n&&n.set_value(i)}function Bt(e,t,n,r){var i,s,o,u;if(!e)throw"glk_window_set_arrangement: invalid window";if(e.type!=g.wintype_Pair)throw"glk_window_set_arrangement: not a pair window";if(r){if(r.type==g.wintype_Pair)throw"glk_window_set_arrangement: keywin cannot be a pair window";for(i=r;i;i=i.parent)if(i==e)break;if(!i)throw"glk_window_set_arrangement: keywin must be a descendant"}s=t&g.winmethod_DirMask,o=s==g.winmethod_Left||s==g.winmethod_Right,u=s==g.winmethod_Left||s==g.winmethod_Above,r||(r=e.pair_key);if(o&&!e.pair_vertical)throw"glk_window_set_arrangement: split must stay horizontal";if(!o&&e.pair_vertical)throw"glk_window_set_arrangement: split must stay vertical";if(r&&r.type==g.wintype_Blank&&(t&g.winmethod_DivisionMask)==g.winmethod_Fixed)throw"glk_window_set_arrangement: a blank window cannot have a fixed size";if(u&&!e.pair_backward||!u&&e.pair_backward)i=e.child1,e.child1=e.child2,e.child2=i;e.pair_dir=s,e.pair_division=t&g.winmethod_DivisionMask,e.pair_key=r,e.pair_size=n,e.pair_hasborder=(t&g.winmethod_BorderMask)==g.winmethod_Border,e.pair_vertical=e.pair_dir==g.winmethod_Left||e.pair_dir==g.winmethod_Right,e.pair_backward=e.pair_dir==g.winmethod_Left||e.pair_dir==g.winmethod_Above,ut(e,e.bbox)}function jt(e,t,n,r){if(!e)throw"glk_window_get_arrangement: invalid window";if(e.type!=g.wintype_Pair)throw"glk_window_get_arrangement: not a pair window";n&&n.set_value(e.pair_size),r&&r.set_value(e.pair_key),t&&t.set_value(e.pair_dir|e.pair_division|(e.pair_hasborder?g.winmethod_Border:g.winmethod_NoBorder))}function Ft(e){if(!e)throw"glk_window_get_type: invalid window";return e.type}function It(e){if(!e)throw"glk_window_get_parent: invalid window";return e.parent}function qt(e){var t,n,r;if(!e)throw"glk_window_clear: invalid window";if(e.line_request)throw"glk_window_clear: window has pending line request";switch(e.type){case g.wintype_TextBuffer:e.accum.length=0,e.accumstyle=null,e.accumhyperlink=0,e.content.length=0,e.clearcontent=!0;break;case g.wintype_TextGrid:e.cursorx=0,e.cursory=0;for(t=0;t<e.gridheight;t++){r=e.lines[t],r.dirty=!0;for(n=0;n<e.gridwidth;n++)r.chars[n]=" ",r.styles[n]=g.style_Normal,r.hyperlinks[n]=0}}}function Rt(e,t,n){if(!e)throw"glk_window_move_cursor: invalid window";if(e.type!=g.wintype_TextGrid)throw"glk_window_move_cursor: not a grid window";e.cursorx=t,e.cursory=n}function Ut(e){if(!e)throw"glk_window_get_stream: invalid window";return e.str}function zt(e,t){if(!e)throw"glk_window_set_echo_stream: invalid window";e.echostr=t}function Wt(e){if(!e)throw"glk_window_get_echo_stream: invalid window";return e.echostr}function Xt(e){e?J=e.str:J=null}function Vt(e){var t,n;if(!e)throw"glk_window_get_sibling: invalid window";t=e.parent;if(!t)return null;if(e===t.child1)return t.child2;if(e===t.child2)return t.child1;throw"glk_window_get_sibling: window tree is corrupted"}function $t(e,t){return e?e=e.next:e=X,e?(t&&t.set_value(e.rock),e):(t&&t.set_value(0),null)}function Jt(e){if(!e)throw"glk_stream_get_rock: invalid stream";return e.rock}function Kt(e,t,n){if(!e)throw"glk_stream_open_file: invalid fileref";var r;if(t!=g.filemode_Read&&t!=g.filemode_Write&&t!=g.filemode_ReadWrite&&t!=g.filemode_WriteAppend)throw"glk_stream_open_file: illegal filemode";if(t==g.filemode_Read&&!Dialog.file_ref_exists(e.ref))throw"glk_stream_open_file: file not found for reading: "+e.ref.filename;var i=null;t!=g.filemode_Write&&(i=Dialog.file_read(e.ref)),i==null&&(i=[],t!=g.filemode_Read&&Dialog.file_write(e.ref,"",!0));if(i.length==null)throw"glk_stream_open_file: data read had no length";return r=at(j,t!=g.filemode_Write,t!=g.filemode_Read,n),r.unicode=!1,r.ref=e.ref,r.buf=i,r.buflen=4294967295,t==g.filemode_Write?r.bufeof=0:r.bufeof=i.length,t==g.filemode_WriteAppend?r.bufpos=r.bufeof:r.bufpos=0,r}function Qt(e,t,n){var r;if(t!=g.filemode_Read&&t!=g.filemode_Write&&t!=g.filemode_ReadWrite)throw"glk_stream_open_memory: illegal filemode";return r=at(I,t!=g.filemode_Write,t!=g.filemode_Read,n),r.unicode=!1,e&&(r.buf=e,r.buflen=e.length,r.bufpos=0,t==g.filemode_Write?r.bufeof=0:r.bufeof=r.buflen,window.GiDispa&&GiDispa.retain_array(e)),r}function Gt(e,t){var n,r=GiLoad.find_data_chunk(e);if(!r)return null;var i=r.data,s=r.type=="BINA";return n=at(q,!0,!1,t),n.unicode=!1,n.isbinary=s,i&&(n.buf=i,n.buflen=i.length,n.bufpos=0,n.bufeof=n.buflen),n}function Yt(e,t){var n,r=GiLoad.find_data_chunk(e);if(!r)return null;var i=r.data,s=r.type=="BINA";return n=at(q,!0,!1,t),n.unicode=!0,n.isbinary=s,i&&(n.buf=i,n.buflen=i.length,n.bufpos=0,n.bufeof=n.buflen),n}function Zt(e,t){if(!e)throw"glk_stream_close: invalid stream";if(e.type==F)throw"glk_stream_close: cannot close window stream";e.type==j&&e.writable&&(e.timer_id!==null&&(clearTimeout(e.timer_id),e.timer_id=null),Dialog.file_write(e.ref,e.buf)),wt(e,t),ft(e)}function en(e,t,n){if(!e)throw"glk_stream_set_position: invalid stream";switch(e.type){case j:case q:case I:n==g.seekmode_Current?t=e.bufpos+t:n==g.seekmode_End&&(t=e.bufeof+t),t<0&&(t=0),t>e.bufeof&&(t=e.bufeof),e.bufpos=t}}function tn(e){if(!e)throw"glk_stream_get_position: invalid stream";switch(e.type){case j:case q:case I:return e.bufpos;default:return 0}}function nn(e){J=e}function rn(){return J}function sn(e,t){var n=(new Date).getTime(),r="_temp_"+n+"_"+Math.random();return r=r.replace(".",""),fref=pt(r,e,t,null),fref}function on(e,t,n){return fref=pt(t,e,n,null),fref}function un(t,n,s){var o,u=t&g.fileusage_TypeMask,a=E[u];a||(a="xxx");switch(n){case g.filemode_Write:o="write";break;case g.filemode_ReadWrite:o="readwrite";break;case g.filemode_WriteAppend:o="writeappend";break;case g.filemode_Read:default:o="read"}var f={type:"fileref_prompt",filetype:a,filemode:o},l={usage:t,rock:s};return u==g.fileusage_SavedGame&&(f.gameid=e.get_signature()),r=f,i=l,K=null,H}function an(t){var n=t.value,s=i.usage,o=i.rock,u=null;n&&(u=pt(n.filename,s,o,n)),r=null,i=null,window.GiDispa&&GiDispa.prepare_resume(u),e.resume()}function fn(e){if(!e)throw"glk_fileref_destroy: invalid fileref";dt(e)}function ln(e,t){return e?e=e.next:e=V,e?(t&&t.set_value(e.rock),e):(t&&t.set_value(0),null)}function cn(e){if(!e)throw"glk_fileref_get_rock: invalid fileref";return e.rock}function hn(e){if(!e)throw"glk_fileref_delete_file: invalid fileref";Dialog.file_remove_ref(e.ref)}function pn(e){if(!e)throw"glk_fileref_does_file_exist: invalid fileref";return Dialog.file_ref_exists(e.ref)?1:0}function dn(e,t,n){if(!t)throw"glk_fileref_create_from_fileref: invalid fileref";var r=pt(t.filename,e,n,null);return r}function vn(e){vt(J,e&255)}function mn(e,t){vt(e,t&255)}function gn(e){St(J,e,!0)}function yn(e,t){St(e,t,!0)}function bn(e){e=A(e),mt(J,e,!0)}function wn(e,t){t=A(t),mt(e,t,!0)}function En(e){xt(J,e)}function Sn(e,t){xt(e,t)}function xn(e){if(!e)throw"glk_get_char_stream: invalid stream";return gt(e,!1)}function Tn(e,t){if(!e)throw"glk_get_line_stream: invalid stream";return yt(e,t,!1)}function Nn(e,t){if(!e)throw"glk_get_buffer_stream: invalid stream";return bt(e,t,!1)}function Cn(e){return e>=65&&e<=90?e+32:e>=192&&e<=222&&e!=215?e+32:e}function kn(e){return e>=97&&e<=122?e-32:e>=224&&e<=254&&e!=247?e-32:e}function Ln(e,t,n,r){}function An(e,t,n){}function On(e,t,n){return 0}function Mn(e,t,n,r){return r&&r.set_value(0),0}function _n(e){return K=e,H}function Dn(e){e.set_field(0,g.evtype_None),e.set_field(1,null),e.set_field(2,0),e.set_field(3,0);if(G&&Y!==null){var t=Date.now();t-Z>G&&(clearTimeout(Y),Y=setTimeout(Nt,G),Z=Date.now(),e.set_field(0,g.evtype_Timer))}}function Pn(e,t,n){if(!e)throw"glk_request_line_event: invalid window";if(e.char_request||e.line_request)throw"glk_request_line_event: window already has keyboard request";if(e.type!=g.wintype_TextBuffer&&e.type!=g.wintype_TextGrid)throw"glk_request_line_event: window does not support keyboard input";if(n){var r=t.slice(0,n);u||(u={}),u[e.disprock]=O(r)}e.line_request=!0,e.line_request_uni=!1,e.type==g.wintype_TextBuffer?e.request_echo_line_input=e.echo_line_input:e.request_echo_line_input=!0,e.input_generation=s,e.linebuf=t,window.GiDispa&&GiDispa.retain_array(t)}function Hn(e,t){if(!e)throw"glk_cancel_line_event: invalid window";if(!e.line_request){t&&(t.set_field(0,g.evtype_None),t.set_field(1,null),t.set_field(2,0),t.set_field(3,0));return}var n="",r,i;o&&(i=o[e.disprock],i&&(n=i)),n.length>e.linebuf.length&&(n=n.slice(0,e.linebuf.length)),e.request_echo_line_input&&(r=e.style,xt(e.str,g.style_Input),rt(e,n),e.echostr&&St(e.echostr,n),xt(e.str,r),rt(e,"\n"),e.echostr&&St(e.echostr,"\n"));for(r=0;r<n.length;r++)e.linebuf[r]=n.charCodeAt(r);t&&(t.set_field(0,g.evtype_LineInput),t.set_field(1,e),t.set_field(2,n.length),t.set_field(3,0)),window.GiDispa&&GiDispa.unretain_array(e.linebuf),e.line_request=!1,e.line_request_uni=!1,e.request_echo_line_input=null,e.input_generation=null,e.linebuf=null}function Bn(e){if(!e)throw"glk_request_char_event: invalid window";if(e.char_request||e.line_request)throw"glk_request_char_event: window already has keyboard request";if(e.type!=g.wintype_TextBuffer&&e.type!=g.wintype_TextGrid)throw"glk_request_char_event: window does not support keyboard input";e.char_request=!0,e.char_request_uni=!1,e.input_generation=s}function jn(e){if(!e)throw"glk_cancel_char_event: invalid window";e.char_request=!1,e.char_request_uni=!1}function Fn(e,t){if(!e)throw"glk_set_echo_line_event: invalid window";e.echo_line_input=t!=0}function In(e,t){if(!e)throw"glk_set_terminators_line_event: invalid window";if(b===null){b={};for(var n in y)b[y[n]]=n}var r=[];if(t)for(var i=0;i<t.length;i++){var n=b[t[i]];n&&r.push(n)}e.line_input_terminators=r}function qn(e){if(!e)throw"glk_request_mouse_event: invalid window"}function Rn(e){if(!e)throw"glk_cancel_mouse_event: invalid window"}function Un(e){Y!==null&&(clearTimeout(Y),Y=null,Z=null),e?(G=e,Y=setTimeout(Nt,G),Z=Date.now()):G=null}function zn(e,t,n){return t&&t.set_value(0),n&&n.set_value(0),0}function Wn(e,t,n,r){if(!e)throw"glk_image_draw: invalid window";return 0}function Xn(e,t,n,r,i,s){if(!e)throw"glk_image_draw_scaled: invalid window";return 0}function Vn(e){if(!e)throw"glk_window_flow_break: invalid window"}function $n(e,t,n,r,i){if(!e)throw"glk_window_erase_rect: invalid window"}function Jn(e,t,n,r,i,s){if(!e)throw"glk_window_fill_rect: invalid window"}function Kn(e,t){if(!e)throw"glk_window_set_background_color: invalid window"}function Qn(e,t){return e?e=e.next:e=$,e?(t&&t.set_value(e.rock),e):(t&&t.set_value(0),null)}function Gn(e){if(!e)throw"glk_schannel_get_rock: invalid schannel";return e.rock}function Yn(e){return null}function Zn(e){throw"glk_schannel_destroy: invalid schannel"}function er(e,t){throw"glk_schannel_play: invalid schannel"}function tr(e,t,n,r){throw"glk_schannel_play_ext: invalid schannel"}function nr(e){throw"glk_schannel_stop: invalid schannel"}function rr(e,t){throw"glk_schannel_set_volume: invalid schannel"}function ir(e,t){}function sr(e,t){return null}function or(e,t,n){throw"glk_schannel_play_multi: invalid schannel"}function ur(e){throw"glk_schannel_pause: invalid schannel"}function ar(e){throw"glk_schannel_unpause: invalid schannel"}function fr(e,t,n,r){throw"glk_schannel_set_volume_ext: invalid schannel"}function lr(e){Tt(J,e)}function cr(e,t){Tt(e,t)}function hr(e){if(!e)throw"glk_request_hyperlink_event: invalid window";if(e.type==g.wintype_TextBuffer||e.type==g.wintype_TextGrid)e.hyperlink_request=!0}function pr(e){if(!e)throw"glk_cancel_hyperlink_event: invalid window";if(e.type==g.wintype_TextBuffer||e.type==g.wintype_TextGrid)e.hyperlink_request=!1}function dr(e,t){var n,r,i,s,o,u=e.length,a=e.slice(0,t);if(u<t)throw"buffer_to_lower_case_uni: numchars exceeds array length";i=0;for(n=0;n<t;n++){o=a[n],s=x[o];if(s===undefined)e[i]=o,i++;else if(s instanceof Array)for(r=0;r<s.length;r++)e[i]=s[r],i++;else e[i]=s,i++}return e.length=u,i}function vr(e,t){var n,r,i,s,o,u=e.length,a=e.slice(0,t);if(u<t)throw"buffer_to_upper_case_uni: numchars exceeds array length";i=0;for(n=0;n<t;n++){o=a[n],s=S[o];if(s===undefined)e[i]=o,i++;else if(s instanceof Array)for(r=0;r<s.length;r++)e[i]=s[r],i++;else e[i]=s,i++}return e.length=u,i}function mr(e,t,n){var r,i,s,o,u,a=e.length,f=e.slice(0,t);if(a<t)throw"buffer_to_title_case_uni: numchars exceeds array length";s=0;if(t==0)return 0;r=0,u=f[r],o=T[u],o===undefined&&(o=S[u]);if(o===undefined)e[s]=u,s++;else if(o instanceof Array)for(i=0;i<o.length;i++)e[s]=o[i],s++;else e[s]=o,s++;if(!n)for(r=1;r<t;r++)u=f[r],e[s]=u,s++;else for(r=1;r<t;r++){u=f[r],o=x[u];if(o===undefined)e[s]=u,s++;else if(o instanceof Array)for(i=0;i<o.length;i++)e[s]=o[i],s++;else e[s]=o,s++}return e.length=a,s}function gr(e,t){var n=e.slice(0,t),r,i,s,o,u,a,f,l,c;r=0;for(i=0;i<t;i++){o=n[i],u=N[o];if(u===undefined)e[r]=o,r++;else if(u instanceof Array)for(s=0;s<u.length;s++)e[r]=u[s],r++;else e[r]=u,r++}i=0;while(i<r){if(!C[e[i]]){i++;continue}if(i>=r)break;a=i;while(i<r&&C[e[i]])i++;f=i;if(f-a>=2)for(s=f-1;s>a;s--)for(l=a;l<s;l++)C[e[l]]>C[e[l+1]]&&(c=e[l],e[l]=e[l+1],e[l+1]=c)}return r}function yr(e,t){var n,r,i,s,o,u,a,f;if(t==0)return 0;f=0,i=e[0],o=C[i],o&&(o=999),n=1,r=n;for(;;){if(r>=t){e[f]=i,f=n;break}s=e[r],u=C[s],a=k[i],a!==undefined&&a[s]!==undefined&&(!o||u&&o<u)?(i=a[s],e[f]=i):(u||(f=n,i=s),o=u,e[n]=s,n++),r++}return f}function br(e,t){var n=e.length,r;return r=gr(e,t),e.length=n,r}function wr(e,t){var n=e.length,r;return r=gr(e,t),r=yr(e,r),e.length=n,r}function Er(e){vt(J,e)}function Sr(e){St(J,e,!1)}function xr(e){mt(J,e,!1)}function Tr(e,t){vt(e,t)}function Nr(e,t){St(e,t,!1)}function Cr(e,t){mt(e,t,!1)}function kr(e){if(!e)throw"glk_get_char_stream_uni: invalid stream";return gt(e,!0)}function Lr(e,t){if(!e)throw"glk_get_buffer_stream_uni: invalid stream";return bt(e,t,!0)}function Ar(e,t){if(!e)throw"glk_get_line_stream_uni: invalid stream";return yt(e,t,!0)}function Or(e,t,n){if(!e)throw"glk_stream_open_file_uni: invalid fileref";var r;if(t!=g.filemode_Read&&t!=g.filemode_Write&&t!=g.filemode_ReadWrite&&t!=g.filemode_WriteAppend)throw"glk_stream_open_file_uni: illegal filemode";if(t==g.filemode_Read&&!Dialog.file_ref_exists(e.ref))throw"glk_stream_open_file_uni: file not found for reading: "+e.ref.filename;var i=null;return t!=g.filemode_Write&&(i=Dialog.file_read(e.ref)),i==null&&(i=[],t!=g.filemode_Read&&Dialog.file_write(e.ref,"",!0)),r=at(j,t!=g.filemode_Write,t!=g.filemode_Read,n),r.unicode=!0,r.ref=e.ref,r.buf=i,r.buflen=4294967295,t==g.filemode_Write?r.bufeof=0:r.bufeof=i.length,t==g.filemode_WriteAppend?r.bufpos=r.bufeof:r.bufpos=0,r}function Mr(e,t,n){var r;if(t!=g.filemode_Read&&t!=g.filemode_Write&&t!=g.filemode_ReadWrite)throw"glk_stream_open_memory: illegal filemode";return r=at(I,t!=g.filemode_Write,t!=g.filemode_Read,n),r.unicode=!0,e&&(r.buf=e,r.buflen=e.length,r.bufpos=0,t==g.filemode_Write?r.bufeof=0:r.bufeof=r.buflen,window.GiDispa&&GiDispa.retain_array(e)),r}function _r(e){if(!e)throw"glk_request_char_event: invalid window";if(e.char_request||e.line_request)throw"glk_request_char_event: window already has keyboard request";if(e.type!=g.wintype_TextBuffer&&e.type!=g.wintype_TextGrid)throw"glk_request_char_event: window does not support keyboard input";e.char_request=!0,e.char_request_uni=!0,e.input_generation=s}function Dr(e,t,n){if(!e)throw"glk_request_line_event: invalid window";if(e.char_request||e.line_request)throw"glk_request_line_event: window already has keyboard request";if(e.type!=g.wintype_TextBuffer&&e.type!=g.wintype_TextGrid)throw"glk_request_line_event: window does not support keyboard input";if(n){var r=t.slice(0,n);u||(u={}),u[e.disprock]=M(r)}e.line_request=!0,e.line_request_uni=!0,e.type==g.wintype_TextBuffer?e.request_echo_line_input=e.echo_line_input:e.request_echo_line_input=!0,e.input_generation=s,e.linebuf=t,window.GiDispa&&GiDispa.retain_array(t)}function Pr(e){var t=(new Date).getTime(),n;e.set_field(0,Math.floor(t/4294967296e3)),e.set_field(1,Math.floor(t/1e3)>>>0),n=Math.floor(t%1e3*1e3),n<0&&(n=1e6+n),e.set_field(2,n)}function Hr(e){var t=(new Date).getTime();return Math.floor(t/(e*1e3))}function Br(e,t){var n=e.get_field(0)*4294967296e3+e.get_field(1)*1e3+e.get_field(2)/1e3,r=new Date(n);t.set_field(0,r.getUTCFullYear()),t.set_field(1,1+r.getUTCMonth()),t.set_field(2,r.getUTCDate()),t.set_field(3,r.getUTCDay()),t.set_field(4,r.getUTCHours()),t.set_field(5,r.getUTCMinutes()),t.set_field(6,r.getUTCSeconds()),t.set_field(7,1e3*r.getUTCMilliseconds())}function jr(e,t){var n=e.get_field(0)*4294967296e3+e.get_field(1)*1e3+e.get_field(2)/1e3,r=new Date(n);t.set_field(0,r.getFullYear()),t.set_field(1,1+r.getMonth()),t.set_field(2,r.getDate()),t.set_field(3,r.getDay()),t.set_field(4,r.getHours()),t.set_field(5,r.getMinutes()),t.set_field(6,r.getSeconds()),t.set_field(7,1e3*r.getMilliseconds())}function Fr(e,t,n){var r=e*1e3*t,i=new Date(r);n.set_field(0,i.getUTCFullYear()),n.set_field(1,1+i.getUTCMonth()),n.set_field(2,i.getUTCDate()),n.set_field(3,i.getUTCDay()),n.set_field(4,i.getUTCHours()),n.set_field(5,i.getUTCMinutes()),n.set_field(6,i.getUTCSeconds()),n.set_field(7,1e3*i.getUTCMilliseconds())}function Ir(e,t,n){var r=e*1e3*t,i=new Date(r);n.set_field(0,i.getFullYear()),n.set_field(1,1+i.getMonth()),n.set_field(2,i.getDate()),n.set_field(3,i.getDay()),n.set_field(4,i.getHours()),n.set_field(5,i.getMinutes()),n.set_field(6,i.getSeconds()),n.set_field(7,1e3*i.getMilliseconds())}function qr(e,t){var n=new Date(0);n.setUTCFullYear(e.get_field(0)),n.setUTCMonth(e.get_field(1)-1),n.setUTCDate(e.get_field(2)),n.setUTCHours(e.get_field(4)),n.setUTCMinutes(e.get_field(5)),n.setUTCSeconds(e.get_field(6)),n.setUTCMilliseconds(e.get_field(7)/1e3);var r=n.getTime(),i;t.set_field(0,Math.floor(r/4294967296e3)),t.set_field(1,Math.floor(r/1e3)>>>0),i=Math.floor(r%1e3*1e3),i<0&&(i=1e6+i),t.set_field(2,i)}function Rr(e,t){var n=new Date(e.get_field(0),e.get_field(1)-1,e.get_field(2),e.get_field(4),e.get_field(5),e.get_field(6),e.get_field(7)/1e3),r=n.getTime(),i;t.set_field(0,Math.floor(r/4294967296e3)),t.set_field(1,Math.floor(r/1e3)>>>0),i=Math.floor(r%1e3*1e3),i<0&&(i=1e6+i),t.set_field(2,i)}function Ur(e,t){var n=new Date(0);n.setUTCFullYear(e.get_field(0)),n.setUTCMonth(e.get_field(1)-1),n.setUTCDate(e.get_field(2)),n.setUTCHours(e.get_field(4)),n.setUTCMinutes(e.get_field(5)),n.setUTCSeconds(e.get_field(6)),n.setUTCMilliseconds(e.get_field(7)/1e3);var r=n.getTime();return Math.floor(r/(t*1e3))}function zr(e,t){var n=new Date(e.get_field(0),e.get_field(1)-1,e.get_field(2),e.get_field(4),e.get_field(5),e.get_field(6),e.get_field(7)/1e3),r=n.getTime();return Math.floor(r/(t*1e3))}var e=null,t=!1,n=!1,r=null,i=null,s=0,o=null,u=null,g={gestalt_Version:0,gestalt_CharInput:1,gestalt_LineInput:2,gestalt_CharOutput:3,gestalt_CharOutput_CannotPrint:0,gestalt_CharOutput_ApproxPrint:1,gestalt_CharOutput_ExactPrint:2,gestalt_MouseInput:4,gestalt_Timer:5,gestalt_Graphics:6,gestalt_DrawImage:7,gestalt_Sound:8,gestalt_SoundVolume:9,gestalt_SoundNotify:10,gestalt_Hyperlinks:11,gestalt_HyperlinkInput:12,gestalt_SoundMusic:13,gestalt_GraphicsTransparency:14,gestalt_Unicode:15,gestalt_UnicodeNorm:16,gestalt_LineInputEcho:17,gestalt_LineTerminators:18,gestalt_LineTerminatorKey:19,gestalt_DateTime:20,gestalt_Sound2:21,gestalt_ResourceStream:22,keycode_Unknown:4294967295,keycode_Left:4294967294,keycode_Right:4294967293,keycode_Up:4294967292,keycode_Down:4294967291,keycode_Return:4294967290,keycode_Delete:4294967289,keycode_Escape:4294967288,keycode_Tab:4294967287,keycode_PageUp:4294967286,keycode_PageDown:4294967285,keycode_Home:4294967284,keycode_End:4294967283,keycode_Func1:4294967279,keycode_Func2:4294967278,keycode_Func3:4294967277,keycode_Func4:4294967276,keycode_Func5:4294967275,keycode_Func6:4294967274,keycode_Func7:4294967273,keycode_Func8:4294967272,keycode_Func9:4294967271,keycode_Func10:4294967270,keycode_Func11:4294967269,keycode_Func12:4294967268,keycode_MAXVAL:28,evtype_None:0,evtype_Timer:1,evtype_CharInput:2,evtype_LineInput:3,evtype_MouseInput:4,evtype_Arrange:5,evtype_Redraw:6,evtype_SoundNotify:7,evtype_Hyperlink:8,evtype_VolumeNotify:9,style_Normal:0,style_Emphasized:1,style_Preformatted:2,style_Header:3,style_Subheader:4,style_Alert:5,style_Note:6,style_BlockQuote:7,style_Input:8,style_User1:9,style_User2:10,style_NUMSTYLES:11,wintype_AllTypes:0,wintype_Pair:1,wintype_Blank:2,wintype_TextBuffer:3,wintype_TextGrid:4,wintype_Graphics:5,winmethod_Left:0,winmethod_Right:1,winmethod_Above:2,winmethod_Below:3,winmethod_DirMask:15,winmethod_Fixed:16,winmethod_Proportional:32,winmethod_DivisionMask:240,winmethod_Border:0,winmethod_NoBorder:256,winmethod_BorderMask:256,fileusage_Data:0,fileusage_SavedGame:1,fileusage_Transcript:2,fileusage_InputRecord:3,fileusage_TypeMask:15,fileusage_TextMode:256,fileusage_BinaryMode:0,filemode_Write:1,filemode_Read:2,filemode_ReadWrite:3,filemode_WriteAppend:5,seekmode_Start:0,seekmode_Current:1,seekmode_End:2,stylehint_Indentation:0,stylehint_ParaIndentation:1,stylehint_Justification:2,stylehint_Size:3,stylehint_Weight:4,stylehint_Oblique:5,stylehint_Proportional:6,stylehint_TextColor:7,stylehint_BackColor:8,stylehint_ReverseColor:9,stylehint_NUMHINTS:10,stylehint_just_LeftFlush:0,stylehint_just_LeftRight:1,stylehint_just_Centered:2,stylehint_just_RightFlush:3},y={left:g.keycode_Left,right:g.keycode_Right,up:g.keycode_Up,down:g.keycode_Down,"return":g.keycode_Return,"delete":g.keycode_Delete,escape:g.keycode_Escape,tab:g.keycode_Tab,pageup:g.keycode_PageUp,pagedown:g.keycode_PageDown,home:g.keycode_Home,end:g.keycode_End,func1:g.keycode_Func1,func2:g.keycode_Func2,func3:g.keycode_Func3,func4:g.keycode_Func4,func5:g.keycode_Func5,func6:g.keycode_Func6,func7:g.keycode_Func7,func8:g.keycode_Func8,func9:g.keycode_Func9,func10:g.keycode_Func10,func11:g.keycode_Func11,func12:g.keycode_Func12},b=null,w={0:"normal",1:"emphasized",2:"preformatted",3:"header",4:"subheader",5:"alert",6:"note",7:"blockquote",8:"input",9:"user1",10:"user2"},E={0:"data",1:"save",2:"transcript",3:"command"},S={181:924,223:[83,83],255:376,305:73,329:[700,78],383:83,405:502,414:544,447:503,454:452,457:455,460:458,477:398,496:[74,780],499:497,595:385,596:390,598:393,599:394,601:399,603:400,608:403,611:404,616:407,617:406,623:412,626:413,629:415,640:422,643:425,648:430,650:433,651:434,658:439,837:921,912:[921,776,769],940:902,941:904,942:905,943:906,944:[933,776,769],962:931,972:908,973:910,974:911,976:914,977:920,981:934,982:928,1008:922,1010:1017,1013:917,1415:[1333,1362],7830:[72,817],7831:[84,776],7832:[87,778],7833:[89,778],7834:[65,702],7835:7776,8016:[933,787],8018:[933,787,768],8020:[933,787,769],8022:[933,787,834],8048:8122,8049:8123,8050:8136,8051:8137,8052:8138,8053:8139,8054:8154,8055:8155,8056:8184,8057:8185,8058:8170,8059:8171,8060:8186,8061:8187,8064:[7944,921],8065:[7945,921],8066:[7946,921],8067:[7947,921],8068:[7948,921],8069:[7949,921],8070:[7950,921],8071:[7951,921],8072:[7944,921],8073:[7945,921],8074:[7946,921],8075:[7947,921],8076:[7948,921],8077:[7949,921],8078:[7950,921],8079:[7951,921],8080:[7976,921],8081:[7977,921],8082:[7978,921],8083:[7979,921],8084:[7980,921],8085:[7981,921],8086:[7982,921],8087:[7983,921],8088:[7976,921],8089:[7977,921],8090:[7978,921],8091:[7979,921],8092:[7980,921],8093:[7981,921],8094:[7982,921],8095:[7983,921],8096:[8040,921],8097:[8041,921],8098:[8042,921],8099:[8043,921],8100:[8044,921],8101:[8045,921],8102:[8046,921],8103:[8047,921],8104:[8040,921],8105:[8041,921],8106:[8042,921],8107:[8043,921],8108:[8044,921],8109:[8045,921],8110:[8046,921],8111:[8047,921],8114:[8122,921],8115:[913,921],8116:[902,921],8118:[913,834],8119:[913,834,921],8124:[913,921],8126:921,8130:[8138,921],8131:[919,921],8132:[905,921],8134:[919,834],8135:[919,834,921],8140:[919,921],8146:[921,776,768],8147:[921,776,769],8150:[921,834],8151:[921,776,834],8162:[933,776,768],8163:[933,776,769],8164:[929,787],8165:8172,8166:[933,834],8167:[933,776,834],8178:[8186,921],8179:[937,921],8180:[911,921],8182:[937,834],8183:[937,834,921],8188:[937,921],64256:[70,70],64257:[70,73],64258:[70,76],64259:[70,70,73],64260:[70,70,76],64261:[83,84],64262:[83,84],64275:[1348,1350],64276:[1348,1333],64277:[1348,1339],64278:[1358,1350],64279:[1348,1341]};(function(){var e,t,n,r=S;e=[7936,7937,7938,7939,7940,7941,7942,7943,7952,7953,7954,7955,7956,7957,7968,7969,7970,7971,7972,7973,7974,7975,7984,7985,7986,7987,7988,7989,7990,7991,8e3,8001,8002,8003,8004,8005,8017,8019,8021,8023,8032,8033,8034,8035,8036,8037,8038,8039,8112,8113,8144,8145,8160,8161];for(t=0;t<54;t++)n=e[t],r[n]=n+8;for(n=257;n<=303;n+=2)r[n]=n-1;for(n=331;n<=375;n+=2)r[n]=n-1;for(n=505;n<=543;n+=2)r[n]=n-1;for(n=1121;n<=1153;n+=2)r[n]=n-1;for(n=1163;n<=1215;n+=2)r[n]=n-1;for(n=1233;n<=1269;n+=2)r[n]=n-1;for(n=7681;n<=7829;n+=2)r[n]=n-1;for(n=7841;n<=7929;n+=2)r[n]=n-1;e=[307,309,311,314,316,318,320,322,324,326,328,378,380,382,387,389,392,396,402,409,417,419,421,424,429,432,436,438,441,445,453,456,459,462,464,466,468,470,472,474,476,479,481,483,485,487,489,491,493,495,498,501,547,549,551,553,555,557,559,561,563,985,987,989,991,993,995,997,999,1001,1003,1005,1007,1016,1019,1218,1220,1222,1224,1226,1228,1230,1273,1281,1283,1285,1287,1289,1291,1293,1295];for(t=0;t<91;t++)n=e[t],r[n]=n-1;for(n=8560;n<=8575;n+=1)r[n]=n-16;for(n=9424;n<=9449;n+=1)r[n]=n-26;for(n=97;n<=122;n+=1)r[n]=n-32;for(n=224;n<=246;n+=1)r[n]=n-32;for(n=945;n<=961;n+=1)r[n]=n-32;for(n=1072;n<=1103;n+=1)r[n]=n-32;for(n=65345;n<=65370;n+=1)r[n]=n-32;e=[248,249,250,251,252,253,254,963,964,965,966,967,968,969,970,971];for(t=0;t<16;t++)n=e[t],r[n]=n-32;for(n=66600;n<=66639;n+=1)r[n]=n-40;for(n=1377;n<=1414;n+=1)r[n]=n-48;for(n=1104;n<=1119;n+=1)r[n]=n-80;r[1009]=929})();var x={304:[105,775],376:255,385:595,390:596,393:598,394:599,398:477,399:601,400:603,403:608,404:611,406:617,407:616,412:623,413:626,415:629,422:640,425:643,430:648,433:650,434:651,439:658,452:454,455:457,458:460,497:499,502:405,503:447,544:414,902:940,904:941,905:942,906:943,908:972,910:973,911:974,1012:952,1017:1010,8122:8048,8123:8049,8124:8115,8136:8050,8137:8051,8138:8052,8139:8053,8140:8131,8154:8054,8155:8055,8170:8058,8171:8059,8172:8165,8184:8056,8185:8057,8186:8060,8187:8061,8188:8179,8486:969,8490:107,8491:229};(function(){var e,t,n,r=x;for(n=1024;n<=1039;n+=1)r[n]=n+80;for(n=1329;n<=1366;n+=1)r[n]=n+48;for(n=66560;n<=66599;n+=1)r[n]=n+40;for(n=65;n<=90;n+=1)r[n]=n+32;for(n=192;n<=214;n+=1)r[n]=n+32;for(n=913;n<=929;n+=1)r[n]=n+32;for(n=1040;n<=1071;n+=1)r[n]=n+32;for(n=65313;n<=65338;n+=1)r[n]=n+32;e=[216,217,218,219,220,221,222,931,932,933,934,935,936,937,938,939];for(t=0;t<16;t++)n=e[t],r[n]=n+32;for(n=9398;n<=9423;n+=1)r[n]=n+26;for(n=8544;n<=8559;n+=1)r[n]=n+16;for(n=256;n<=302;n+=2)r[n]=n+1;for(n=330;n<=374;n+=2)r[n]=n+1;for(n=504;n<=542;n+=2)r[n]=n+1;for(n=1120;n<=1152;n+=2)r[n]=n+1;for(n=1162;n<=1214;n+=2)r[n]=n+1;for(n=1232;n<=1268;n+=2)r[n]=n+1;for(n=7680;n<=7828;n+=2)r[n]=n+1;for(n=7840;n<=7928;n+=2)r[n]=n+1;e=[306,308,310,313,315,317,319,321,323,325,327,377,379,381,386,388,391,395,401,408,416,418,420,423,428,431,435,437,440,444,453,456,459,461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,498,500,546,548,550,552,554,556,558,560,562,984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1015,1018,1217,1219,1221,1223,1225,1227,1229,1272,1280,1282,1284,1286,1288,1290,1292,1294];for(t=0;t<91;t++)n=e[t],r[n]=n+1;e=[7944,7945,7946,7947,7948,7949,7950,7951,7960,7961,7962,7963,7964,7965,7976,7977,7978,7979,7980,7981,7982,7983,7992,7993,7994,7995,7996,7997,7998,7999,8008,8009,8010,8011,8012,8013,8025,8027,8029,8031,8040,8041,8042,8043,8044,8045,8046,8047,8072,8073,8074,8075,8076,8077,8078,8079,8088,8089,8090,8091,8092,8093,8094,8095,8104,8105,8106,8107,8108,8109,8110,8111,8120,8121,8152,8153,8168,8169];for(t=0;t<78;t++)n=e[t],r[n]=n-8})();var T={223:[83,115],452:453,453:453,454:453,455:456,456:456,457:456,458:459,459:459,460:459,497:498,498:498,499:498,1415:[1333,1410],8114:[8122,837],8115:8124,8116:[902,837],8119:[913,834,837],8124:8124,8130:[8138,837],8131:8140,8132:[905,837],8135:[919,834,837],8140:8140,8178:[8186,837],8179:8188,8180:[911,837],8183:[937,834,837],8188:8188,64256:[70,102],64257:[70,105],64258:[70,108],64259:[70,102,105],64260:[70,102,108],64261:[83,116],64262:[83,116],64275:[1348,1398],64276:[1348,1381],64277:[1348,1387],64278:[1358,1398],64279:[1348,1389]};(function(){var e,t,n,r=T;e=[8072,8073,8074,8075,8076,8077,8078,8079,8072,8073,8074,8075,8076,8077,8078,8079,8088,8089,8090,8091,8092,8093,8094,8095,8088,8089,8090,8091,8092,8093,8094,8095,8104,8105,8106,8107,8108,8109,8110,8111,8104,8105,8106,8107,8108,8109,8110,8111];for(t=0;t<48;t++)n=e[t],r[t+8064]=n})();var N={192:[65,768],193:[65,769],194:[65,770],195:[65,771],196:[65,776],197:[65,778],199:[67,807],200:[69,768],201:[69,769],202:[69,770],203:[69,776],204:[73,768],205:[73,769],206:[73,770],207:[73,776],209:[78,771],210:[79,768],211:[79,769],212:[79,770],213:[79,771],214:[79,776],217:[85,768],218:[85,769],219:[85,770],220:[85,776],221:[89,769],224:[97,768],225:[97,769],226:[97,770],227:[97,771],228:[97,776],229:[97,778],231:[99,807],232:[101,768],233:[101,769],234:[101,770],235:[101,776],236:[105,768],237:[105,769],238:[105,770],239:[105,776],241:[110,771],242:[111,768],243:[111,769],244:[111,770],245:[111,771],246:[111,776],249:[117,768],250:[117,769],251:[117,770],252:[117,776],253:[121,769],296:[73,771],297:[105,771],298:[73,772],299:[105,772],300:[73,774],301:[105,774],302:[73,808],303:[105,808],304:[73,775],308:[74,770],309:[106,770],310:[75,807],311:[107,807],313:[76,769],314:[108,769],315:[76,807],316:[108,807],317:[76,780],318:[108,780],323:[78,769],324:[110,769],325:[78,807],326:[110,807],327:[78,780],328:[110,780],332:[79,772],333:[111,772],334:[79,774],335:[111,774],336:[79,779],337:[111,779],416:[79,795],417:[111,795],431:[85,795],432:[117,795],478:[65,776,772],479:[97,776,772],480:[65,775,772],481:[97,775,772],482:[198,772],483:[230,772],486:[71,780],487:[103,780],488:[75,780],489:[107,780],490:[79,808],491:[111,808],492:[79,808,772],493:[111,808,772],494:[439,780],495:[658,780],496:[106,780],500:[71,769],501:[103,769],542:[72,780],543:[104,780],550:[65,775],551:[97,775],552:[69,807],553:[101,807],554:[79,776,772],555:[111,776,772],556:[79,771,772],557:[111,771,772],558:[79,775],559:[111,775],560:[79,775,772],561:[111,775,772],562:[89,772],563:[121,772],832:768,833:769,835:787,836:[776,769],884:697,894:59,901:[168,769],902:[913,769],903:183,904:[917,769],905:[919,769],906:[921,769],908:[927,769],910:[933,769],911:[937,769],912:[953,776,769],938:[921,776],939:[933,776],940:[945,769],941:[949,769],942:[951,769],943:[953,769],944:[965,776,769],970:[953,776],971:[965,776],972:[959,769],973:[965,769],974:[969,769],979:[978,769],980:[978,776],1024:[1045,768],1025:[1045,776],1027:[1043,769],1031:[1030,776],1036:[1050,769],1037:[1048,768],1038:[1059,774],1049:[1048,774],1081:[1080,774],1104:[1077,768],1105:[1077,776],1107:[1075,769],1111:[1110,776],1116:[1082,769],1117:[1080,768],1118:[1091,774],1142:[1140,783],1143:[1141,783],1217:[1046,774],1218:[1078,774],1232:[1040,774],1233:[1072,774],1234:[1040,776],1235:[1072,776],1238:[1045,774],1239:[1077,774],1242:[1240,776],1243:[1241,776],1244:[1046,776],1245:[1078,776],1246:[1047,776],1247:[1079,776],1250:[1048,772],1251:[1080,772],1252:[1048,776],1253:[1080,776],1254:[1054,776],1255:[1086,776],1258:[1256,776],1259:[1257,776],1260:[1069,776],1261:[1101,776],1262:[1059,772],1263:[1091,772],1264:[1059,776],1265:[1091,776],1266:[1059,779],1267:[1091,779],1268:[1063,776],1269:[1095,776],1272:[1067,776],1273:[1099,776],1570:[1575,1619],1571:[1575,1620],1572:[1608,1620],1573:[1575,1621],1574:[1610,1620],1728:[1749,1620],1730:[1729,1620],1747:[1746,1620],2345:[2344,2364],2353:[2352,2364],2356:[2355,2364],2392:[2325,2364],2393:[2326,2364],2394:[2327,2364],2395:[2332,2364],2396:[2337,2364],2397:[2338,2364],2398:[2347,2364],2399:[2351,2364],2507:[2503,2494],2508:[2503,2519],2524:[2465,2492],2525:[2466,2492],2527:[2479,2492],2611:[2610,2620],2614:[2616,2620],2649:[2582,2620],2650:[2583,2620],2651:[2588,2620],2654:[2603,2620],2888:[2887,2902],2891:[2887,2878],2892:[2887,2903],2908:[2849,2876],2909:[2850,2876],2964:[2962,3031],3018:[3014,3006],3019:[3015,3006],3020:[3014,3031],3144:[3142,3158],3264:[3263,3285],3271:[3270,3285],3272:[3270,3286],3274:[3270,3266],3275:[3270,3266,3285],3402:[3398,3390],3403:[3399,3390],3404:[3398,3415],3546:[3545,3530],3548:[3545,3535],3549:[3545,3535,3530],3550:[3545,3551],3907:[3906,4023],3917:[3916,4023],3922:[3921,4023],3927:[3926,4023],3932:[3931,4023],3945:[3904,4021],3955:[3953,3954],3957:[3953,3956],3958:[4018,3968],3960:[4019,3968],3969:[3953,3968],3987:[3986,4023],3997:[3996,4023],4002:[4001,4023],4007:[4006,4023],4012:[4011,4023],4025:[3984,4021],4134:[4133,4142],7835:[383,775],7960:[917,787],7961:[917,788],7962:[917,787,768],7963:[917,788,768],7964:[917,787,769],7965:[917,788,769],8008:[927,787],8009:[927,788],8010:[927,787,768],8011:[927,788,768],8012:[927,787,769],8013:[927,788,769],8016:[965,787],8017:[965,788],8018:[965,787,768],8019:[965,788,768],8020:[965,787,769],8021:[965,788,769],8022:[965,787,834],8023:[965,788,834],8025:[933,788],8027:[933,788,768],8029:[933,788,769],8118:[945,834],8119:[945,834,837],8120:[913,774],8121:[913,772],8122:[913,768],8123:[913,769],8124:[913,837],8126:953,8129:[168,834],8130:[951,768,837],8131:[951,837],8132:[951,769,837],8134:[951,834],8135:[951,834,837],8136:[917,768],8137:[917,769],8138:[919,768],8139:[919,769],8140:[919,837],8141:[8127,768],8142:[8127,769],8143:[8127,834],8144:[953,774],8145:[953,772],8146:[953,776,768],8147:[953,776,769],8150:[953,834],8151:[953,776,834],8152:[921,774],8153:[921,772],8154:[921,768],8155:[921,769],8178:[969,768,837],8179:[969,837],8180:[969,769,837],8182:[969,834],8183:[969,834,837],8184:[927,768],8185:[927,769],8186:[937,768],8187:[937,769],8188:[937,837],8189:180,8192:8194,8193:8195,8486:937,8490:75,8491:[65,778],8602:[8592,824],8603:[8594,824],8622:[8596,824],8653:[8656,824],8654:[8660,824],8655:[8658,824],8708:[8707,824],8713:[8712,824],8716:[8715,824],8740:[8739,824],8742:[8741,824],8769:[8764,824],8772:[8771,824],8775:[8773,824],8777:[8776,824],8800:[61,824],8802:[8801,824],8813:[8781,824],8814:[60,824],8815:[62,824],8816:[8804,824],8817:[8805,824],8820:[8818,824],8821:[8819,824],8824:[8822,824],8825:[8823,824],8832:[8826,824],8833:[8827,824],8836:[8834,824],8837:[8835,824],8840:[8838,824],8841:[8839,824],8876:[8866,824],8877:[8872,824],8878:[8873,824],8879:[8875,824],8928:[8828,824],8929:[8829,824],8930:[8849,824],8931:[8850,824],8938:[8882,824],8939:[8883,824],8940:[8884,824],8941:[8885,824],9001:12296,9002:12297,10972:[10973,824],12364:[12363,12441],12366:[12365,12441],12368:[12367,12441],12370:[12369,12441],12372:[12371,12441],12374:[12373,12441],12376:[12375,12441],12378:[12377,12441],12380:[12379,12441],12382:[12381,12441],12384:[12383,12441],12386:[12385,12441],12389:[12388,12441],12391:[12390,12441],12393:[12392,12441],12400:[12399,12441],12401:[12399,12442],12403:[12402,12441],12404:[12402,12442],12406:[12405,12441],12407:[12405,12442],12409:[12408,12441],12410:[12408,12442],12412:[12411,12441],12413:[12411,12442],12436:[12358,12441],12446:[12445,12441],12460:[12459,12441],12462:[12461,12441],12464:[12463,12441],12466:[12465,12441],12468:[12467,12441],12470:[12469,12441],12472:[12471,12441],12474:[12473,12441],12476:[12475,12441],12478:[12477,12441],12480:[12479,12441],12482:[12481,12441],12485:[12484,12441],12487:[12486,12441],12489:[12488,12441],12496:[12495,12441],12497:[12495,12442],12499:[12498,12441],12500:[12498,12442],12502:[12501,12441],12503:[12501,12442],12505:[12504,12441],12506:[12504,12442],12508:[12507,12441],12509:[12507,12442],12532:[12454,12441],12535:[12527,12441],12536:[12528,12441],12537:[12529,12441],12538:[12530,12441],12542:[12541,12441],64016:22618,64018:26228,64021:20958,64022:29482,64023:30410,64024:31036,64025:31070,64026:31077,64027:31119,64028:38742,64029:31934,64030:32701,64032:34322,64034:35576,64037:36920,64038:37117,64042:39151,64043:39164,64044:39208,64045:40372,64285:[1497,1460],64287:[1522,1463],64298:[1513,1473],64299:[1513,1474],64300:[1513,1468,1473],64301:[1513,1468,1474],64302:[1488,1463],64303:[1488,1464],64304:[1488,1468],64305:[1489,1468],64306:[1490,1468],64307:[1491,1468],64308:[1492,1468],64309:[1493,1468],64310:[1494,1468],64312:[1496,1468],64313:[1497,1468],64314:[1498,1468],64315:[1499,1468],64316:[1500,1468],64318:[1502,1468],64320:[1504,1468],64321:[1505,1468],64323:[1507,1468],64324:[1508,1468],64326:[1510,1468],64327:[1511,1468],64328:[1512,1468],64329:[1513,1468],64330:[1514,1468],64331:[1493,1465],64332:[1489,1471],64333:[1499,1471],64334:[1508,1471],119134:[119127,119141],119135:[119128,119141],119136:[119128,119141,119150],119137:[119128,119141,119151],119138:[119128,119141,119152],119139:[119128,119141,119153],119140:[119128,119141,119154],119227:[119225,119141],119228:[119226,119141],119229:[119225,119141,119150],119230:[119226,119141,119150],119231:[119225,119141,119151],119232:[119226,119141,119151]};(function(){var e,t,n,r=N;e=[[121,776],[65,772],[97,772],[65,774],[97,774],[65,808],[97,808],[67,769],[99,769],[67,770],[99,770],[67,775],[99,775],[67,780],[99,780],[68,780],[100,780]];for(t=0;t<17;t++)n=e[t],r[t+255]=n;e=[[69,772],[101,772],[69,774],[101,774],[69,775],[101,775],[69,808],[101,808],[69,780],[101,780],[71,770],[103,770],[71,774],[103,774],[71,775],[103,775],[71,807],[103,807],[72,770],[104,770]];for(t=0;t<20;t++)n=e[t],r[t+274]=n;e=[[82,769],[114,769],[82,807],[114,807],[82,780],[114,780],[83,769],[115,769],[83,770],[115,770],[83,807],[115,807],[83,780],[115,780],[84,807],[116,807],[84,780],[116,780]];for(t=0;t<18;t++)n=e[t],r[t+340]=n;e=[[85,771],[117,771],[85,772],[117,772],[85,774],[117,774],[85,778],[117,778],[85,779],[117,779],[85,808],[117,808],[87,770],[119,770],[89,770],[121,770],[89,776],[90,769],[122,769],[90,775],[122,775],[90,780],[122,780]];for(t=0;t<23;t++)n=e[t],r[t+360]=n;e=[[65,780],[97,780],[73,780],[105,780],[79,780],[111,780],[85,780],[117,780],[85,776,772],[117,776,772],[85,776,769],[117,776,769],[85,776,780],[117,776,780],[85,776,768],[117,776,768]];for(t=0;t<16;t++)n=e[t],r[t+461]=n;e=[[78,768],[110,768],[65,778,769],[97,778,769],[198,769],[230,769],[216,769],[248,769],[65,783],[97,783],[65,785],[97,785],[69,783],[101,783],[69,785],[101,785],[73,783],[105,783],[73,785],[105,785],[79,783],[111,783],[79,785],[111,785],[82,783],[114,783],[82,785],[114,785],[85,783],[117,783],[85,785],[117,785],[83,806],[115,806],[84,806],[116,806]];for(t=0;t<36;t++)n=e[t],r[t+504]=n;e=[[65,805],[97,805],[66,775],[98,775],[66,803],[98,803],[66,817],[98,817],[67,807,769],[99,807,769],[68,775],[100,775],[68,803],[100,803],[68,817],[100,817],[68,807],[100,807],[68,813],[100,813],[69,772,768],[101,772,768],[69,772,769],[101,772,769],[69,813],[101,813],[69,816],[101,816],[69,807,774],[101,807,774],[70,775],[102,775],[71,772],[103,772],[72,775],[104,775],[72,803],[104,803],[72,776],[104,776],[72,807],[104,807],[72,814],[104,814],[73,816],[105,816],[73,776,769],[105,776,769],[75,769],[107,769],[75,803],[107,803],[75,817],[107,817],[76,803],[108,803],[76,803,772],[108,803,772],[76,817],[108,817],[76,813],[108,813],[77,769],[109,769],[77,775],[109,775],[77,803],[109,803],[78,775],[110,775],[78,803],[110,803],[78,817],[110,817],[78,813],[110,813],[79,771,769],[111,771,769],[79,771,776],[111,771,776],[79,772,768],[111,772,768],[79,772,769],[111,772,769],[80,769],[112,769],[80,775],[112,775],[82,775],[114,775],[82,803],[114,803],[82,803,772],[114,803,772],[82,817],[114,817],[83,775],[115,775],[83,803],[115,803],[83,769,775],[115,769,775],[83,780,775],[115,780,775],[83,803,775],[115,803,775],[84,775],[116,775],[84,803],[116,803],[84,817],[116,817],[84,813],[116,813],[85,804],[117,804],[85,816],[117,816],[85,813],[117,813],[85,771,769],[117,771,769],[85,772,776],[117,772,776],[86,771],[118,771],[86,803],[118,803],[87,768],[119,768],[87,769],[119,769],[87,776],[119,776],[87,775],[119,775],[87,803],[119,803],[88,775],[120,775],[88,776],[120,776],[89,775],[121,775],[90,770],[122,770],[90,803],[122,803],[90,817],[122,817],[104,817],[116,776],[119,778],[121,778]];for(t=0;t<154;t++)n=e[t],r[t+7680]=n;e=[[65,803],[97,803],[65,777],[97,777],[65,770,769],[97,770,769],[65,770,768],[97,770,768],[65,770,777],[97,770,777],[65,770,771],[97,770,771],[65,803,770],[97,803,770],[65,774,769],[97,774,769],[65,774,768],[97,774,768],[65,774,777],[97,774,777],[65,774,771],[97,774,771],[65,803,774],[97,803,774],[69,803],[101,803],[69,777],[101,777],[69,771],[101,771],[69,770,769],[101,770,769],[69,770,768],[101,770,768],[69,770,777],[101,770,777],[69,770,771],[101,770,771],[69,803,770],[101,803,770],[73,777],[105,777],[73,803],[105,803],[79,803],[111,803],[79,777],[111,777],[79,770,769],[111,770,769],[79,770,768],[111,770,768],[79,770,777],[111,770,777],[79,770,771],[111,770,771],[79,803,770],[111,803,770],[79,795,769],[111,795,769],[79,795,768],[111,795,768],[79,795,777],[111,795,777],[79,795,771],[111,795,771],[79,795,803],[111,795,803],[85,803],[117,803],[85,777],[117,777],[85,795,769],[117,795,769],[85,795,768],[117,795,768],[85,795,777],[117,795,777],[85,795,771],[117,795,771],[85,795,803],[117,795,803],[89,768],[121,768],[89,803],[121,803],[89,777],[121,777],[89,771],[121,771]];for(t=0;t<90;t++)n=e[t],r[t+7840]=n;e=[[945,787],[945,788],[945,787,768],[945,788,768],[945,787,769],[945,788,769],[945,787,834],[945,788,834],[913,787],[913,788],[913,787,768],[913,788,768],[913,787,769],[913,788,769],[913,787,834],[913,788,834],[949,787],[949,788],[949,787,768],[949,788,768],[949,787,769],[949,788,769]];for(t=0;t<22;t++)n=e[t],r[t+7936]=n;e=[[951,787],[951,788],[951,787,768],[951,788,768],[951,787,769],[951,788,769],[951,787,834],[951,788,834],[919,787],[919,788],[919,787,768],[919,788,768],[919,787,769],[919,788,769],[919,787,834],[919,788,834],[953,787],[953,788],[953,787,768],[953,788,768],[953,787,769],[953,788,769],[953,787,834],[953,788,834],[921,787],[921,788],[921,787,768],[921,788,768],[921,787,769],[921,788,769],[921,787,834],[921,788,834],[959,787],[959,788],[959,787,768],[959,788,768],[959,787,769],[959,788,769]];for(t=0;t<38;t++)n=e[t],r[t+7968]=n;e=[[933,788,834],[969,787],[969,788],[969,787,768],[969,788,768],[969,787,769],[969,788,769],[969,787,834],[969,788,834],[937,787],[937,788],[937,787,768],[937,788,768],[937,787,769],[937,788,769],[937,787,834],[937,788,834],[945,768],[945,769],[949,768],[949,769],[951,768],[951,769],[953,768],[953,769],[959,768],[959,769],[965,768],[965,769],[969,768],[969,769]];for(t=0;t<31;t++)n=e[t],r[t+8031]=n;e=[[945,787,837],[945,788,837],[945,787,768,837],[945,788,768,837],[945,787,769,837],[945,788,769,837],[945,787,834,837],[945,788,834,837],[913,787,837],[913,788,837],[913,787,768,837],[913,788,768,837],[913,787,769,837],[913,788,769,837],[913,787,834,837],[913,788,834,837],[951,787,837],[951,788,837],[951,787,768,837],[951,788,768,837],[951,787,769,837],[951,788,769,837],[951,787,834,837],[951,788,834,837],[919,787,837],[919,788,837],[919,787,768,837],[919,788,768,837],[919,787,769,837],[919,788,769,837],[919,787,834,837],[919,788,834,837],[969,787,837],[969,788,837],[969,787,768,837],[969,788,768,837],[969,787,769,837],[969,788,769,837],[969,787,834,837],[969,788,834,837],[937,787,837],[937,788,837],[937,787,768,837],[937,788,768,837],[937,787,769,837],[937,788,769,837],[937,787,834,837],[937,788,834,837],[945,774],[945,772],[945,768,837],[945,837],[945,769,837]];for(t=0;t<53;t++)n=e[t],r[t+8064]=n;e=[[8190,768],[8190,769],[8190,834],[965,774],[965,772],[965,776,768],[965,776,769],[961,787],[961,788],[965,834],[965,776,834],[933,774],[933,772],[933,768],[933,769],[929,788],[168,768],[168,769],96];for(t=0;t<19;t++)n=e[t],r[t+8157]=n;e=[35912,26356,36554,36040,28369,20018,21477,40860,40860,22865,37329,21895,22856,25078,30313,32645,34367,34746,35064,37007,27138,27931,28889,29662,33853,37226,39409,20098,21365,27396,29211,34349,40478,23888,28651,34253,35172,25289,33240,34847,24266,26391,28010,29436,37070,20358,20919,21214,25796,27347,29200,30439,32769,34310,34396,36335,38706,39791,40442,30860,31103,32160,33737,37636,40575,35542,22751,24324,31840,32894,29282,30922,36034,38647,22744,23650,27155,28122,28431,32047,32311,38475,21202,32907,20956,20940,31260,32190,33777,38517,35712,25295,27138,35582,20025,23527,24594,29575,30064,21271,30971,20415,24489,19981,27852,25976,32034,21443,22622,30465,33865,35498,27578,36784,27784,25342,33509,25504,30053,20142,20841,20937,26753,31975,33391,35538,37327,21237,21570,22899,24300,26053,28670,31018,38317,39530,40599,40654,21147,26310,27511,36706,24180,24976,25088,25754,28451,29001,29833,31178,32244,32879,36646,34030,36899,37706,21015,21155,21693,28872,35010,35498,24265,24565,25467,27566,31806,29557,20196,22265,23527,23994,24604,29618,29801,32666,32838,37428,38646,38728,38936,20363,31150,37300,38584,24801,20102,20698,23534,23615,26009,27138,29134,30274,34044,36988,40845,26248,38446,21129,26491,26611,27969,28316,29705,30041,30827,32016,39006,20845,25134,38520,20523,23833,28138,36650,24459,24900,26647,29575,38534,21033,21519,23653,26131,26446,26792,27877,29702,30178,32633,35023,35041,37324,38626,21311,28346,21533,29136,29848,34298,38563,40023,40607,26519,28107,33256,31435,31520,31890,29376,28825,35672,20160,33590,21050,20999,24230,25299,31958,23429,27934,26292,36667,34892,38477,35211,24275,20800,21952];for(t=0;t<270;t++)n=e[t],r[t+63744]=n;e=[20398,20711,20813,21193,21220,21329,21917,22022,22120,22592,22696,23652,23662,24724,24936,24974,25074,25935,26082,26257,26757,28023,28186,28450,29038,29227,29730,30865,31038,31049,31048,31056,31062,31069,31117,31118,31296,31361,31680,32244,32265,32321,32626,32773,33261,33401,33401,33879,35088,35222,35585,35641,36051,36104,36790,36920,38627,38911,38971];for(t=0;t<59;t++)n=e[t],r[t+64048]=n;e=[20029,20024,20033,131362,20320,20398,20411,20482,20602,20633,20711,20687,13470,132666,20813,20820,20836,20855,132380,13497,20839,20877,132427,20887,20900,20172,20908,20917,168415,20981,20995,13535,21051,21062,21106,21111,13589,21191,21193,21220,21242,21253,21254,21271,21321,21329,21338,21363,21373,21375,21375,21375,133676,28784,21450,21471,133987,21483,21489,21510,21662,21560,21576,21608,21666,21750,21776,21843,21859,21892,21892,21913,21931,21939,21954,22294,22022,22295,22097,22132,20999,22766,22478,22516,22541,22411,22578,22577,22700,136420,22770,22775,22790,22810,22818,22882,136872,136938,23020,23067,23079,23e3,23142,14062,14076,23304,23358,23358,137672,23491,23512,23527,23539,138008,23551,23558,24403,23586,14209,23648,23662,23744,23693,138724,23875,138726,23918,23915,23932,24033,24034,14383,24061,24104,24125,24169,14434,139651,14460,24240,24243,24246,24266,172946,24318,140081,140081,33281,24354,24354,14535,144056,156122,24418,24427,14563,24474,24525,24535,24569,24705,14650,14620,24724,141012,24775,24904,24908,24910,24908,24954,24974,25010,24996,25007,25054,25074,25078,25104,25115,25181,25265,25300,25424,142092,25405,25340,25448,25475,25572,142321,25634,25541,25513,14894,25705,25726,25757,25719,14956,25935,25964,143370,26083,26360,26185,15129,26257,15112,15076,20882,20885,26368,26268,32941,17369,26391,26395,26401,26462,26451,144323,15177,26618,26501,26706,26757,144493,26766,26655,26900,15261,26946,27043,27114,27304,145059,27355,15384,27425,145575,27476,15438,27506,27551,27578,27579,146061,138507,146170,27726,146620,27839,27853,27751,27926,27966,28023,27969,28009,28024,28037,146718,27956,28207,28270,15667,28363,28359,147153,28153,28526,147294,147342,28614,28729,28702,28699,15766,28746,28797,28791,28845,132389,28997,148067,29084,148395,29224,29237,29264,149e3,29312,29333,149301,149524,29562,29579,16044,29605,16056,16056,29767,29788,29809,29829,29898,16155,29988,150582,30014,150674,30064,139679,30224,151457,151480,151620,16380,16392,30452,151795,151794,151833,151859,30494,30495,30495,30538,16441,30603,16454,16534,152605,30798,30860,30924,16611,153126,31062,153242,153285,31119,31211,16687,31296,31306,31311,153980,154279,154279,31470,16898,154539,31686,31689,16935,154752,31954,17056,31976,31971,32e3,155526,32099,17153,32199,32258,32325,17204,156200,156231,17241,156377,32634,156478,32661,32762,32773,156890,156963,32864,157096,32880,144223,17365,32946,33027,17419,33086,23221,157607,157621,144275,144284,33281,33284,36766,17515,33425,33419,33437,21171,33457,33459,33469,33510,158524,33509,33565,33635,33709,33571,33725,33767,33879,33619,33738,33740,33756,158774,159083,158933,17707,34033,34035,34070,160714,34148,159532,17757,17761,159665,159954,17771,34384,34396,34407,34409,34473,34440,34574,34530,34681,34600,34667,34694,17879,34785,34817,17913,34912,34915,161383,35031,35038,17973,35066,13499,161966,162150,18110,18119,35488,35565,35722,35925,162984,36011,36033,36123,36215,163631,133124,36299,36284,36336,133342,36564,36664,165330,165357,37012,37105,37137,165678,37147,37432,37591,37592,37500,37881,37909,166906,38283,18837,38327,167287,18918,38595,23986,38691,168261,168474,19054,19062,38880,168970,19122,169110,38923,38923,38953,169398,39138,19251,39209,39335,39362,39422,19406,170800,39698,4e4,40189,19662,19693,40295,172238,19704,172293,172558,172689,40635,19798,40697,40702,40709,40719,40726,40763,173568];for(t=0;t<542;t++)n=e[t],r[t+194560]=n})();var C={768:230,769:230,770:230,771:230,772:230,773:230,774:230,775:230,776:230,777:230,778:230,779:230,780:230,781:230,782:230,783:230,784:230,785:230,786:230,787:230,788:230,789:232,790:220,791:220,792:220,793:220,794:232,795:216,796:220,797:220,798:220,799:220,800:220,801:202,802:202,803:220,804:220,805:220,806:220,807:202,808:202,809:220,810:220,811:220,812:220,813:220,814:220,815:220,816:220,817:220,818:220,819:220,820:1,821:1,822:1,823:1,824:1,825:220,826:220,827:220,828:220,829:230,830:230,831:230,832:230,833:230,834:230,835:230,836:230,837:240,838:230,839:220,840:220,841:220,842:230,843:230,844:230,845:220,846:220,848:230,849:230,850:230,851:220,852:220,853:220,854:220,855:230,861:234,862:234,863:233,864:234,865:234,866:233,867:230,868:230,869:230,870:230,871:230,872:230,873:230,874:230,875:230,876:230,877:230,878:230,879:230,1155:230,1156:230,1157:230,1158:230,1425:220,1426:230,1427:230,1428:230,1429:230,1430:220,1431:230,1432:230,1433:230,1434:222,1435:220,1436:230,1437:230,1438:230,1439:230,1440:230,1441:230,1443:220,1444:220,1445:220,1446:220,1447:220,1448:230,1449:230,1450:220,1451:230,1452:230,1453:222,1454:228,1455:230,1456:10,1457:11,1458:12,1459:13,1460:14,1461:15,1462:16,1463:17,1464:18,1465:19,1467:20,1468:21,1469:22,1471:23,1473:24,1474:25,1476:230,1552:230,1553:230,1554:230,1555:230,1556:230,1557:230,1611:27,1612:28,1613:29,1614:30,1615:31,1616:32,1617:33,1618:34,1619:230,1620:230,1621:220,1622:220,1623:230,1624:230,1648:35,1750:230,1751:230,1752:230,1753:230,1754:230,1755:230,1756:230,1759:230,1760:230,1761:230,1762:230,1763:220,1764:230,1767:230,1768:230,1770:220,1771:230,1772:230,1773:220,1809:36,1840:230,1841:220,1842:230,1843:230,1844:220,1845:230,1846:230,1847:220,1848:220,1849:220,1850:230,1851:220,1852:220,1853:230,1854:220,1855:230,1856:230,1857:230,1858:220,1859:230,1860:220,1861:230,1862:220,1863:230,1864:220,1865:230,1866:230,2364:7,2381:9,2385:230,2386:220,2387:230,2388:230,2492:7,2509:9,2620:7,2637:9,2748:7,2765:9,2876:7,2893:9,3021:9,3149:9,3157:84,3158:91,3260:7,3277:9,3405:9,3530:9,3640:103,3641:103,3642:9,3656:107,3657:107,3658:107,3659:107,3768:118,3769:118,3784:122,3785:122,3786:122,3787:122,3864:220,3865:220,3893:220,3895:220,3897:216,3953:129,3954:130,3956:132,3962:130,3963:130,3964:130,3965:130,3968:130,3970:230,3971:230,3972:9,3974:230,3975:230,4038:220,4151:7,4153:9,5908:9,5940:9,6098:9,6109:230,6313:228,6457:222,6458:230,6459:220,8400:230,8401:230,8402:1,8403:1,8404:230,8405:230,8406:230,8407:230,8408:1,8409:1,8410:1,8411:230,8412:230,8417:230,8421:1,8422:1,8423:230,8424:220,8425:230,8426:1,12330:218,12331:228,12332:232,12333:222,12334:224,12335:224,12441:8,12442:8,64286:26,65056:230,65057:230,65058:230,65059:230,119141:216,119142:216,119143:1,119144:1,119145:1,119149:226,119150:216,119151:216,119152:216,119153:216,119154:216,119163:220,119164:220,119165:220,119166:220,119167:220,119168:220,119169:220,119170:220,119173:230,119174:230,119175:230,119176:230,119177:230,119178:220,119179:220,119210:230,119211:230,119212:230,119213:230},k={60:{824:8814},61:{824:8800},62:{824:8815},65:{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260},66:{775:7682,803:7684,817:7686},67:{769:262,770:264,775:266,780:268,807:199},68:{775:7690,780:270,803:7692,807:7696,813:7698,817:7694},69:{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706},70:{775:7710},71:{769:500,770:284,772:7712,774:286,775:288,780:486,807:290},72:{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722},73:{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724},74:{770:308},75:{769:7728,780:488,803:7730,807:310,817:7732},76:{769:313,780:317,803:7734,807:315,813:7740,817:7738},77:{769:7742,775:7744,803:7746},78:{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752},79:{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490},80:{769:7764,775:7766},82:{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774},83:{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350},84:{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790},85:{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796},86:{771:7804,803:7806},87:{768:7808,769:7810,770:372,775:7814,776:7812,803:7816},88:{775:7818,776:7820},89:{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924},90:{769:377,770:7824,775:379,780:381,803:7826,817:7828},97:{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261},98:{775:7683,803:7685,817:7687},99:{769:263,770:265,775:267,780:269,807:231},100:{775:7691,780:271,803:7693,807:7697,813:7699,817:7695},101:{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707},102:{775:7711},103:{769:501,770:285,772:7713,774:287,775:289,780:487,807:291},104:{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830},105:{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725},106:{770:309,780:496},107:{769:7729,780:489,803:7731,807:311,817:7733},108:{769:314,780:318,803:7735,807:316,813:7741,817:7739},109:{769:7743,775:7745,803:7747},110:{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753},111:{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491},112:{769:7765,775:7767},114:{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775},115:{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351},116:{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791},117:{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797},118:{771:7805,803:7807},119:{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817},120:{775:7819,776:7821},121:{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925},122:{769:378,770:7825,775:380,780:382,803:7827,817:7829},168:{768:8173,769:901,834:8129},194:{768:7846,769:7844,771:7850,777:7848},196:{772:478},197:{769:506},198:{769:508,772:482},199:{769:7688},202:{768:7872,769:7870,771:7876,777:7874},207:{769:7726},212:{768:7890,769:7888,771:7894,777:7892},213:{769:7756,772:556,776:7758},214:{772:554},216:{769:510},220:{768:475,769:471,772:469,780:473},226:{768:7847,769:7845,771:7851,777:7849},228:{772:479},229:{769:507},230:{769:509,772:483},231:{769:7689},234:{768:7873,769:7871,771:7877,777:7875},239:{769:7727},244:{768:7891,769:7889,771:7895,777:7893},245:{769:7757,772:557,776:7759},246:{772:555},248:{769:511},252:{768:476,769:472,772:470,780:474},258:{768:7856,769:7854,771:7860,777:7858},259:{768:7857,769:7855,771:7861,777:7859},274:{768:7700,769:7702},275:{768:7701,769:7703},332:{768:7760,769:7762},333:{768:7761,769:7763},346:{775:7780},347:{775:7781},352:{775:7782},353:{775:7783},360:{769:7800},361:{769:7801},362:{776:7802},363:{776:7803},383:{775:7835},416:{768:7900,769:7898,771:7904,777:7902,803:7906},417:{768:7901,769:7899,771:7905,777:7903,803:7907},431:{768:7914,769:7912,771:7918,777:7916,803:7920},432:{768:7915,769:7913,771:7919,777:7917,803:7921},439:{780:494},490:{772:492},491:{772:493},550:{772:480},551:{772:481},552:{774:7708},553:{774:7709},558:{772:560},559:{772:561},658:{780:495},776:{769:836},913:{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124},917:{768:8136,769:904,787:7960,788:7961},919:{768:8138,769:905,787:7976,788:7977,837:8140},921:{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993},927:{768:8184,769:908,787:8008,788:8009},929:{788:8172},933:{768:8170,769:910,772:8169,774:8168,776:939,788:8025},937:{768:8186,769:911,787:8040,788:8041,837:8188},940:{837:8116},942:{837:8132},945:{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115},949:{768:8050,769:941,787:7952,788:7953},951:{768:8052,769:942,787:7968,788:7969,834:8134,837:8131},953:{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150},959:{768:8056,769:972,787:8e3,788:8001},961:{787:8164,788:8165},965:{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166},969:{768:8060,769:974,787:8032,788:8033,834:8182,837:8179},970:{768:8146,769:912,834:8151},971:{768:8162,769:944,834:8167},974:{837:8180},978:{769:979,776:980},1030:{776:1031},1040:{774:1232,776:1234},1043:{769:1027},1045:{768:1024,774:1238,776:1025},1046:{774:1217,776:1244},1047:{776:1246},1048:{768:1037,772:1250,774:1049,776:1252},1050:{769:1036},1054:{776:1254},1059:{772:1262,774:1038,776:1264,779:1266},1063:{776:1268},1067:{776:1272},1069:{776:1260},1072:{774:1233,776:1235},1075:{769:1107},1077:{768:1104,774:1239,776:1105},1078:{774:1218,776:1245},1079:{776:1247},1080:{768:1117,772:1251,774:1081,776:1253},1082:{769:1116},1086:{776:1255},1091:{772:1263,774:1118,776:1265,779:1267},1095:{776:1269},1099:{776:1273},1101:{776:1261},1110:{776:1111},1140:{783:1142},1141:{783:1143},1240:{776:1242},1241:{776:1243},1256:{776:1258},1257:{776:1259},1488:{1463:64302,1464:64303,1468:64304},1489:{1468:64305,1471:64332},1490:{1468:64306},1491:{1468:64307},1492:{1468:64308},1493:{1465:64331,1468:64309},1494:{1468:64310},1496:{1468:64312},1497:{1460:64285,1468:64313},1498:{1468:64314},1499:{1468:64315,1471:64333},1500:{1468:64316},1502:{1468:64318},1504:{1468:64320},1505:{1468:64321},1507:{1468:64323},1508:{1468:64324,1471:64334},1510:{1468:64326},1511:{1468:64327},1512:{1468:64328},1513:{1468:64329,1473:64298,1474:64299},1514:{1468:64330},1522:{1463:64287},1575:{1619:1570,1620:1571,1621:1573},1608:{1620:1572},1610:{1620:1574},1729:{1620:1730},1746:{1620:1747},1749:{1620:1728},2325:{2364:2392},2326:{2364:2393},2327:{2364:2394},2332:{2364:2395},2337:{2364:2396},2338:{2364:2397},2344:{2364:2345},2347:{2364:2398},2351:{2364:2399},2352:{2364:2353},2355:{2364:2356},2465:{2492:2524},2466:{2492:2525},2479:{2492:2527},2503:{2494:2507,2519:2508},2582:{2620:2649},2583:{2620:2650},2588:{2620:2651},2603:{2620:2654},2610:{2620:2611},2616:{2620:2614},2849:{2876:2908},2850:{2876:2909},2887:{2878:2891,2902:2888,2903:2892},2962:{3031:2964},3014:{3006:3018,3031:3020},3015:{3006:3019},3142:{3158:3144},3263:{3285:3264},3270:{3266:3274,3285:3271,3286:3272},3274:{3285:3275},3398:{3390:3402,3415:3404},3399:{3390:3403},3545:{3530:3546,3535:3548,3551:3550},3548:{3530:3549},3904:{4021:3945},3906:{4023:3907},3916:{4023:3917},3921:{4023:3922},3926:{4023:3927},3931:{4023:3932},3953:{3954:3955,3956:3957,3968:3969},3984:{4021:4025},3986:{4023:3987},3996:{4023:3997},4001:{4023:4002},4006:{4023:4007},4011:{4023:4012},4018:{3968:3958},4019:{3968:3960},4133:{4142:4134},7734:{772:7736},7735:{772:7737},7770:{772:7772},7771:{772:7773},7778:{775:7784},7779:{775:7785},7840:{770:7852,774:7862},7841:{770:7853,774:7863},7864:{770:7878},7865:{770:7879},7884:{770:7896},7885:{770:7897},7936:{768:7938,769:7940,834:7942,837:8064},7937:{768:7939,769:7941,834:7943,837:8065},7938:{837:8066},7939:{837:8067},7940:{837:8068},7941:{837:8069},7942:{837:8070},7943:{837:8071},7944:{768:7946,769:7948,834:7950,837:8072},7945:{768:7947,769:7949,834:7951,837:8073},7946:{837:8074},7947:{837:8075},7948:{837:8076},7949:{837:8077},7950:{837:8078},7951:{837:8079},7952:{768:7954,769:7956},7953:{768:7955,769:7957},7960:{768:7962,769:7964},7961:{768:7963,769:7965},7968:{768:7970,769:7972,834:7974,837:8080},7969:{768:7971,769:7973,834:7975,837:8081},7970:{837:8082},7971:{837:8083},7972:{837:8084},7973:{837:8085},7974:{837:8086},7975:{837:8087},7976:{768:7978,769:7980,834:7982,837:8088},7977:{768:7979,769:7981,834:7983,837:8089},7978:{837:8090},7979:{837:8091},7980:{837:8092},7981:{837:8093},7982:{837:8094},7983:{837:8095},7984:{768:7986,769:7988,834:7990},7985:{768:7987,769:7989,834:7991},7992:{768:7994,769:7996,834:7998},7993:{768:7995,769:7997,834:7999},8e3:{768:8002,769:8004},8001:{768:8003,769:8005},8008:{768:8010,769:8012},8009:{768:8011,769:8013},8016:{768:8018,769:8020,834:8022},8017:{768:8019,769:8021,834:8023},8025:{768:8027,769:8029,834:8031},8032:{768:8034,769:8036,834:8038,837:8096},8033:{768:8035,769:8037,834:8039,837:8097},8034:{837:8098},8035:{837:8099},8036:{837:8100},8037:{837:8101},8038:{837:8102},8039:{837:8103},8040:{768:8042,769:8044,834:8046,837:8104},8041:{768:8043,769:8045,834:8047,837:8105},8042:{837:8106},8043:{837:8107},8044:{837:8108},8045:{837:8109},8046:{837:8110},8047:{837:8111},8048:{837:8114},8052:{837:8130},8060:{837:8178},8118:{837:8119},8127:{768:8141,769:8142,834:8143},8134:{837:8135},8182:{837:8183},8190:{768:8157,769:8158,834:8159},8592:{824:8602},8594:{824:8603},8596:{824:8622},8656:{824:8653},8658:{824:8655},8660:{824:8654},8707:{824:8708},8712:{824:8713},8715:{824:8716},8739:{824:8740},8741:{824:8742},8764:{824:8769},8771:{824:8772},8773:{824:8775},8776:{824:8777},8781:{824:8813},8801:{824:8802},8804:{824:8816},8805:{824:8817},8818:{824:8820},8819:{824:8821},8822:{824:8824},8823:{824:8825},8826:{824:8832},8827:{824:8833},8828:{824:8928},8829:{824:8929},8834:{824:8836},8835:{824:8837},8838:{824:8840},8839:{824:8841},8849:{824:8930},8850:{824:8931},8866:{824:8876},8872:{824:8877},8873:{824:8878},8875:{824:8879},8882:{824:8938},8883:{824:8939},8884:{824:8940},8885:{824:8941},10973:{824:10972},12358:{12441:12436},12363:{12441:12364},12365:{12441:12366},12367:{12441:12368},12369:{12441:12370},12371:{12441:12372},12373:{12441:12374},12375:{12441:12376},12377:{12441:12378},12379:{12441:12380},12381:{12441:12382},12383:{12441:12384},12385:{12441:12386},12388:{12441:12389},12390:{12441:12391},12392:{12441:12393},12399:{12441:12400,12442:12401},12402:{12441:12403,12442:12404},12405:{12441:12406,12442:12407},12408:{12441:12409,12442:12410},12411:{12441:12412,12442:12413},12445:{12441:12446},12454:{12441:12532},12459:{12441:12460},12461:{12441:12462},12463:{12441:12464},12465:{12441:12466},12467:{12441:12468},12469:{12441:12470},12471:{12441:12472},12473:{12441:12474},12475:{12441:12476},12477:{12441:12478},12479:{12441:12480},12481:{12441:12482},12484:{12441:12485},12486:{12441:12487},12488:{12441:12489},12495:{12441:12496,12442:12497},12498:{12441:12499,12442:12500},12501:{12441:12502,12442:12503},12504:{12441:12505,12442:12506},12507:{12441:12508,12442:12509},12527:{12441:12535},12528:{12441:12536},12529:{12441:12537},12530:{12441:12538},12541:{12441:12542},64329:{1473:64300,1474:64301},119127:{119141:119134},119128:{119141:119135},119135:{119150:119136,119151:119137,119152:119138,119153:119139,119154:119140},119225:{119141:119227},119226:{119141:119228},119227:{119150:119229,119151:119231},119228:{119150:119230,119151:119232}},H={dummy:"Glk call has not yet returned"},j=1,F=2,I=3,q=4,R=null,U=null,z=!0,W=null,X=null,V=null,$=null,J=null,K=null,Q=1,G=null,Y=null,Z=null;return{version:"1.3.1",init:a,update:v,fatal_error:m,byte_array_to_string:O,uni_array_to_string:M,Const:g,RefBox:D,RefStruct:P,DidNotReturn:H,call_may_not_return:B,glk_put_jstring:Et,glk_put_jstring_stream:St,glk_exit:Ct,glk_tick:kt,glk_gestalt:Lt,glk_gestalt_ext:At,glk_window_iterate:Ot,glk_window_get_rock:Mt,glk_window_get_root:_t,glk_window_open:Dt,glk_window_close:Pt,glk_window_get_size:Ht,glk_window_set_arrangement:Bt,glk_window_get_arrangement:jt,glk_window_get_type:Ft,glk_window_get_parent:It,glk_window_clear:qt,glk_window_move_cursor:Rt,glk_window_get_stream:Ut,glk_window_set_echo_stream:zt,glk_window_get_echo_stream:Wt,glk_set_window:Xt,glk_window_get_sibling:Vt,glk_stream_iterate:$t,glk_stream_get_rock:Jt,glk_stream_open_file:Kt,glk_stream_open_memory:Qt,glk_stream_close:Zt,glk_stream_set_position:en,glk_stream_get_position:tn,glk_stream_set_current:nn,glk_stream_get_current:rn,glk_fileref_create_temp:sn,glk_fileref_create_by_name:on,glk_fileref_create_by_prompt:un,glk_fileref_destroy:fn,glk_fileref_iterate:ln,glk_fileref_get_rock:cn,glk_fileref_delete_file:hn,glk_fileref_does_file_exist:pn,glk_fileref_create_from_fileref:dn,glk_put_char:vn,glk_put_char_stream:mn,glk_put_string:gn,glk_put_string_stream:yn,glk_put_buffer:bn,glk_put_buffer_stream:wn,glk_set_style:En,glk_set_style_stream:Sn,glk_get_char_stream:xn,glk_get_line_stream:Tn,glk_get_buffer_stream:Nn,glk_char_to_lower:Cn,glk_char_to_upper:kn,glk_stylehint_set:Ln,glk_stylehint_clear:An,glk_style_distinguish:On,glk_style_measure:Mn,glk_select:_n,glk_select_poll:Dn,glk_request_line_event:Pn,glk_cancel_line_event:Hn,glk_request_char_event:Bn,glk_cancel_char_event:jn,glk_request_mouse_event:qn,glk_cancel_mouse_event:Rn,glk_request_timer_events:Un,glk_image_get_info:zn,glk_image_draw:Wn,glk_image_draw_scaled:Xn,glk_window_flow_break:Vn,glk_window_erase_rect:$n,glk_window_fill_rect:Jn,glk_window_set_background_color:Kn,glk_schannel_iterate:Qn,glk_schannel_get_rock:Gn,glk_schannel_create:Yn,glk_schannel_destroy:Zn,glk_schannel_play:er,glk_schannel_play_ext:tr,glk_schannel_stop:nr,glk_schannel_set_volume:rr,glk_schannel_create_ext:sr,glk_schannel_play_multi:or,glk_schannel_pause:ur,glk_schannel_unpause:ar,glk_schannel_set_volume_ext:fr,glk_sound_load_hint:ir,glk_set_hyperlink:lr,glk_set_hyperlink_stream:cr,glk_request_hyperlink_event:hr,glk_cancel_hyperlink_event:pr,glk_buffer_to_lower_case_uni:dr,glk_buffer_to_upper_case_uni:vr,glk_buffer_to_title_case_uni:mr,glk_buffer_canon_decompose_uni:br,glk_buffer_canon_normalize_uni:wr,glk_put_char_uni:Er,glk_put_string_uni:Sr,glk_put_buffer_uni:xr,glk_put_char_stream_uni:Tr,glk_put_string_stream_uni:Nr,glk_put_buffer_stream_uni:Cr,glk_get_char_stream_uni:kr,glk_get_buffer_stream_uni:Lr,glk_get_line_stream_uni:Ar,glk_stream_open_file_uni:Or,glk_stream_open_memory_uni:Mr,glk_request_char_event_uni:_r,glk_request_line_event_uni:Dr,glk_set_echo_line_event:Fn,glk_set_terminators_line_event:In,glk_current_time:Pr,glk_current_simple_time:Hr,glk_time_to_date_utc:Br,glk_time_to_date_local:jr,glk_simple_time_to_date_utc:Fr,glk_simple_time_to_date_local:Ir,glk_date_to_time_utc:qr,glk_date_to_time_local:Rr,glk_date_to_simple_time_utc:Ur,glk_date_to_simple_time_local:zr,glk_stream_open_resource:Gt,glk_stream_open_resource_uni:Yt}}()
